(window.odspNextWebpackJsonp=window.odspNextWebpackJsonp||[]).push([["335"],{2211:function(e,t,n){"use strict";n.r(t);n.d(t,"resourceKey",function(){return m});var r=n(516),i=n(48),s=n(25),o=n(5),u=n(372),a=n(150),f=n(4),l=n(117),c=n(24),h=n(32),p=n(15),d=n(100),v=(function(){function e(e,t){this._identityDataSource=t.identityDataSource;this._navigation=t.navigation;this._urlCache=new Map;this._vroomDataRequestor=t.vroomDataRequestor}e.prototype.getDownloadUrl=function(e,t){void 0===t&&(t={});var n=this._urlCache;if(!t.forceRefresh){var r=n.get(e.key)||{},i=r.url,o=r.time;if(i&&o<Date.now()-27e5)return s.n.wrap(i)}var u=this._getAuthKey(),f=this.getItemUrl(e,t),l={};if(u){var c=a.get("BadgerAuth");c&&(l={Authorization:"Badger "+c})}var h="itemDownloadUrl";t.apiName&&(h=t.apiName+"."+h);return this._vroomDataRequestor.send({apiName:h,path:f+"?select=id,@content.downloadUrl"+(u?"&authkey="+u:""),needsAuthorization:!u,headers:l,qosExtraData:t.qosExtraData}).then(function(t){var r=t["@content.downloadUrl"];if(!r)throw new d.e({code:"NoDownloadUrl",message:"Vroom response did not contain download URL"});n.set(e.key,{url:r,time:Date.now()});return r})};e.prototype.getDownloadUrlSync=function(e,t){var n=this.getItemUrl(e,t),r=this._getAuthKey();return n&&r?n+"/content?authkey="+r:void 0};e.prototype.getAuthenticationParams=function(e){var t,n=this._getAuthKey();return n?s.n.resolve(((t={}).authkey=n,t)):this._identityDataSource.getSessionToken().then(function(e){var t=e.accessToken,n=e.proofToken,r={};t&&(r.access_token=decodeURIComponent(t));n&&(r.prooftoken=decodeURIComponent(n));return r})};e.prototype.getDriveUrl=function(e,t){void 0===t&&(t={});var n=t.useDirectEndpoint,r=void 0!==n&&n,i=t.apiVersion,s=void 0===i?"v1.0":i,o=this._getGraphFacet(e);return this._getDriveUrl(o,r,s)};e.prototype.getItemUrl=function(e,t){void 0===t&&(t={});var n=t.useDirectEndpoint,r=void 0!==n&&n,i=t.isPath,s=void 0!==i&&i,o=t.apiVersion,u=void 0===o?"v1.0":o,a=this._getGraphFacet(e);return this._getDriveUrl(a,r,u)+"/items/"+encodeURIComponent(a.itemId)+(s?":":"")};e.prototype.getAccessToken=function(e){};e.prototype._getAuthKey=function(){return this._identityDataSource.getIdentity().type===r.e.anonymous&&this._navigation.viewParams.authkey};e.prototype._getGraphFacet=function(e){var t=e.graph;if(t)return t;var n=Object(c.v)(e.key);return{itemId:n.id,driveId:n.cid}};e.prototype._getDriveUrl=function(e,t,n){return(t?Object(h.a)({apiVersion:n,driveId:e.driveId}):!Object(f.isFeatureEnabled)(f.UseNewShareDialog)||Object(l.e)()&&!Object(f.isFeatureEnabled)(f.UseNewShareDialogForWinApp)?"https://graph.microsoft.com/v1.0":"https://graph.microsoft.com/beta")+"/drives/"+encodeURIComponent(e.driveId)};e.dependencies={identityDataSource:p.x,navigation:i.e,vroomDataRequestor:u.e};return e})();t.default=v;var m=Object(o.s)("GraphDataSource",v)}}]);