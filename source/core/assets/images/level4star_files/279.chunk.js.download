(window.odspNextWebpackJsonp=window.odspNextWebpackJsonp||[]).push([["279"],{760:function(e,t,n){"use strict";n.d(t,"t",function(){return u});n.d(t,"e",function(){return a});var r=n(0),i=n(329),s=n(227),o=n(853);function u(e,t){return Object(r.__awaiter)(this,void 0,void 0,function(){var n,o,u,a,f,l;return Object(r.__generator)(this,function(r){switch(r.label){case 0:n=new i.e,o=n.resolve,u=n.reject,a=n.promise;t&&t.throwIfCanceled();f=e!==1/0?window.setTimeout(function(){return o()},e):void 0;l=t&&t.subscribe(function(){f&&window.clearTimeout(f);u(new s.e)});r.label=1;case 1:r.trys.push([1,,3,4]);return[4,a];case 2:r.sent();return[3,4];case 3:l&&l();return[7];case 4:return[2]}})})}function a(e,t){var n="number"==typeof e?{timeout:e}:e,i=n.timeout,u=n.errorProps,a=void 0===u?{}:u,f=new s.t,l=t&&t.subscribe(f.cancel),c=i!==1/0?window.setTimeout(function(){f.cancel(new o.e(Object(r.__assign)({timeout:i},a)))},i):void 0;c&&f.token.subscribe(function(){window.clearTimeout(c)});return Object(r.__assign)(Object(r.__assign)({},f),{dispose:function(){c&&clearTimeout(c);l&&l();f.dispose()}})}},853:function(e,t,n){"use strict";n.d(t,"e",function(){return i});var r=n(0),i=(function(e){Object(r.__extends)(t,e);function t(t){var n=t.timeout,i=Object(r.__rest)(t,["timeout"]),s=e.call(this,Object(r.__assign)(Object(r.__assign)({message:"Timeout"},i),{extraData:{timeout:n}}))||this;s.timeout=n;s.name="TimeoutError";return s}return t})(n(100).e)},985:function(e,t,n){"use strict";n.d(t,"e",function(){return c});var r=n(0),i=n(26),s=n(1043),o=n(376),u=n(760),a=new WeakMap,f=new Map,l=new WeakMap;function c(e,t){void 0===t&&(t={});var n=t.useChildrenAsPlaceholder,c=void 0!==n&&n,h=function(){return(function(e){var t=l.get(e);t||l.set(e,t=e().then(function(t){var n=Object(s.e)(t);a.set(e,n);return n}).catch(function(t){l.delete(e);return Promise.reject(t)}));return t})(e)},p=function(){if(a.has(e))return a.get(e)};function d(e){var t=this,n=i.useState(function(){return{}}),s=e.placeholder,a=e.children,l=e.barrier,d=Object(r.__rest)(e,["placeholder","children","barrier"]),v=Object(o.e)(function(){return d},d),m=i.useState(function(){return p()}),g=m[0],y=m[1],b=i.useRef(y),w=i.useState(),E=w[0],S=w[1],x=i.useRef(S);i.useLayoutEffect(function(){return function(){b.current=void 0;x.current=void 0;f.delete(n)}},[]);i.useLayoutEffect(function(){if(f.size>0){var e=[];f.forEach(function(t){e.push(t)});f.clear();for(var t=0,n=e;t<n.length;t++){(0,n[t])()}}});i.useLayoutEffect(function(){g||E||Object(r.__awaiter)(t,void 0,void 0,function(){var e,t,i,s;return Object(r.__generator)(this,function(r){switch(r.label){case 0:r.trys.push([0,4,,5]);return l?[4,l]:[3,2];case 1:r.sent();r.label=2;case 2:return[4,h()];case 3:e=r.sent();return[3,5];case 4:i=r.sent();t=i;return[3,5];case 5:f.set(n,function(){e?b.current&&b.current(function(){return e}):t&&x.current&&x.current(t)});return[4,Object(u.t)(0)];case 6:r.sent();if(s=f.get(n)){f.delete(n);s()}return[2]}})})},[]);return i.useMemo(function(){if(E)throw E;return g?i.createElement(g,Object(r.__assign)({},v,{children:a})):c?i.createElement(i.Fragment,null,a):s?i.createElement(i.Fragment,null,s):null},[v,s,a,g,E])}d.asAsync={load:h,getComponent:p,options:t};return d}},1043:function(e,t,n){"use strict";n.d(t,"e",function(){return r});function r(e){return e.default||e}},1723:function(e,t,n){"use strict";n.d(t,"e",function(){return r});var r=new(n(3).t)("searchBoxConfig")},2368:function(e,t,n){"use strict";n.d(t,"e",function(){return r});var r=new(n(3).t)("searchBoxDataSource")},3407:function(e,t,n){"use strict";n.r(t);n.d(t,"resourceKey",function(){return R});var r,i=n(0),s=n(263),o=n(226),u=n(34),a=n(3),f=n(5),l=n(82),c=n(47),h=function(){var e,t,n;r||(r=null===(n=null===(t=null===(e=window.mssearchux)||void 0===e?void 0:e.header)||void 0===t?void 0:t.getInstrumenter)||void 0===n?void 0:n.call(t));return r},p=function(e,t){var n,r,i=t||v(),s=e||m().activeScopeId;try{for(var o=Object(c.u)(i||[]),u=o.next();!u.done;u=o.next()){var a=u.value;if(a.id===s)return a}}catch(e){n={error:e}}finally{try{u&&!u.done&&(r=o.return)&&r.call(o)}finally{if(n)throw n.error}}},d=function(e,t){var n;t&&(r=t);var i=h();i&&i.setProps({hostAppInfo:Object(c.e)(Object(c.e)({},i.props.hostAppInfo),{scopeId:null===(n=p(e.activeScopeId,e.scopes))||void 0===n?void 0:n.searchBoxScopeId}),scopingControl:Object(c.e)({},e)})},v=function(){var e;return null===(e=m())||void 0===e?void 0:e.scopes},m=function(){var e;return null===(e=h())||void 0===e?void 0:e.props.scopingControl};var g=n(1723),y=new a.t("scopingControlDataSource"),b=n(2368),w=n(31),E=n(349),S=(E.t,E.s,{id:"spDocLibFolder",name:E.t}),x={id:"spDocLib",name:E.i},T=(E.o,{id:"spHubSite",name:E.r}),N=(E.e,{id:"spHubHub",name:E.n}),C={id:"org",name:E.v};s.t.isActivated("b61d6d21-1f5a-4e5c-9770-ae749a023592","12/08/2020",'Support "All sites in hub" search scope in hub.')?[N,C]:[T,N,C];var k,L=n(59),A=n(13),O=n(503),M=n(381),_=n(21);function D(){k||(k=O.n.isFeatureEnabled({ODB:1804})||(e=window._spPageContextInfo)&&!_.e.isActivated("1166a987-eb1e-4f42-baf6-46d50b7fc0c4","09/30/2020","[stvikenv] Activate this kill switch to pause experiment 90065 - using the PFP loading pattern in the search box.")&&1===Object(M.n)(90065,e)?"pfp":"eager");var e;return k}var P=n(407),H=new a.t("metadataSearchDataSource"),B=n(161),j=n(985),F=n(26),I=Object(j.e)(function(){return Object(i.__awaiter)(void 0,void 0,void 0,function(){return Object(i.__generator)(this,function(e){switch(e.label){case 0:return[4,n.ee(["324","ondemand.resx-ondemand"],3491)];case 1:return[2,e.sent().MetadataSearchTeachingBubble]}})})});var q=(function(){function e(e,t){this._isConfigured=!1;this._resources=t.resources;this._engagement=t.engagement;this._searchBoxDataSource=t.searchBoxDataSource;this._config=t.searchBoxConfig;this._scope=new l.e;this._getViewParams=function(){throw new Error("Search box not configured")};this._isLastPageSearch=!1;this._searchInstrumenter=this._config.getInstrumenter();this._scopingControlDataSource=t.scopingControlDataSource;this._metadataSearchDataSource=t.metadataSearchDataSource;this._bootOptions=t.bootOptions;this._teachingBubbleProvider=t.teachingBubbleProvider}e.prototype.configureSearchBox=function(e){var t=this;if(this._config.isEnabled()){var n=new o.e({name:"SuiteNavSearchBox.Configure"});if(this._shouldFixRaceConditions()){this._getViewParams=e;this._isLastPageSearch=this._searchBoxDataSource.isSearchResultsPage()}this._resources.consumeAsync(this._searchBoxDataSource.getSuiteNavProviderKey()).then(function(e){e.getO365Shell().then(function(e){e.OnHasMember("Search",function(){var r,o,a,f,l=e.Search;s.t.isActivated("d7ba218a-7001-4124-8c39-109553425542","06/18/2021","overwrite search result page search box text.")?Object(A.qi)(A.hn)||l.SetSearchText(t._config.getSearchText()):Object(A.qi)(A.hn)&&!(null===(r=t._metadataSearchDataSource)||void 0===r?void 0:r.isMetadataSearchResultPage())||l.SetSearchText(t._config.getSearchText());l.SetPlaceholderText(t._config.getPlaceholderText());l.SetTokenProviders(t._searchBoxDataSource.getTokenProviders());var c=l.OnSubmitSearch(t._onSubmitSearchCallback.bind(t)),h=l.OnSearchBoxActivated(t._onSearchBoxActivatedCallback.bind(t)),p=l.OnSearchBoxDeactivated(t._onSearchBoxDeactivatedCallback.bind(t));t._trackHandler(c,l.RemoveOnSubmitSearch);t._trackHandler(h,l.RemoveOnSearchBoxActivated);t._trackHandler(p,l.RemoveOnSearchBoxDeactivated);if(Object(A.qi)(A.S)){var d=l.OnExitSearch(t._onExitSearchCallback.bind(t));t._trackHandler(d,l.RemoveOnExitSearch)}t._searchBoxDataSource.getProviderConfigUpdaters&&l.SetProviderConfigUpdaters(t._searchBoxDataSource.getProviderConfigUpdaters(null===(o=t._scopingControlDataSource)||void 0===o?void 0:o.getActiveScope.bind(t._scopingControlDataSource)));(Object(A.qi)(A.hn)||Object(A.qi)(A.En))&&(t._shouldDisableSetSearchBoxSettingsInChromeless()&&(null===(a=t._bootOptions)||void 0===a?void 0:a.chromeless)&&!(null===(f=t._bootOptions)||void 0===f?void 0:f.isListHome)||l.SetSearchBoxSettings(Object(i.__assign)({cache:void 0,instrumenter:t._config.getInstrumenter(),tokenProviders:t._config.getTokenProviders()},s.t.isActivated("8852ae00-f7e0-4a74-bf2e-f5f33e61fde7","09/30/2020","[stvikenv] Specify search box loading pattern in SetSearchBoxSettings in odsp-next.")?{}:{loadingPattern:D()})));t._updateSearchInstrumenter();n.end({resultType:u.e.Success})})}).catch(function(e){n.end({resultType:u.e.Failure,error:e.message,resultCode:"getO365ShellError"})})}).catch(function(e){n.end({resultType:u.e.Failure,error:e.message,resultCode:"getSuiteNavProviderError"})});this._shouldFixRaceConditions()||(this._getViewParams=e);this._updateSearchInstrumenter();this._shouldFixRaceConditions()||s.t.isActivated("63b61692-3a0f-4f26-aec8-6045f59818bf","2020/08/14","Update last search page result.")||(this._isLastPageSearch=this._searchBoxDataSource.isSearchResultsPage());this._shouldFixRaceConditions()&&(this._isConfigured=!0)}};e.prototype.updateSearchBoxConfiguration=function(e){if(this._shouldFixRaceConditions()){var t=new o.e({name:"SuiteNavSearchBox.UpdateSearchBoxConfiguration"});if(this._isConfigured)try{this._resetSearchBoxText();this._updateSearchInstrumenter();t.end({resultType:u.e.Success})}catch(e){t.end({resultType:u.e.Failure,error:e,resultCode:"RuntimeError"})}else t.end({resultType:u.e.Failure,resultCode:"SearchBoxNotInitialized"})}else{this._resetSearchBoxText();this._updateSearchInstrumenter()}};e.prototype.dispose=function(){this._scope.dispose()};e.prototype._shouldFixRaceConditions=function(){return!s.t.isActivated("91300abd-a1b4-41f9-a88b-264db9937e72","2020/08/28","Fix issues with updateSearchBoxConfiguration being called before configureSearchBox")};e.prototype._shouldDisableSetSearchBoxSettingsInChromeless=function(){return!s.t.isActivated("4385e4cc-3ff4-4707-a6b7-ca36740100a0","2020/11/12","Disable SetSearchBoxSettings when chromeless")};e.prototype._runInShellSearch=function(e){return this._resources.consumeAsync(this._searchBoxDataSource.getSuiteNavProviderKey()).then(function(e){return e.getO365Shell()}).then(function(t){t.OnHasMember("Search",function(){return e(t.Search)})})};e.prototype._resetSearchBoxText=function(e){var t=this,n=this._searchBoxDataSource.isSearchResultsPage(),r=Object(A.qi)(A.hn);this._config.isEnabled()&&this._runInShellSearch(function(e){(!r||n||t._isLastPageSearch)&&e.SetSearchText(t._config.getSearchText());e.SetPlaceholderText(t._config.getPlaceholderText());t._isLastPageSearch=n})};e.prototype._trackHandler=function(e,t){this._scope.attach({dispose:function(){return t(e)}})};e.prototype._onSubmitSearchCallback=function(e,t,n){var r,i,s;if(Object(A.qi)(A.S)){var o=this._getViewParams();if(!this._searchBoxDataSource.isSearchResultsPage()){this._viewParamsBeforeSearch=o;this._urlBeforeSearch=window.location.href}}if(this._isScopeControlSupported()){s=this._scopingControlDataSource.getScopeControlScenario(this._scopingControlDataSource.getInitialScope(),this._searchBoxDataSource.isSearchResultsPage());i=this._scopingControlDataSource.getActiveScope()}this._engagement.logData({name:"SuiteNavSearchBox.Click",isIntentional:!0,extraData:{trigger:n?"ScopingControl":"SubmitSearch",targetScope:null==i?void 0:i.id},scenario:s,privacyClassification:"optionalDiagnostic"});this._searchBoxDataSource.onSubmitSearchCallback(e,this._getViewParams,null===(r=this._scopingControlDataSource)||void 0===r?void 0:r.getActiveScope(),this._urlBeforeSearch,n);this._endQos("Click")};e.prototype._onExitSearchCallback=function(){var e,t,n=this;if(this._searchBoxDataSource.onExitSearchCallback){if(null===(e=this._metadataSearchDataSource)||void 0===e?void 0:e.isMetadataSearchMode){this._metadataSearchDataSource.isMetadataSearchMode=!1;var r;s.t.isActivated("f88d7f12-9b4e-4a3b-a32c-708973241a8c","9/28/2021","regression in search suggestion")||(r=null===(t=this._scopingControlDataSource)||void 0===t?void 0:t.getActiveScope.bind(this._scopingControlDataSource));this._runInShellSearch(function(e){e.SetProviderConfigUpdaters(n._searchBoxDataSource.getProviderConfigUpdaters(r));n._updateSearchInstrumenter()})}if(this._searchBoxDataSource.isSearchResultsPage()){this._engagement.logData({name:"SuiteNavSearchBox.ExitSearch",isIntentional:!0});this._searchBoxDataSource.onExitSearchCallback(this._viewParamsBeforeSearch)}}};e.prototype._onSearchBoxActivatedCallback=function(){var e;this._isScopeControlSupported()&&(e=this._scopingControlDataSource.getScopeControlScenario(this._scopingControlDataSource.getInitialScope(),this._searchBoxDataSource.isSearchResultsPage()));this._engagement.logData({name:"SuiteNavSearchBox.FocusIn",isIntentional:!0,scenario:e,privacyClassification:"optionalDiagnostic",extraData:{isMetadataSearchAvailable:!!this._metadataSearchDataSource}});s.t.isActivated("c7a642ca-f153-4580-8105-031844f75442","9/17/2021","remove unused log")&&this._metadataSearchDataSource&&this._engagement.logData({name:"MetadataSearch.Available"});this._startQos()};e.prototype._onSearchBoxDeactivatedCallback=function(){this._engagement.logData({name:"SuiteNavSearchBox.FocusOut",isIntentional:!0,privacyClassification:"optionalDiagnostic"});this._endQos("FocusOut")};e.prototype._startQos=function(){this._currentQosEvent&&this._currentQosEvent.end({resultType:u.e.Failure});this._currentQosEvent=new o.e({name:"SuiteNavSearchBox.Usage"})};e.prototype._endQos=function(e){if(this._currentQosEvent){this._currentQosEvent.end({resultType:u.e.Success,resultCode:e});this._currentQosEvent=void 0}};e.prototype._updateSearchInstrumenter=function(){this._triggerSearchBoxReconfiguration();if(this._isScopeControlSupported()){d(this._getScopingControlConfig(),this._searchInstrumenter);var e=this._scopingControlDataSource.getInitialScope();this._scopingControlDataSource.setActiveScope(e)}this._setSearchInstrumenterProps();this._configureMetadataSearch()};e.prototype._isScopeControlSupported=function(){return!!this._scopingControlDataSource&&this._scopingControlDataSource.isScopingControlEnabled()};e.prototype._getScopingControlConfig=function(){var e=this;if(!this._isScopeControlSupported())throw new Error("Scoping control is not supported.");return{scopes:this._scopingControlDataSource.getAvailableScopes(),activeScopeId:this._scopingControlDataSource.getInitialScope().id,onChange:function(t,n){e._scopingControlDataSource.setActiveScope(n);e._triggerSearchBoxReconfiguration();var r=!!t&&e._searchBoxDataSource.isSearchResultsPage();e._logScopeChange(n,r);r?e._onSubmitSearchCallback(t,void 0,!0):e._setFocusSearchBox();(s.t.isActivated("f88d7f12-9b4e-4a3b-a32c-708973241a8c","9/28/2021","regression in search suggestion")||e._metadataSearchDataSource)&&e._updateMetadataSearchConfiguration()}}};e.prototype._hideScopingControl=function(){this._searchInstrumenter.setProps({scopingControl:Object(i.__assign)(Object(i.__assign)({},this._searchInstrumenter.props.scopingControl),{activeScopeId:void 0,scopes:void 0})})};e.prototype._configureMetadataSearch=function(){var e=this;if(this._metadataSearchDataSource){this._metadataSearchDataSource.updateMetadataSearchConfig=function(){e._updateMetadataSearchConfiguration();e._metadataSearchDataSource.isMetadataSearchMode?e._setFocusSearchBox():e._isScopeControlSupported()&&d(e._getScopingControlConfig(),e._searchInstrumenter)};this._metadataSearchDataSource.isMetadataSearchResultPage()&&(this._metadataSearchDataSource.isMetadataSearchMode=!0);this._updateMetadataSearchConfiguration()}};e.prototype._hideMetadataSearchButton=function(){var e;null===(e=this._searchInstrumenter)||void 0===e||e.setProps({filterButtonConfig:void 0})};e.prototype._showMetadataSearchButton=function(){var e,t=this;null===(e=this._searchInstrumenter)||void 0===e||e.setProps({filterButtonConfig:{onClick:function(e){var n=e||window.event;if(n){n.preventDefault();t._teachingBubbleProvider?t._showMetadataSearchTeachingBubble(n):t._openMetadataSearchForm(n.type)}else t._openMetadataSearchForm()},ariaLabel:E.u,title:E.u}})};e.prototype._showMetadataSearchTeachingBubble=function(e){var t,n=this,r={campaignGuid:"b8ceb79a-73e5-4e1d-8df8-27dedb514597",flag:A.g},s=e.target,a=e.type;this._shouldLogMetadataQoSEvents()&&(t=new o.e({name:"SearchBox.ShowMetadataSearchTeachingBubble"}));this._teachingBubbleProvider.shouldBubbleBeAdded(r,!1).then(function(e){if(e){(function(e){Object(B.render)(F.createElement(I,Object(i.__assign)({},e)),document.createElement("div"))})({isVisible:e,onDismiss:function(){n._teachingBubbleProvider.markBubbleAsDismissed(r);n._openMetadataSearchForm(a)},target:s});null==t||t.end({resultType:u.e.Success})}else{n._openMetadataSearchForm(a);null==t||t.end({resultType:u.e.Success,resultCode:"AlreadyShowed"})}}).catch(function(e){n._openMetadataSearchForm(a);null==t||t.end({resultType:u.e.Failure,error:e.message})})};e.prototype._openMetadataSearchForm=function(e){var t=this;this._metadataSearchDataSource.isMetadataSearchMode=!0;this._updateMetadataSearchConfiguration();this._setFocusSearchBox();"keydown"===e&&setTimeout(function(){return t._setFocusSearchBox()},0)};e.prototype._updateMetadataSearchConfiguration=function(){var e,t,n,r=this,i=null===(e=this._scopingControlDataSource)||void 0===e?void 0:e.getActiveScope();if(!s.t.isActivated("f88d7f12-9b4e-4a3b-a32c-708973241a8c","9/28/2021","regression in search suggestion")){n=null===(t=this._scopingControlDataSource)||void 0===t?void 0:t.getActiveScope.bind(this._scopingControlDataSource);i||(i=x)}var o=i===x||i===S;this._runInShellSearch(function(e){e.SetProviderConfigUpdaters(r._searchBoxDataSource.getProviderConfigUpdaters(n))});if(o)if(this._metadataSearchDataSource.isMetadataSearchMode){this._hideScopingControl();this._hideMetadataSearchButton()}else this._showMetadataSearchButton();else this._hideMetadataSearchButton()};e.prototype._setFocusSearchBox=function(){this._resources.consumeAsync(this._searchBoxDataSource.getSuiteNavProviderKey()).then(function(e){e.getO365Shell().then(function(e){e.Search.FocusSearchBox()})})};e.prototype._setSearchInstrumenterProps=function(){this._searchBoxDataSource.getSearchInstrumenterProps&&this._searchInstrumenter&&this._searchInstrumenter.setProps(this._searchBoxDataSource.getSearchInstrumenterProps())};e.prototype._triggerSearchBoxReconfiguration=function(){this._runInShellSearch(function(e){return e.RecomputeSearchBoxConfiguration()})};e.prototype._logScopeChange=function(e,t){if(!this._scopingControlDataSource)throw new Error("Scoping control is not supported.");var n=this._scopingControlDataSource.getInitialScope(),r=this._scopingControlDataSource.getScopeControlScenario(n,this._searchBoxDataSource.isSearchResultsPage());this._engagement.logData({name:"SuiteNavSearchBox.ScopeChanged",isIntentional:!0,scenario:r,extraData:{initialScope:n.id,targetScope:e.id,searchTriggered:t},privacyClassification:"optionalDiagnostic"})};e.prototype._shouldLogMetadataQoSEvents=function(){return!s.t.isActivated("7c57ff79-8f31-42eb-906b-f19374f3b1a4","9/29/2021","log qos events")};e.dependencies={resources:a.o,engagement:L.e,searchBoxDataSource:b.e,searchBoxConfig:g.e,scopingControlDataSource:y.optional,metadataSearchDataSource:H.optional,bootOptions:P.e.optional,teachingBubbleProvider:w.N.optional};return e})(),R=(t.default=q,Object(f.s)("SearchBoxProvider",q))}}]);