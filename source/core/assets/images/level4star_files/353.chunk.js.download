(window.odspNextWebpackJsonp=window.odspNextWebpackJsonp||[]).push([["353"],{2435:function(e,t,n){"use strict";n.d(t,"e",function(){return r});function r(e){var t;if(e){e.RequestFacts="scenario=PointInTimeRestore";return e}return(t={}).RequestFacts="scenario=PointInTimeRestore",t}},3268:function(e,t,n){"use strict";n.r(t);n.d(t,"RestoreOperationDataSource",function(){return f});n.d(t,"resourceKey",function(){return l});var r=n(230),i=n(5),s=n(15),o=n(372),u=n(130),a=n(2435),f=(function(){function e(e,t){this._dataRequestor=t.vroomDataRequestor;this._urlDataSourceLite=t.urlDataSourceLite}e.prototype.shouldMonitorProgressForItemSetKey=function(e){return!0};e.prototype.getOngoingRestoreOperation=function(e){e&&(e.headers=this._addRequestFactsHeader(e.headers));return this._dataRequestor.send({apiName:"Operations",headers:e&&e.headers,path:this._urlDataSourceLite.getApiBaseUrl({apiVersion:"v1.0",driveId:"me"})+"/drive/operations?$filter=type eq 'pointInTimeRestore'&$orderby=createdDateTime desc&$top=1"}).then(function(e){var t=e.value;if(0!==t.length)return{percentComplete:t[0].percentComplete,status:{cancelled:u.e.Cancelled,completed:u.e.Completed,failed:u.e.Failed,notstarted:u.e.NotStarted,inprogress:u.e.InProgress}[t[0].status.toLowerCase()]}},function(e){if(!Object(r.s)(e)||404!==e.status)throw e})};e.prototype.submitRestore=function(e){e.headers=this._addRequestFactsHeader(e&&e.headers);var t=JSON.stringify({anomalyId:e.anomalyId,restoreToDateTime:e.dateTime,mostRecentActivityId:e.mostRecentActivityId});return this._dataRequestor.send({apiName:"RestoreToDate",requestType:"POST",headers:e&&e.headers,path:this._urlDataSourceLite.getApiBaseUrl({apiVersion:"v1.0",driveId:"me"})+"/drive/root/oneDrive.restoreToDate",postData:t,parseResponse:function(e){return{id:JSON.parse(e.responseText).id,resourceLocation:e.getResponseHeader("Location")}}})};e.prototype.isOneDrive=function(){return!0};e.prototype.getQosPrefix=function(){return""};e.prototype._addRequestFactsHeader=function(e){return Object(a.e)(e)};e.dependencies={vroomDataRequestor:o.e,urlDataSourceLite:s.be};return e})(),l=Object(i.s)("RestoreOperationDataSource",f)}}]);