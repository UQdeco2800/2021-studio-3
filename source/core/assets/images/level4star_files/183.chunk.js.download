(window.odspNextWebpackJsonp=window.odspNextWebpackJsonp||[]).push([["183","281"],{558:function(e,t,n){"use strict";n.r(t);n.d(t,"resourceKey",function(){return Se});n.d(t,"clearCache",function(){return xe});n.d(t,"isProvisioning",function(){return Te});var r,i,s=n(115),o=n(89),u=n(43),a=n(5),f=n(0),l=n(1613),c=n(103),h=Object(c.e)({eventName:"SuiteNavError,",shortEventName:"SuiteNavError",requiresParent:!1},{message:1,stack:1,type:1}),p=n(556),d=n(1016),v=n(44),m=n(503),g=n(263);function y(e,t){if(!r||i!==e){r=(function(e,t){var n,r=t||window._spPageContextInfo;r&&(n=e.webThemeProvider(r));return n})(e,t);i=e}return r}var b=n(25),w=(function(){function e(){this.R=0;this.G=0;this.B=0;this.A=e.maxComponent}e.clone=function(t){return e.fromRgba(t.R,t.G,t.B,t.A)};e.equals=function(e,t){var n=!e,r=!t;return n||r?n&&r:e.R===t.R&&e.G===t.G&&e.B===t.B&&e.A===t.A};e.fromRgba=function(t,n,r,i){var s=new e;s.R=Math.round(t);s.G=Math.round(n);s.B=Math.round(r);s.A=null!=i?Math.round(i):e.maxComponent;return s};e.fromRgbaString=function(t){var n=new e;if(/^rgb.+/.test(t)){var r=t.match(/[\d.]+/g);n=e.fromRgba(Number(r[0]),Number(r[1]),Number(r[2]),4===r.length?Number(r[3])*e.maxComponent:null)}return n};e.fromHtmlColor=function(t){function n(e,t,n){return parseInt(e.charAt(t)+e.charAt(n),16)}var r=new e;if("string"==typeof t&&"#"===t.charAt(0))switch(t.length){case 9:r.A=n(t,1,2);r.R=n(t,3,4);r.G=n(t,5,6);r.B=n(t,7,8);break;case 7:r.R=n(t,1,2);r.G=n(t,3,4);r.B=n(t,5,6);break;case 4:r.R=n(t,1,1);r.G=n(t,2,2);r.B=n(t,3,3)}else/^rgb.+/.test(t)&&(r=e.fromRgbaString(t));return r};e.toHtmlString=function(t,n){function r(t){var n=Number(t);if(!(n>=0&&n<=e.maxComponent))throw new Error("Argument must be a Number in [0, 255]");var r=n.toString(16);n<16&&(r="0"+r);return r}return t.A<e.maxComponent&&!n?"rgba("+t.R.toString(10)+", "+t.G.toString(10)+", "+t.B.toString(10)+", "+(t.A/e.maxComponent).toFixed(2)+")":"#"+(n?r(t.A):"")+r(t.R)+r(t.G)+r(t.B)};e.maxComponent=255;return e})(),E=(function(){function e(){}e.clearThemeCache=function(){var t=e.getThemeDataStore();t.remove("Data");t.remove("CacheToken");t.remove("CacheVersion")};e.getCachedTheme=function(t){var n,r=e.getThemeDataStore();try{t===r.getValue("CacheToken")&&"1.7"===r.getValue("CacheVersion")&&(n=r.getValue("Data"))}catch(e){}return n};e.updateThemeCache=function(t,n){var r=e.getThemeDataStore();r.setValue("Data",t);r.setValue("CacheToken",n||t.cacheToken);r.setValue("CacheVersion","1.7")};e.getThemeDataStore=function(){return new o.e("odTheme",u.e.local)};return e})(),S=n(34),x=n(226),T=(function(){function e(e){this._loadData=e}e.getBackgroundUrl=function(t){return t?e._makeCssUrl(t.backgroundImageUri):"none"};e._makeCssUrl=function(t){var n="none";t&&(n='url("'+e._escapeQuotesAndParentheses(t)+'")');return n};e._escapeQuotesAndParentheses=function(e){var t={"'":"%27",'"':"%22","(":"%28",")":"%29"},n=null;null!=e&&(n=e.replace(/(['"\(\)])/gm,function(e,n){return t[n]}));return n};e.prototype.loadThemeTokenMap=function(t,n){return this.loadThemeData(t,n).then(function(t){var n;if(t&&t.palette){n={};var r=t.palette;for(var i in r){var s=r[i];n[i]=s?w.toHtmlString(s):null}n.backgroundImageUri=e._makeCssUrl(t.backgroundImageUri)}return n},function(e){return null})};e.prototype.loadThemeData=function(e,t){if(!t&&this._dataPromise)return this._dataPromise;var n=this,r=null,i=S.e.Failure;this._dataPromise=x.e.instrumentPromise({name:"ThemeProvider.LoadData"},function(){return new b.n(function(s,o){var u=null;t||(u=E.getCachedTheme(e));u?s(u):n._loadData(t).done(function(t){if(t){t.cacheToken&&E.updateThemeCache(t,e);s(t)}else{r="NoData";o&&o("No model returned")}},function(e){if(b.n.isCanceled(e)){r="Canceled";i=S.e.ExpectedFailure}else r="ServerLoadFailure";o&&o(e)})})},null,function(e){if(b.n.isCanceled(e)){i=S.e.ExpectedFailure;r="Canceled"}var t=e;if(e){var n={name:e.name||void 0,message:e.message&&e.message.value||e.message||void 0,correlationId:e.correlationId||void 0};t=JSON.stringify(n)}return{resultType:i,resultCode:r||"Other",error:t}});return this._dataPromise};return e})(),N=(n(326),n(153),n(251)),C={neutralDark:"#201f1e",neutralPrimary:"#323130",neutralPrimaryAlt:"#3b3a39",neutralSecondary:"#605e5c",neutralSecondaryAlt:"#8a8886",neutralTertiary:"#a19f9d",neutralTertiaryAlt:"#c8c6c4",neutralQuaternary:"#d2d0ce",neutralQuaternaryAlt:"#e1dfdd",neutralLight:"#edebe9",neutralLighter:"#f3f2f1",neutralLighterAlt:"#faf9f8"},k={elevation4:"0 0 5px 0 rgba(0,0,0,.4)",elevation8:"0 0 5px 0 rgba(0,0,0,.4)",elevation16:"0 0 5px 0 rgba(0,0,0,.4)",elevation64:"0 0 5px 0 rgba(0,0,0,.4)",roundedCorner2:"0px",roundedCorner4:"0px",roundedCorner6:"0px"},L={tiny:{fontSize:10,fontWeight:600},xSmall:{fontSize:11,fontWeight:400},small:{fontSize:12,fontWeight:400},smallPlus:{fontSize:13,fontWeight:400},medium:{fontSize:14,fontWeight:400},mediumPlus:{fontSize:15,fontWeight:400},large:{fontSize:17,fontWeight:300},xLarge:{fontSize:21,fontWeight:100},xLargePlus:{fontSize:21,fontWeight:100},xxLarge:{fontSize:28,fontWeight:100},xxLargePlus:{fontSize:28,fontWeight:100},superLarge:{fontSize:42,fontWeight:100},mega:{fontSize:72,fontWeight:100}},A=n(327),O=window._spPageContextInfo&&window._spPageContextInfo.listBaseTemplate===A.n.mySiteDocumentLibrary,M=!!window.FilesConfig,_=O||M,D={ODC:"EnableFluentStylingODC"},P={ODB:!!_||-1118};N.e.isFeatureEnabled(P)||N.e.isFeatureEnabled(D);function H(e,t){t&&N.e.initSPExpFeatures(t.ExpFeatures);m.n.evaluateCanOverride();if(!_){e=B({palette:{themePrimary:"#03787c",themeLighterAlt:"#f0f9fa",themeLighter:"#c5e9ea",themeLight:"#98d6d8",themeTertiary:"#49aeb1",themeSecondary:"#13898d",themeDarkAlt:"#026d70",themeDark:"#025c5f",themeDarker:"#014446"}},e)}M&&!m.n.isFeatureEnabled(D)&&(e=B({effects:k},e));M&&!m.n.isFeatureEnabled(D)&&(e=B({fonts:L},e));var n=e.palette;n&&(n.black||n.neutralPrimary||n.white||n.neutralQuaternary)&&!(n.black&&n.white&&n.neutralPrimary&&n.neutralQuaternary&&0===n.black.indexOf("#000")&&0===n.white.toLowerCase().indexOf("#fff")&&0===n.neutralPrimary.indexOf("#333")&&0===n.neutralQuaternary.toLowerCase().indexOf("#d0d0d0"))||(e.palette=Object(f.__assign)(Object(f.__assign)({},e.palette),C));return e}function B(e,t){return e=Object(f.__assign)(Object(f.__assign)(Object(f.__assign)({},e),t),{effects:Object(f.__assign)(Object(f.__assign)({},e.effects),t.effects),fonts:Object(f.__assign)(Object(f.__assign)({},e.fonts),t.fonts),palette:Object(f.__assign)(Object(f.__assign)({},e.palette),t.palette)})}var j,F=(function(){function e(e){this._pageContext=e.pageContext?e.pageContext:window._spPageContextInfo;this._getThemeDataSource=e.getThemeDataSource;this._themeProvider=new T(this._loadTheme.bind(this))}e.prototype.loadThemeSlotsMap=function(e){var t=this._getThemeCacheToken();return t?this._themeProvider.loadThemeTokenMap(t,e):b.n.resolve()};e.prototype.loadFullFormattedThemeData=function(e){var t=this;return this.loadFullThemeData(e).then(function(e){if(e){var n={},r=e.palette;for(var i in r){var s=r[i];s&&(n[i]=w.toHtmlString(s))}e.backgroundImageUri&&(n.backgroundImageUri=T.getBackgroundUrl(e));var o={palette:n,isInverted:e.isInverted};return o=H(o,t._pageContext)}})};e.prototype.loadFullThemeData=function(e){var t=this._getThemeCacheToken();if(t)return this._themeProvider.loadThemeData(t,e);return b.n.resolve(void 0)};e.prototype._getThemeCacheToken=function(){var e,t=this._pageContext;if(t){var n=Number(t.webTemplate),r=n===p.e.teamSite||n===p.e.group?t.groupColor:void 0,i=r?r+";web#"+t.webTemplate:null;e=t.themedCssFolderUrl||i||null}return e};e.prototype._loadTheme=function(e){if(!!this._getThemeCacheToken()){this._themeDataSource||(this._themeDataSource=this._getThemeDataSource());return this._themeDataSource.then(function(t){return t?t.loadTheme(e):b.n.resolve()})}return b.n.resolve()};return e})(),I=n(702),q=n(724),R=[.537,.349,.216,.184,.145,.082,.043,.027],U=[.537,.45,.349,.216,.184,.145,.082,.043],z=[.88,.77,.66,.55,.44,.33,.22,.11],W=[.11,.22,.33,.44,.55,.66,.77,.88],X=[.96,.84,.7,.4,.12],V=[.1,.24,.44];(function(e){e[e.Unshaded=0]="Unshaded";e[e.Shade1=1]="Shade1";e[e.Shade2=2]="Shade2";e[e.Shade3=3]="Shade3";e[e.Shade4=4]="Shade4";e[e.Shade5=5]="Shade5";e[e.Shade6=6]="Shade6";e[e.Shade7=7]="Shade7";e[e.Shade8=8]="Shade8"})(j||(j={}));function $(e,t){return{h:e.h,s:e.s,v:e.v-e.v*t}}function J(e,t){return{h:e.h,s:e.s-e.s*t,v:e.v+(100-e.v)*t}}function K(e,t,n){if(!e||t===j.Unshaded||!(function(e){return"number"==typeof e&&e>=j.Unshaded&&e<=j.Shade8})(t))return e;var r=J,i=$;if(n){r=$;i=J}var s=(function(e){var t,n,r=NaN,i=e.R,s=e.G,o=e.B,u=Math.max(i,s,o),a=Math.min(i,s,o),f=u-a;0===f?r=0:i===u?r=(s-o)/f%6:s===u?r=(o-i)/f+2:o===u&&(r=(i-s)/f+4);(r=Math.round(60*r))<0&&(r+=360);t=Math.round(100*(0===u?0:f/u));n=Math.round(u/255*100);return{h:r,s:t,v:n}})(e),o=(function(e){var t=e.h,n=e.s,r=e.v,i=(2-(n/=100))*(r/=100),s=n*r;return{h:t,s:100*(s=(s/=i<=1?i:2-i)||0),l:100*(i/=2)}})(s),u=t-1;return(function(e){var t=e.h,n=e.s,r=e.v,i=[],s=(r/=100)*(n/=100),o=t/60,u=s*(1-Math.abs(o%2-1)),a=r-s;switch(Math.floor(o)){case 0:i=[s,u,0];break;case 1:i=[u,s,0];break;case 2:i=[0,s,u];break;case 3:i=[0,u,s];break;case 4:i=[u,0,s];break;case 5:i=[s,0,u]}return w.fromRgba(Math.round(255*(i[0]+a)),Math.round(255*(i[1]+a)),Math.round(255*(i[2]+a)))})(s=(function(e){return 255===e.R&&255===e.G&&255===e.B})(e)?$(s,R[u]):(function(e){return 0===e.R&&0===e.G&&0===e.B})(e)?J(s,U[u]):o.l/100>.8?i(s,W[u]):o.l/100<.2?r(s,z[u]):u<X.length?r(s,X[u]):i(s,V[u-X.length]))}var Q=(function(){function e(){}e.generateFabricColors=function(t,n){void 0===n&&(n=!1);var r={themeDarker:j.Shade8,themeDark:j.Shade7,themeDarkAlt:j.Shade6,themeLight:j.Shade3,themeLighter:j.Shade2,themeLighterAlt:j.Shade1,themePrimary:j.Unshaded,themeAccent:j.Unshaded,themeSecondary:j.Shade5,themeTertiary:j.Shade4},i=e._getDefaultThemeTokenMap(),s=w.fromRgba(t.R,t.G,t.B);for(var o in r){var u=r[o];i[o]=K(s,u,n)}var a=i.themeAccent;i.themeAccentTranslucent10=a?w.fromRgba(a.R,a.G,a.B,.1*w.maxComponent):null;if(n){var f={black:"#fff",blackTranslucent40:"#66ffffff",neutralDark:"#f4f4f4",neutralPrimary:"#fff",neutralPrimaryTranslucent50:"#7fffffff",neutralPrimaryAlt:"#dadada",neutralSecondary:"#d0d0d0",neutralTertiary:"#c8c8c8",neutralTertiaryAlt:"#6d6d6d",neutralQuaternary:"#4f4f4f",neutralQuaternaryAlt:"#484848",cmdbarSelected:"#4f4f4f",cmdbarSelectedHover:"#484848",neutralLight:"#3f3f3f",neutralLighter:"#313131",neutralLighterAlt:"#282828",white:"#1f1f1f",whiteTranslucent40:"#661f1f1f",error:"#f00",errorBackground:"#7e3333"};for(var l in f)f.hasOwnProperty(l)&&(i[l]=w.fromHtmlColor(f[l]))}return i};e._getDefaultThemeTokenMap=function(){return{backgroundOverlay:null,themeDarker:null,themeDark:null,themeDarkAlt:null,themePrimary:null,themeSecondary:null,themeTertiary:null,themeLight:null,themeLighter:null,themeLighterAlt:null,black:null,cmdbarSelected:null,cmdbarSelectedHover:null,neutralDark:null,neutralPrimary:null,neutralPrimaryAlt:null,neutralPrimaryTranslucent50:null,neutralSecondary:null,neutralSecondaryAlt:null,neutralTertiary:null,neutralTertiaryAlt:null,neutralQuaternary:null,neutralQuaternaryAlt:null,neutralLight:null,neutralLighter:null,neutralLighterAlt:null,white:null,blackTranslucent40:null,whiteTranslucent40:null,yellow:null,yellowLight:null,orange:null,orangeLight:null,redDark:null,red:null,magentaDark:null,magenta:null,magentaLight:null,purpleDark:null,purple:null,purpleLight:null,blueDark:null,blueMid:null,blue:null,blueLight:null,tealDark:null,teal:null,tealLight:null,greenDark:null,green:null,greenLight:null,error:null,errorBackground:null,success:null,successBackground:null,alert:null,alertBackground:null,infoBackground:null,info:null,orangeLighter:null}};return e})(),G=n(181),Y=(function(){function e(){}e.makeWebThemeRestUrl=function(e,t,n){var r=e;r&&"/"===r[r.length-1]&&(r=r.substring(0,r.length-1));r=G.e.escapeUrlForCallback(r);var i=G.e.escapeUrlForCallback(r)+"/_api/SP.Web.GetContextWebThemeData?noImages=true&lcid="+G.e.encodeURIComponent(t);n&&(i+="&ThemeOverride="+G.e.encodeURIComponent(n));return i};e.processWebThemeRestResponse=function(t){var n,r=JSON.parse(t);r&&r.d&&r.d.GetContextWebThemeData&&(n=JSON.parse(r.d.GetContextWebThemeData));return e.processRawThemeData(n)};e.processRawThemeData=function(t){if(t){var n,r=e.coerceToColor,i=e.SetColorIfMissing,s=t.Palette?t.Palette.Colors:{};n=e.convertColorsToRgba(s);var o=Q.generateFabricColors(n.ContentAccent1,t.IsInverted),u=r(n.PageBackground)||r(t.IsInverted?"#1b1a19":"#ffffff"),a=r(n.BackgroundOverlay)||null,f=Math.round(.4*w.maxComponent);for(var l in o)i(n,l,o[l]);i(n,"white",u);i(n,"primaryBackground",w.clone(u));i(n,"primaryText",o.primaryText||r("#333"));i(n,"whiteTranslucent40",u&&w.fromRgba(u.R,u.G,u.B,f));i(n,"backgroundOverlay",a);i(n,"suiteBarBackground",r(n.SuiteBarBackground)||null);i(n,"suiteBarText",r(n.SuiteBarText)||null);i(n,"suiteBarDisabledText",r(n.SuiteBarDisabledText)||null);i(n,"topBarBackground",r(n.TopBarBackground)||null);i(n,"topBarText",r(n.TopBarText)||null);i(n,"topBarHoverText",r(n.TopBarHoverText)||null);i(n,"dialogBorder",r(n.DialogBorder)||null);return{backgroundImageUri:t.BackgroundImageUri,cacheToken:t.ThemeCacheToken,isDefault:t.IsDefault,isInverted:t.IsInverted,palette:n,version:t.Version}}return{backgroundImageUri:"",cacheToken:"",isDefault:!0,isInverted:!1,palette:{},version:""}};e.convertColorsToRgba=function(t){var n={};for(var r in t)if(t.hasOwnProperty(r)){var i=e.coerceToColor(t[r]);i&&(n[r]=i)}return n};e.coerceToColor=function(t){var n;t?"string"==typeof t||t instanceof String?n=w.fromHtmlColor(String(t)):"DefaultColor"in t?n=e.coerceToColor(t.DefaultColor):"R"in t&&"G"in t&&"B"in t&&(n=w.fromRgba(t.R,t.G,t.B,t.A)):n=null;return n};e.SetColorIfMissing=function(e,t,n){e[t]||(e[t]=n)};return e})(),Z=_?"#0078d4":"#03787c",ee=(function(){function e(e){this._pageContext=e;this._dataRequestor=new q.e({qosName:"WebThemeDataSource"},{pageContext:e})}e.prototype.getCacheToken=function(){var e="",t=this._pageContext;if(t){var n=Number(t.webTemplate),r=n!==p.t.mySite&&n!==p.t.mySiteHost?t.groupColor:Z;e=t.themedCssFolderUrl||r}return e};e.prototype.loadTheme=function(e){if(!e&&this._dataPromise)return this._dataPromise;if(!this.getCacheToken())return this._dataPromise=b.n.resolve();this._dataPromise=this._pageContext.themedCssFolderUrl?this.loadServerTheme():this.loadGeneratedTheme();return this._dataPromise};e.prototype.needsRequestDigest=function(e){return!1};e.prototype.loadGeneratedTheme=function(){var e=this._pageContext.groupColor||Z,t=w.fromHtmlColor(e);if(t){var n={backgroundImageUri:null,cacheToken:e,isDefault:!1,isInverted:!1,palette:Q.generateFabricColors(t),version:"1"};return b.n.resolve(n)}return b.n.resolve()};e.prototype.loadServerTheme=function(){var e=this,t=Object(I.t)(this._pageContext),n=this._pageContext.currentUICultureName,r=this._pageContext.themedCssFolderUrl,i=this.getCacheToken()===r&&r||void 0,s=Y.makeWebThemeRestUrl(t,n,i),o=this._dataRequestor.getData({url:s,parseResponse:function(t){e._data=Y.processWebThemeRestResponse(t);return e._data},qosName:"WebThemeDataSource.LoadData",method:"GET"});o.done(null,function(){e._dataPromise=null});return o};return e})();function te(e){var t=e||window._spPageContextInfo;return y({webThemeProvider:function(){return new F({pageContext:t,getThemeDataSource:function(){return b.n.resolve(new ee(t))}})}},t)}var ne=n(68),re=n(331),ie=n(1019),se=n(1052),oe=n(1215),ue=n(1032),ae=(function(){function e(t,n){this._cachePrefix="odSuiteNav";this._cacheDataKey="Data";this._cacheThemeDataKey="ThemeData";this._cacheDateKey="CacheDate";this._cacheVersionKey="CacheVersion";this._cacheSessionKey="CachedThisSession";this._cacheVersion=6;this._cacheExpire=24;this._cacheRenew=12;this._cache=new o.e(this._cachePrefix,u.e.local);this._dataSourceBasic=n.dataSource;this._engagementEvent=t.engagementEvent;this._qosEvents=t.qosEvents;this._capabilities=this._dataSourceBasic.getCapabilities();var r=n.require,i=void 0===r?e.require:r;this._require=i}Object.defineProperty(e.prototype,"suiteNavPlaceholder",{get:function(){return this._suiteNavPlaceholder},set:function(e){this._suiteNavPlaceholder||(this._suiteNavPlaceholder=e)},enumerable:!0,configurable:!0});e.prototype.getCapabilities=function(){return this._capabilities};e.prototype.getO365Shell=function(){var e=this;if(!this._capabilities.supportsRealSuiteNav)return b.n.reject(new Error("getO365Shell is only supported if supportsRealSuiteNav capability is true."));if(m.n.isFeatureEnabled({ODB:1136})){var t=new se.e;return b.n.resolve().then(ue.e.GetLoadPromise).then(function(){return t})}var n=new s.e,r=this._qosEvents&&this._qosEvents[oe.e.GET_O365_SHELL];this._getSuiteNavShellViaBootstrapper(n);n.getPromise().then(function(){e._qosRecordSuccess(r)},function(t){e._qosRecordError(r,t)});return n.getPromise()};e.prototype.getInitialRenderNavBarData=function(){return this._dataSourceBasic.getInitialRenderNavBarData()};e.prototype.getCachedData=function(){var e;if(this._capabilities.supportsCaching&&this._isCacheValid()){var t=this._cache.getValue(this._cacheDataKey);e=t&&t.data}return e};e.prototype.getCachedThemeData=function(){var e;if(this._capabilities.supportsCaching){var t=this._cache.getValue(this._cacheThemeDataKey);t&&t.themeData&&(e=t.themeData)}return e};e.prototype.updateCachedThemeData=function(e){var t={themeData:e,cacheDate:(new Date).toISOString()};this._cache.setValue(this._cacheThemeDataKey,t)};e.prototype._requestShellCore=function(t,n,r){var i=n?t+"?odb_cb="+(new Date).toISOString():t,o=new s.e;this._require(i,"SuiteNavShellCore",function(e){r&&r();var t=new se.e;t.Exists()?o.complete(t):o.error(fe({error:{message:"O365Shell not defined after require() succeeded"},resultCode:"O365ShellNotDefined",extraData:{shellUrl:i}}))},function(t,n){e.removeHeadScriptElement("SuiteNavShellCore");o.error(fe({error:n||t.message,resultCode:"LoadScriptError",extraData:{shellUrl:i}}))});return o.getPromise()};e.removeHeadScriptElement=function(e){var t=document.head.querySelector("#"+e);t&&t.parentNode.removeChild(t)};e.prototype._isCacheValid=function(){var e=this._cache.getValue(this._cacheDataKey),t=this._cache.getValue(this._cacheVersionKey),n=Date.parse(this._cache.getValue(this._cacheDateKey)),r=this._capabilities.supportsRealSuiteNav,i=this._dataSourceBasic;return e&&e.data&&(!r||e.jsUrl)&&t===this._cacheVersion&&e.userIdentifier===i.getUserIdentifier()&&e.cacheToken===i.getCacheToken()&&this._isCacheNotExpired(n,this._cacheExpire)};e.prototype._qosRecordSuccess=function(e){e&&e.end({resultType:S.e.Success})};e.prototype._qosRecordError=function(e,t){e&&e.end(fe({error:t}))};e.prototype._logEngagementData=function(e){this._engagementEvent&&this._engagementEvent.logData(e)};e.prototype._isCacheNotExpired=function(e,t){return!isNaN(e)&&Date.now()-e<60*t*60*1e3};e.prototype._getSuiteNavShellViaBootstrapper=function(e,t){var n=this;this._logEngagementData({name:"SuiteNavProvider.GetO365ShellByBootstrapper"});var r=this._dataSourceBasic.getReactShellBootstrapperUrl();this._requestShellCore(r,t).then(function(t){e.complete(t)},function(t){t=fe({error:t});if(n._hasRetriedO365Shell)e.error(t);else{n._logEngagementData({name:"SuiteNavProvider.O365ShellRetry"});n._hasRetriedO365Shell=!0;n._getSuiteNavShellViaBootstrapper(e,!0)}})};e.require=function(t,n,r,i){var s=function(){return void 0!==window.O365Shell};if(s())r&&r(null);else{var o=document.head.querySelector("#"+n);if(o&&o.src===t)try{Object(ie.t)(s,300,3e4).then(function(){r(null)})}catch(e){i(null,"Unable to load O365Shell")}else{o&&o.src!==t&&e.removeHeadScriptElement(n);var u=document.createElement("script");u.id=n;u.src=t;r&&u.addEventListener("load",function(e){r(e)});i&&u.addEventListener("error",function(e){i(e)});document.head.appendChild(u)}}};return e})();function fe(e){var t=e.error;if(t&&t.resultCode)return t;var n=S.e.Failure;if(b.n.isCanceled(t)){n=S.e.ExpectedFailure;e.resultCode="Canceled"}return{resultType:n,resultCode:e.resultCode||"Other",error:t,extraData:e.extraData}}var le={ODB:556,ODC:null,Fallback:!1},ce={ODB:1302,ODC:null,Fallback:!1},he={ODB:1836,ODC:null,Fallback:!1},pe=(function(e){Object(f.__extends)(t,e);function t(t,n){var r=e.call(this,{engagementEvent:re.e,qosEvents:{"SuiteNavProvider.GetO365Shell":new x.e({name:"SuiteNavProvider.GetO365Shell"})}},n)||this;r._dataSource=n.dataSource;r._cssLoaded=!1;r._isSuiteNavBootstrapperLoadingFlowEnabled=m.n.isFeatureEnabled(ce);return r}t.prototype.clearCachedPromise=function(){this._modelPromise=void 0};t.prototype.loadData=function(e){return this._loadModel(e).then(function(e){return e.data})};t.prototype.getO365Shell=function(){if(this._isSuiteNavBootstrapperLoadingFlowEnabled)return e.prototype.getO365Shell.call(this);if(!this._capabilities.supportsRealSuiteNav)throw new Error("getO365Shell is only supported if supportsRealSuiteNav capability is true.");var t=new s.e,n=new x.e({name:"SuiteNavProvider.GetO365Shell"});this._getSuiteNavShell(t);t.getPromise().then(function(){n.end({resultType:S.e.Success})},function(e){n.end(fe({error:e}))});return t.getPromise()};t.prototype.getMailUrl=function(){return this._loadModel().then(function(e){var t=e&&e.data&&e.data.WorkloadLinks;if(t)for(var n=0,r=t;n<r.length;n++){var i=r[n];if(i&&i.Id===d.e.MAIL)return i.Url}})};t.prototype.updateWorkloadSettingsLinks=function(e){var t,n=this;return this.getO365Shell().then(function(r){return(t=r)&&t.Settings?n.loadData(e):void 0}).then(function(e){e&&e.CurrentWorkloadSettingsSubLinks&&e.CurrentWorkloadSettingsSubLinks.length>0&&t.Settings.SetWorkloadSettingsLinks(e.CurrentWorkloadSettingsSubLinks)}).catch(function(e){re.e.logData({name:"SuiteNavProvider.UpdateWorkloadSettingsLinksError"})})};t.prototype.trySetDataAfterInitialRender=function(e,t){var n=this,r=this._dataSource.getSuiteNavContext();if(r&&r.isConsumer){if(!g.t.isActivated("0461c2e7-c91a-4038-b591-09477f3f84a6","09/27/2021","Extra SuiteNav configuration for Consumer")&&e.NFD){r.helpNamespace&&e.NFD.UpdateHelpNamespace(r.helpNamespace);e.NFD.OnFeedbackMetadataRequested(function(e,t){return e=n._dataSource.setFeedbackMetadata(e,t)});this._addFeedbackButton(e)}this._logEngagementData({name:"SuiteNavProvider.SetDataNotNeededInConsumer"});return b.n.wrap(!0)}re.e.logData({name:"SuiteNavProvider.SetDataAfterInitialRender"});var i=t.actionContext,s=t.bundleLoader;return this.loadData().then(function(t){if(!t){re.e.logData({name:"SuiteNavProvider.NoSuiteNavData"});return!1}if(!e){re.e.logData({name:"SuiteNavProvider.NoO365Shell"});return!1}var r=m.n.isFeatureEnabled(he)&&!!e.NFD,o=r&&n._shouldAddFeedbackButton(e);if(o){var u=JSON.parse(t.ClientData);if(u.OCVFeedbackMAXEnabled){if(!g.t.isActivated("7897BF84-323B-4580-95D2-A14836FE65F6","09/15/2021","Stop modifying OCVFeedbackMAXEnabled")){u.OCVFeedbackMAXEnabled=!1;t.ClientData=JSON.stringify(u)}}else r=o=!1}try{e.SetData(t)}catch(e){re.e.logData({name:"SuiteNavProvider.SetDataFail"});x.e.instrumentPromise({name:"SuiteNav.RefreshCacheAfterInvalidShellData"},function(){return n.loadData(!0)});return!1}t.ActionsMap&&e.Navigation.OnLinkClick(function(e){var n=t.ActionsMap[e.Id];n&&(e.Cancel=!n(Object(f.__assign)(Object(f.__assign)({},e),i||{})))});e.OnHasMember("OnDataChanged",function(){e.OnDataChanged(function(){return x.e.instrumentPromise({name:"SuiteNav.RefreshCacheForShellDataChanged"},function(){return n.loadData(!0)}).done()})});if(r){e.NFD.OnFeedbackMetadataRequested(function(e,t){return e=n._dataSource.setFeedbackMetadata(e,t)});o&&n._addFeedbackButton(e)}s&&s.pageRenderingIsComplete();return!0},function(e){re.e.logData({name:"SuiteNavProvider.LoadDataError"});return!1})};t.prototype._getSuiteNavShell=function(e,t){var n=this;this._loadModel().then(function(r){if(!n._cssLoaded&&r.cssUrl){ne.e.loadStylesheet(r.cssUrl);n._dataSource.onCssLoad&&n._dataSource.onCssLoad(r);n._cssLoaded=!0}re.e.logData({name:"SuiteNavProvider.GetO365ShellByS2S"});n._requestShellCore(r.jsUrl,t,de).then(function(t){e.complete(t)},function(t){n._modelPromise=void 0;if((t=fe({error:t}))&&"LoadScriptError"===t.resultCode&&n._isDataFromCache){re.e.logData({name:"SuiteNavProvider.O365ShellCacheFailed"});n._clearCache();n._getSuiteNavShell(e)}else if(n._hasRetriedShell)e.error(t);else{n._hasRetriedShell=!0;n._cssLoaded=!1;re.e.logData({name:"SuiteNavProvider.O365ShellRetry"});n._getSuiteNavShell(e,!0)}})})};t.prototype._loadModel=function(e){var t=this;if(!e&&this._modelPromise)return this._modelPromise;var n,r,i=new s.e,o=this._capabilities.supportsCaching,u=this._dataSource,a=S.e.Failure,f=x.e.instrumentPromise({name:"SuiteNavProvider.LoadData"},function(){return new b.n(function(r,i){var s;!e&&o&&t._isCacheValid()&&(s=t._cache.getValue(t._cacheDataKey));if(s&&s.data){re.e.logData({name:"SuiteNavProvider.DataFromCache"});u.updateDataForCurrentPage&&(s.data=u.updateDataForCurrentPage(s.data));if(o&&t._isCacheOutdated()){re.e.logData({name:"SuiteNavProvider.RefreshCache"});u.loadData().then(function(e){t._updateCache(e)})}t._isDataFromCache=!0;r(s)}else{t._isDataFromCache=!1;e&&re.e.logData({name:"SuiteNavProvider.ForceUpdateData"});re.e.logData({name:"SuiteNavProvider.DataFromServer"});u.loadData().done(function(e){if(e)if(e.data){o&&!(function(e){var t=e&&e.data&&e.data.WorkloadLinks;return!!t&&t.some(function(e){return e&&!e.Url})})(e)&&t._updateCache(e);r(e)}else{n="NoModelData";i("Model with no data returned")}else{n="NoModel";i("No model returned")}},function(e){if(b.n.isCanceled(i)){n="Canceled";a=S.e.ExpectedFailure}else n="ServerLoadFailure";i(e)})}})},null,function(e){if(b.n.isCanceled(e)){a=S.e.ExpectedFailure;n="Canceled"}return{resultType:a,resultCode:n||"Other",error:e}});(r=te())?this._modelPromise=b.n.all({suiteNavModel:f,theme:r.loadThemeSlotsMap()}).then(function(e){var t=e.suiteNavModel,n=e.theme,r=t&&t.data,i=t&&t.hasCobranding,s=r&&r.UseSPOBehaviors,o=m.n.isFeatureEnabled(le),u=n&&n.suiteBarBackground;!(u&&r&&s)||i&&o||(r.ThemeColors=[u,n.primaryText,u,n.suiteBarText,n.suiteBarDisabledText,n.topBarBackground,n.topBarText,n.topBarHoverText,n.primaryBackground,n.themeLighterAlt,n.dialogBorder]);return t}):this._modelPromise=f;this._modelPromise.then(function(e){return i.complete(e)},function(e){return i.error(e)});return i.getPromise()};t.prototype._shouldAddFeedbackButton=function(e){var t=!1;if(m.n.isFeatureEnabled({ODB:_?-1246:1246,ODC:null,Fallback:!1})){var n=this._dataSource.getWebTemplateType?this._dataSource.getWebTemplateType():p.t.invalid,r=/\/_layouts\/15\/Lists.aspx$/i;t=g.t.isActivated("9BCCA26C-EC25-44FF-A395-2D6D04734F76","09/15/2021","More specific ODB check for Feedback button")?n!==p.t.mySiteHost&&n!==p.t.mySite&&n!==p.t.tenantAdmin||r.test(window.location.pathname):n!==p.t.mySiteHost&&!_&&n!==p.t.tenantAdmin||r.test(window.location.pathname)}return t};t.prototype._addFeedbackButton=function(e){var t;null===(t=e.Extensibility)||void 0===t||t.AddOrUpdateCustomHeaderButton({affordanceMenuItemText:l.e,ariaLabel:l.e,iconFontFamily:"FabricMDL2Icons",iconFontName:"î´•",id:"GiveFeedbackButton",onShow:function(){var t;if(e.FlexPane){e.FlexPane.OpenFlexPaneForProvider("Feedback");v.e.raise(document.body,"resize",void 0,!0)}null===(t=e.Extensibility)||void 0===t||t.UpdateButtonState("GiveFeedbackButton",!0)},onHide:function(){var t;null===(t=e.FlexPane)||void 0===t||t.CloseFlexPaneForProvider("Feedback");v.e.raise(document.body,"resize",void 0,!0)}})};t.prototype._clearCache=function(){this._cache.remove(this._cacheDataKey);this._cache.remove(this._cacheThemeDataKey);this._cache.remove(this._cacheDateKey);this._cache.remove(this._cacheVersionKey);this._cache.remove(this._cacheSessionKey,u.e.session)};t.prototype._updateCache=function(e,t){this._cache.setValue(this._cacheDataKey,e);this._cache.setValue(this._cacheDateKey,new Date);this._cache.setValue(this._cacheVersionKey,this._cacheVersion);this._cache.setValue(this._cacheSessionKey,!0,u.e.session)};t.prototype._isCacheOutdated=function(){var e=this._cache.getValue(this._cacheSessionKey,u.e.session),t=Date.parse(this._cache.getValue(this._cacheDateKey));return o.e.hasStorageType(u.e.session)&&!e||Date.now()-t>=60*this._cacheRenew*60*1e3};return t})(ae);function de(){var e=window._o365su;if(e&&e.b)for(var t=0,n=["ThrowOnNull","ThrowOnUndefined","ThrowOnNullOrUndefined","ThrowOnNullOrEmpty","ThrowOnNullOrEmptyArray"];t<n.length;t++){var r=n[t];ve(e.b,r)}}function ve(e,t){var n=e[t];"function"==typeof n&&(e[t]=function(){for(var e=[],r=0;r<arguments.length;r++)e[r]=arguments[r];try{return n.apply(this,e)}catch(e){h.logData({message:e&&e.message||"",stack:e&&e.stack||"",type:t})}})}var me=n(1219),ge=n(15),ye=n(4),be=n(831),we=new o.e("odSuiteNav",u.e.local),Ee=(function(){function e(e,t){this._dataSource=t.dataSource;this._capabilities=this._dataSource.getCapabilities();this._cssLoaded=!1}Object.defineProperty(e.prototype,"suiteNavPlaceholder",{get:function(){return this._suiteNavPlaceholder},set:function(e){this._suiteNavPlaceholder||(this._suiteNavPlaceholder=e)},enumerable:!1,configurable:!0});Object.defineProperty(e.prototype,"accountSwitchCallback",{get:function(){return this._dataSource.accountSwitchCallback},enumerable:!1,configurable:!0});e.prototype.getCapabilities=function(){return this._capabilities};e.prototype.clearCachedPromise=function(){this._modelPromise=void 0;this._shellSignal=void 0};e.prototype.getRenderSetting=function(e){return this._dataSource.getRenderSetting?this._dataSource.getRenderSetting(e):null};e.prototype.loadData=function(e){return this._loadModel(e).then(function(e){return e.data})};e.prototype.getO365Shell=function(){if(!this._capabilities.supportsRealSuiteNav)throw new Error("getO365Shell is only supported if supportsRealSuiteNav capability is true.");var e=this._shellSignal;if(!e){e=new s.e;var t=new x.e({name:"SuiteNavProvider.GetO365Shell"});this._getSuiteNavShell(e);e.getPromise().then(function(){t.end({resultType:S.e.Success})},function(e){t.end(ke({error:e}))});this._shellSignal=e}return e.getPromise()};e.prototype.getMailUrl=function(){return this._loadModel().then(function(e){var t=e&&e.data&&e.data.WorkloadLinks;if(t)for(var n=0,r=t;n<r.length;n++){var i=r[n];if(i&&i.Id===d.e.MAIL)return i.Url}})};e.prototype._getSuiteNavShell=function(e,t){var n=this;this._loadModel().then(function(r){if(!n._cssLoaded&&r.cssUrl){ne.e.loadStylesheet(r.cssUrl);n._dataSource.onCssLoad&&n._dataSource.onCssLoad(r);n._cssLoaded=!0}var i=r.requireConfig,s=i&&i.paths;t&&s&&(s.shellcore+=".js?odb_cb="+(new Date).toISOString());be.e.addConfig(r.requireConfig);n._requestShellCore().then(function(t){e.complete(t)},function(t){if((t=ke({error:t}))&&"RequireError"===t.resultCode&&n._isDataFromCache){re.e.logData({name:"SuiteNavProvider.O365ShellCacheFailed"});n._getSuiteNavShell(e)}else if(n._hasRetriedShell)e.error(t);else{n._hasRetriedShell=!0;n._cssLoaded=!1;re.e.logData({name:"SuiteNavProvider.O365ShellRetry"});n._getSuiteNavShell(e,!0)}})})};e.prototype._requestShellCore=function(){var e=this,t=new s.e,n=requirejs.toUrl("shellcore");window.require(["shellcore"],function(){(function(){var e=window._o365su;if(!e||!e.b)return;for(var t=0,n=["ThrowOnNull","ThrowOnUndefined","ThrowOnNullOrUndefined","ThrowOnNullOrEmpty","ThrowOnNullOrEmptyArray"];t<n.length;t++){var r=n[t];Ce(e.b,r)}})();var e=new me.e;e.Exists()?t.complete(e):t.error(ke({error:{message:"O365Shell not defined after require() succeeded"},resultCode:"O365ShellNotDefined",extraData:{shellUrl:n}}))},function(r){e._capabilities.supportsCaching&&xe();requirejs.undef("shellcore");e._modelPromise=void 0;t.error(ke({error:r,resultCode:"RequireError",extraData:{shellUrl:n}}))});return t.getPromise()};e.prototype._loadModel=function(e){var t=this;if(!e&&this._modelPromise)return this._modelPromise;var n,r,i=this._capabilities.supportsCaching,s=this._dataSource,a=S.e.Failure,f=x.e.instrumentPromise({name:"SuiteNavProvider.LoadData"},function(){return new b.n(function(r,f){var l,c,h;!e&&i&&t._isCacheValid()&&(l=we.getValue("Data"));if(l&&l.data){re.e.logData({name:"SuiteNavProvider.DataFromCache"});s.updateDataForCurrentPage&&s.updateDataForCurrentPage(l.data);if(i&&(c=we.getValue("CachedThisSession",u.e.session),h=Date.parse(we.getValue("CacheDate")),o.e.hasStorageType(u.e.session)&&!c||Date.now()-h>=432e5)){re.e.logData({name:"SuiteNavProvider.RefreshCache"});s.loadData().done(Ne)}t._isDataFromCache=!0;r(l)}else{t._isDataFromCache=!1;e&&re.e.logData({name:"SuiteNavProvider.ForceUpdateData"});re.e.logData({name:"SuiteNavProvider.DataFromServer"});s.loadData(e).done(function(e){if(e)if(e.data){i&&!Te(e)&&Ne(e);r(e)}else{n="NoModelData";f("Model with no data returned")}else{n="NoModel";f("No model returned")}},function(e){if(b.n.isCanceled(f)){n="Canceled";a=S.e.ExpectedFailure}else n="ServerLoadFailure";f(e)})}})},null,function(e){if(b.n.isCanceled(e)){a=S.e.ExpectedFailure;n="Canceled"}return{resultType:a,resultCode:n||"Other",error:e}});(r=te())?this._modelPromise=b.n.all({suiteNavModel:f,theme:r.loadThemeSlotsMap()}).then(function(e){var t=e.suiteNavModel,n=e.theme,r=t&&t.data,i=t&&t.hasCobranding,s=r&&r.UseSPOBehaviors,o=Object(ye.isFeatureEnabled)(ye.SuiteNavPrefersTenantTheme),u=n&&n.suiteBarBackground;!(u&&r&&s)||i&&o||(r.ThemeColors=[u,n.primaryText,u,n.suiteBarText,n.suiteBarDisabledText,n.topBarBackground,n.topBarText,n.topBarHoverText,n.primaryBackground,n.themeLighterAlt,n.dialogBorder]);return t}):this._modelPromise=f;return this._modelPromise};e.prototype._isCacheValid=function(){var e=we.getValue("Data"),t=we.getValue("CacheVersion"),n=Date.parse(we.getValue("CacheDate")),r=this._capabilities.supportsRealSuiteNav,i=this._dataSource,s=e&&e.data&&(!r||e.requireConfig)&&5===t&&e.userIdentifier===i.getUserIdentifier()&&e.cacheToken===i.getCacheToken()&&!isNaN(n)&&Date.now()-n<864e5;if(!s){var o={model:!!e,"model.data":e&&!!e.data,"model.requireConfig":e&&!!e.requireConfig,supportsRealSuiteNav:r,oldVersion:t,CACHE_VERSION:5,userIsIdentical:e&&e.userIdentifier===i.getUserIdentifier(),cacheToken:e&&e.cacheToken,dataSourceCacheToken:i.getCacheToken(),cacheDate:!isNaN(n),expired:Date.now()-n>=864e5};re.e.logData({name:"SuiteNavCacheDataInvalid",extraData:o})}return s};return e})(),Se=(t.default=Ee,Object(ye.isFeatureEnabled)(ye.UnifiedSuiteNavComponent)?Object(a.s)("SuiteNavProvider",pe,{dataSource:ge.de}):Object(a.s)("SuiteNavProvider",Ee,{dataSource:ge.pe}));function xe(){we.remove("Data");we.remove("CacheDate");we.remove("CacheVersion");we.remove("CachedThisSession",u.e.session)}function Te(e){var t=e&&e.data&&e.data.WorkloadLinks;return!!t&&t.some(function(e){return e&&!e.Url})}function Ne(e){we.setValue("Data",e);we.setValue("CacheDate",new Date);we.setValue("CacheVersion",5);we.setValue("CachedThisSession",!0,u.e.session)}function Ce(e,t){var n=e[t];"function"==typeof n&&(e[t]=function(){for(var e=[],r=0;r<arguments.length;r++)e[r]=arguments[r];try{return n.apply(this,e)}catch(e){h.logData({message:e&&e.message||"",stack:e&&e.stack||"",type:t})}})}function ke(e){var t=e.error;if(t&&t.resultCode)return t;var n=S.e.Failure;if(b.n.isCanceled(t)){n=S.e.ExpectedFailure;e.resultCode="Canceled"}return{resultType:n,resultCode:e.resultCode||"Other",error:t,extraData:e.extraData}}},587:function(e,t,n){"use strict";n.r(t);n.d(t,"resourceKey",function(){return F});var r=n(12);Object(r.n)([{rawString:".od-SuiteNav{background:"},{theme:"themePrimary",defaultValue:"#0078d4"},{rawString:";height:48px;position:absolute;width:100%}.od-userSelect--enabled div#o365cs-flexpane-overlay{-webkit-touch-callout:text;-webkit-user-select:text;-ms-user-select:text;user-select:text}.pluginNoSize{width:0;height:0;padding:0;position:absolute}.od-SuiteNav-reactShell-diamond{display:none}"}]);var i=n(16),s=n(0),o=n(1),u=n(10),a=n(28);Object(r.n)([{rawString:".od-SuiteNavFallback{background:"},{theme:"black",defaultValue:"#000000"},{rawString:";color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:";box-sizing:border-box;height:48px;position:absolute;top:0;left:0;right:0;z-index:2001}.od-SuiteNavFallback header{font-size:22px;display:inline-block;line-height:48px;padding:0 0 0 18px;height:48px}html[dir=rtl] .od-SuiteNavFallback header{padding:0 18px 0 0}.od-SuiteNavFallback-divider{margin:5px 15px 0 0}html[dir=ltr] .od-SuiteNavFallback-divider{border-left-style:solid}html[dir=rtl] .od-SuiteNavFallback-divider{border-right-style:solid}html[dir=ltr] .od-SuiteNavFallback-divider{border-left-width:1px}html[dir=rtl] .od-SuiteNavFallback-divider{border-right-width:1px}html[dir=ltr] .od-SuiteNavFallback-divider{border-left-color:rgba(255,255,255,.35)}html[dir=rtl] .od-SuiteNavFallback-divider{border-right-color:rgba(255,255,255,.35)}html[dir=rtl] .od-SuiteNavFallback-divider{margin:5px 0 0 15px}[dir=ltr] .od-SuiteNavFallback-o365Title{padding-right:15px}[dir=rtl] .od-SuiteNavFallback-o365Title{padding-left:15px}.od-SuiteNavFallback-selectedApp{color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:";text-decoration:none;height:48px}.od-SuiteNavFallback-selectedApp:active,.od-SuiteNavFallback-selectedApp:hover{color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:"}.od-SuiteNavFallback-appButton{-webkit-touch-callout:none;-webkit-user-select:none;-ms-user-select:none;user-select:none;background:#0078d4;display:inline-block;color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:";height:48px;width:48px;cursor:pointer;font-size:18px;text-align:center;padding-top:16px;transition:background-color 467ms cubic-bezier(.1,.9,.2,1) 34ms;box-sizing:border-box}html[dir=ltr] .od-SuiteNavFallback-appButton{float:left}html[dir=rtl] .od-SuiteNavFallback-appButton{float:right}html[dir=ltr] .od-SuiteNavFallback-appButton{border-right-style:solid}html[dir=rtl] .od-SuiteNavFallback-appButton{border-left-style:solid}html[dir=ltr] .od-SuiteNavFallback-appButton{border-right-color:rgba(255,255,255,.2)}html[dir=rtl] .od-SuiteNavFallback-appButton{border-left-color:rgba(255,255,255,.2)}html[dir=ltr] .od-SuiteNavFallback-appButton{border-right-width:1px}html[dir=rtl] .od-SuiteNavFallback-appButton{border-left-width:1px}.od-SuiteNavFallback-appButton:active,.od-SuiteNavFallback-appButton:hover{color:#fff;background-color:#104a7d}.od-SuiteNavFallback-rightActions{display:block;height:48px;position:absolute;top:0;white-space:nowrap;margin:0;padding:0;list-style-type:none}[dir=ltr] .od-SuiteNavFallback-rightActions{right:0}[dir=rtl] .od-SuiteNavFallback-rightActions{left:0}.od-SuiteNavFallback-rightActions li{height:48px;line-height:0;width:51px;cursor:pointer;position:relative;box-sizing:border-box;margin:0;padding:0}html[dir=ltr] .od-SuiteNavFallback-rightActions li{float:left}html[dir=rtl] .od-SuiteNavFallback-rightActions li{float:right}html[dir=ltr] .od-SuiteNavFallback-rightActions li{border-left-style:solid}html[dir=rtl] .od-SuiteNavFallback-rightActions li{border-right-style:solid}html[dir=ltr] .od-SuiteNavFallback-rightActions li{border-left-width:1px}html[dir=rtl] .od-SuiteNavFallback-rightActions li{border-right-width:1px}html[dir=ltr] .od-SuiteNavFallback-rightActions li{border-left-color:"},{theme:"neutralSecondaryAlt",defaultValue:"#8a8886"},{rawString:"}html[dir=rtl] .od-SuiteNavFallback-rightActions li{border-right-color:"},{theme:"neutralSecondaryAlt",defaultValue:"#8a8886"},{rawString:"}.od-SuiteNavFallback-rightActions .ms-Icon{line-height:48px}[dir=ltr] .od-SuiteNavFallback-rightActions .ms-ContextualMenu{right:0}[dir=rtl] .od-SuiteNavFallback-rightActions .ms-ContextualMenu{left:0}.od-SuiteNavFallback-persona{display:inline-block;width:53px;vertical-align:top;height:48px}html[dir=ltr] .od-SuiteNavFallback-persona{border-left-style:solid}html[dir=rtl] .od-SuiteNavFallback-persona{border-right-style:solid}html[dir=ltr] .od-SuiteNavFallback-persona{border-left-width:1px}html[dir=rtl] .od-SuiteNavFallback-persona{border-right-width:1px}html[dir=ltr] .od-SuiteNavFallback-persona{border-left-color:"},{theme:"neutralSecondaryAlt",defaultValue:"#8a8886"},{rawString:"}html[dir=rtl] .od-SuiteNavFallback-persona{border-right-color:"},{theme:"neutralSecondaryAlt",defaultValue:"#8a8886"},{rawString:"}html[dir=ltr] .od-SuiteNavFallback-persona{text-align:right}html[dir=rtl] .od-SuiteNavFallback-persona{text-align:left}.od-SuiteNavFallback-persona.online{background:#5dd255}html[dir=ltr] .od-SuiteNavFallback-persona .ms-ContextualMenu{text-align:left}html[dir=rtl] .od-SuiteNavFallback-persona .ms-ContextualMenu{text-align:right}html[dir=ltr] .od-SuiteNavFallback-personaImage{float:right}html[dir=rtl] .od-SuiteNavFallback-personaImage{float:left}.od-SuiteNavFallback-link{display:inline-block;height:48px;width:48px;color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:";font-size:20px;text-align:center}.od-SuiteNavFallback-link.selected,.od-SuiteNavFallback-link:hover{color:#fff;background:#104a7d}.od-SuiteNavFallback-meLink{display:inline-block}.od-SuiteNavFallback-options .ms-ContextualMenu{margin-top:19px!important}.od-SuiteNavFallback-menuContainer{display:inline-block;z-index:-1}"}]);Object(r.n)([{rawString:".AppLauncher{background:"},{theme:"white",defaultValue:"#ffffff"},{rawString:";border:1px solid #b6b6b6;box-shadow:0 1px 15px rgba(0,0,0,.4);box-sizing:content-box!important;padding:20px 0 10px 20px;position:absolute;top:50px;margin:10px;width:auto;height:auto;min-width:240px;max-width:840px;max-height:990px;z-index:100;transition-property:max-height,max-width;transition-duration:267ms;transition-timing-function:cubic-bezier(.1,.9,.2,1);-webkit-transition-property:max-height,max-width;-webkit-transition-duration:267ms;-webkit-transition-timing-function:cubic-bezier(.1,.9,.2,1)}html[dir=rtl] .AppLauncher{padding:20px 20px 10px 0}[dir=ltr] .AppLauncher{left:0}[dir=rtl] .AppLauncher{right:0}.AppLauncher-beak{position:absolute;top:0;z-index:10}[dir=ltr] .AppLauncher-beak{left:0}[dir=rtl] .AppLauncher-beak{right:0}.AppLauncher-beak:after,.AppLauncher-beak:before{content:' ';border:solid transparent;height:0;position:absolute;width:0}.AppLauncher-beak:before{border-width:9px;border-bottom-color:#b6b6b6;top:-18px}[dir=ltr] .AppLauncher-beak:before{left:5px}[dir=rtl] .AppLauncher-beak:before{right:5px}.AppLauncher-beak:after{border-width:8px;border-bottom-color:#fff;top:-16px}[dir=ltr] .AppLauncher-beak:after{left:6px}[dir=rtl] .AppLauncher-beak:after{right:6px}.AppLauncher-greybackground{background-color:#999;width:100%;height:100%}.AppLauncher-listItem{width:109px;height:109px;display:block;margin:0 10px 10px 0;position:relative;color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:";cursor:pointer;-webkit-touch-callout:none;-webkit-user-select:none;-ms-user-select:none;user-select:none;transition:167ms transform cubic-bezier(.1,.9,.2,1);box-sizing:border-box}html[dir=ltr] .AppLauncher-listItem{float:left}html[dir=rtl] .AppLauncher-listItem{float:right}html[dir=rtl] .AppLauncher-listItem{margin:0 0 10px 10px}.AppLauncher-listItem:hover .app-more-menu-button{display:block}.AppLauncher-listItem.wide{width:230px}.AppLauncher-listItem:active{transform:scale(.95);-webkit-transform:scale(.95)}.AppLauncher-listItem i::before{color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:"}.AppLauncher-listItem .AppLauncher-inner{top:0;right:0;bottom:0;left:0;position:absolute;text-align:center;background:"},{theme:"themePrimary",defaultValue:"#0078d4"},{rawString:";border:2px solid transparent}.AppLauncher-listItem .AppLauncher-inner:hover{outline-width:2px;outline-style:solid}.AppLauncher-listItem .AppLauncher-inner .AppLauncher-menuTitle{font-size:12px;color:#fff;position:absolute;bottom:5px;width:85px;display:block;overflow:hidden;text-overflow:ellipsis;white-space:nowrap}[dir=ltr] .AppLauncher-listItem .AppLauncher-inner .AppLauncher-menuTitle{left:8px}[dir=rtl] .AppLauncher-listItem .AppLauncher-inner .AppLauncher-menuTitle{right:8px}html[dir=ltr] .AppLauncher-listItem .AppLauncher-inner .AppLauncher-menuTitle{text-align:left}html[dir=rtl] .AppLauncher-listItem .AppLauncher-inner .AppLauncher-menuTitle{text-align:right}.AppLauncher-listItem .AppLauncher-inner .ms-Icon{position:relative;font-size:49px;top:26px;color:#fff!important}.AppLauncher-listItem .AppLauncher-inner img{position:absolute;top:20px}[dir=ltr] .AppLauncher-listItem .AppLauncher-inner img{left:24px}[dir=rtl] .AppLauncher-listItem .AppLauncher-inner img{right:24px}.AppLauncher-listItem .word{background:#2b579a}.AppLauncher-listItem .excel{background:#207346}.AppLauncher-listItem .powerpoint{background:#d24725;padding:0!important}.AppLauncher-listItem .onenote{background:#80397b}.AppLauncher-listItem .project{background-color:#5133ab}.AppLauncher-listItem .tasks{background:#31752e}.AppLauncher-listItem .oslo .ms-Icon{font-size:64px;padding-top:3px}.AppLauncher-listItem .more-apps{background-color:"},{theme:"neutralLight",defaultValue:"#edebe9"},{rawString:"}.AppLauncher-listItem .more-apps .ms-Icon{top:40px;font-size:25px}.app-more-menu-container{position:absolute}[dir=ltr] .app-more-menu-container{right:0}[dir=rtl] .app-more-menu-container{left:0}.app-more-menu-container .app-more-menu-button{font-size:16px;cursor:pointer;color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:";text-align:center;width:30px;height:20px;display:none}.app-more-menu-container .more-menu-list{display:none;background:#fff;border:1px solid #e5f0f9;list-style-type:none;width:165px;margin:0;padding:0;position:absolute;top:0;z-index:999;box-shadow:0 0 8px rgba(0,0,0,.6);font-size:12px}[dir=ltr] .app-more-menu-container .more-menu-list{left:100%}[dir=rtl] .app-more-menu-container .more-menu-list{right:100%}html[dir=ltr] .app-more-menu-container .more-menu-list{text-align:left}html[dir=rtl] .app-more-menu-container .more-menu-list{text-align:right}.app-more-menu-container .more-menu-list li a{padding:5px 15px;width:auto;display:block;color:#000}.app-more-menu-container .more-menu-list li a:hover{background-color:#e5f0f9}.app-more-menu-container.open .more-menu-list{display:block}.appmenu-app-more{background-color:#fff;vertical-align:bottom;margin:0 20px 10px 0}html[dir=ltr] .appmenu-app-more{float:right}html[dir=rtl] .appmenu-app-more{float:left}html[dir=ltr] .appmenu-app-more{text-align:right}html[dir=rtl] .appmenu-app-more{text-align:left}html[dir=rtl] .appmenu-app-more{margin:0 0 10px 20px}.appmenu-app-more a.appmenu-app-moretext{color:#000;font-size:12px;font-family:SegoeUI-SemiBold-final,Segoe,Tahoma,Helvetica,Arial,sans-serif}.app-provisioning:hover,.appmenu-app-more:hover{outline:0}.app-provisioning{opacity:.2}@media (max-width:940px){.AppLauncher{max-width:486px}}@media (max-width:580px){.AppLauncher{max-width:335px}.AppLauncher-listItem{width:55px;height:55px}.AppLauncher-listItem .AppLauncher-inner .ms-Icon{font-size:25px;top:13px}.AppLauncher-listItem .AppLauncher-inner .AppLauncher-menuTitle{display:none}}@media (max-width:460px){.AppLauncher{max-width:205px;min-width:205px}}@media (max-height:950px){.AppLauncher{max-height:730px}}@media (max-height:820px){.AppLauncher{max-height:610px}}@media (max-height:700px){.AppLauncher{max-height:490px}}@media (max-height:600px){.AppLauncher{max-height:360px}}@media (max-height:460px){.AppLauncher{max-height:240px}}"}]);var f=n(550),l=(function(e){Object(s.__extends)(t,e);function t(){var t=null!==e&&e.apply(this,arguments)||this;t.apps=[{id:1,key:"c_h_mail",name:"Outlook",icon:"OutlookLogo",color:"#0072c6",img:"",text:"",size:"small",appType:"o365",link:"https://mail.live.com",pinned:!0},{id:2,key:"c_h_ppl",name:"People",icon:"Contact",color:"#d24726",img:"",text:"",size:"small",appType:"o365",link:"https://people.live.com",pinned:!0},{id:3,key:"c_h_cal",name:"Calendar",icon:"Calendar",color:"#5133ab",img:"",text:"",size:"wide",appType:"o365",link:"https://calendar.live.com",pinned:!0},{id:4,key:"c_h_sd",name:"OneDrive",icon:"OneDrive",color:"#094ab2",img:"",text:"",size:"small",appType:"o365",link:"https://onedrive.live.com",pinned:!0},{id:5,key:"c_h_wd",name:"Word",icon:"WordLogo",color:"#2B579A",img:"",text:"",size:"small",appType:"office",link:"https://office.live.com/start/word.aspx",pinned:!0},{id:6,key:"c_h_xl",name:"Excel",icon:"ExcelLogo",color:"#217346",img:"",text:"",size:"small",appType:"office",link:"https://office.live.com/start/excel.aspx",pinned:!0},{id:7,key:"c_h_ppt",name:"PowerPoint",icon:"PowerPointLogo",color:"#D24726",img:"",text:"",size:"small",appType:"office",link:"https://office.live.com/start/powerpoint.aspx",pinned:!0},{id:8,key:"c_h_on",name:"OneNote",icon:"OneNoteLogo",color:"#80397B",img:"",text:"",size:"small",appType:"office",link:"https://office.live.com/start/onenote.aspx",pinned:!0},{id:9,key:"c_h_sw",name:"Sway",icon:"SwayLogo",color:"#008272",img:"",text:"",size:"small",appType:"office",link:"https://g.live.com/8seskydrive/switchersway",pinned:!0},{id:10,key:"c_h_oo",name:"Office",icon:"OfficeLogo",color:"#eb3c00",img:"",text:"",size:"small",appType:"office",link:"https://office.live.com/start/default.aspx",pinned:!0}];return t}t.prototype.getAppText=function(e,t){return window.$Config&&$Config.headerTiles&&$Config.headerTiles[e]&&$Config.headerTiles[e].text||t};t.prototype.getAppClassString=function(e){return"AppLauncher-listItem "+e};t.prototype.getAppUrl=function(e,t){return window.$Config&&$Config.headerTiles&&$Config.headerTiles[e]&&$Config.headerTiles[e].href||t};t.prototype.getAppInnerClassString=function(e){return"AppLauncher-inner "+e};t.prototype.getAppIconClassString=function(e){return Object(f.C)(e)};t.prototype.getAppTileColor=function(e){return"background-color: "+e+";outline-color: "+e};return t})(u.t),c=(i.e({tagName:"ms-app-launcher",template:'<div class="AppLauncher"><div class="AppLauncher-beak"></div><span data-bind="foreach:apps"><div data-bind="attr:{class:$component.getAppClassString(name)}"><a data-bind="attr:{class:$component.getAppInnerClassString(size),href:$component.getAppUrl(key,link),style:$component.getAppTileColor(color)}"><i data-bind="attr:{class:$component.getAppIconClassString(icon)}"></i><span class="AppLauncher-menuTitle" data-bind="text:$component.getAppText(key,name)"></span></a></div></span></div>',viewModel:l,synchronous:!0}),n(49)),h=n(15),p=n(132),d=new(n(44).t)(window),v=(function(){function e(){}e.init=function(e,t){var n=t().defaultSrc;d.on(e,"load",function(){d.off(e,"load");1===e.naturalWidth&&1===e.naturalHeight&&(e.src=n)});d.on(e,"error",function(){d.off(e);e.src=n});o.utils.domNodeDisposal.addDisposeCallback(e,function(){d.off(e)})};e.update=function(e,t){var n=t();e.src=n.src()};return e})(),m=n(53),g=n(2877),y=n(1057),b=n(121),w=n(37),E=n(2213),S=n(6),x=n(31),T=(function(e){Object(s.__extends)(t,e);function t(t){var n=e.call(this,t)||this;n.userTileDefaultUrl=!!window.FilesConfig&&FilesConfig.imgBaseUrl+"/ic/bluemanm.png"||"";n.signInUrl=!!window.FilesConfig&&FilesConfig.si;n._dataSource=n.resources.consume(h.pe);n._urlDataSource=n.resources.consume(h.ye);n.isAppLauncherVisible=o.observable(!1);n.addBindingHandlers({dismiss:b.e,image:v});n.userName=o.observable("");n.userTileUrl=o.observable("");n.optionsChildren=o.observableArray();n.meChildren=o.observableArray();n.menuAlignment=o.observable(m.e.isRightToLeft?c.e.Left:c.e.Right);n.menuLeft=o.observable(m.e.isRightToLeft?"0":"auto");var r=n.resources.consume(x.L);n.isAuthenticated=r&&r.isAuthenticated();if(n._dataSource){n._dataSource.loadData().done(function(e){var t=e.data;n.userName(n._dataSource.getUserName());n.userTileUrl(n._dataSource.getUserTileUrl());var r,i=n.resources.consume(S.e),s=[],o=t.CurrentWorkloadSettingsSubLinks;for(r=0;r<o.length;r++){var u,a=o[r];u=a.Id===E.e.DIAGNOSTICS?new(n.managed(i.ToggleDebugWindowAction)):new(n.managed(y.e))({url:a.Url,target:a.TargetWindow});s.push(new p.e({text:a.Text,action:u}))}var f,l=[],c=t.CurrentWorkloadUserSubLinks,h=n._dataSource.getUserEmail();f=h?w.format(g.i,h):g.r;l.push(new p.e({text:f,action:new(n.managed(i.SignOutAction))({url:t.SignOutLink.Url})}));for(r=0;r<c.length;r++){var d=c[r];l.push(new p.e({text:d.Text,action:new(n.managed(y.e))({url:d.Url,target:d.TargetWindow})}))}n.optionsChildren(s);n.meChildren(l)});n._dataSource.getCapabilities().showO365Text&&(n.o365text=g.t)}else{n.userName("Jon Smith");n.userTileUrl("https://www.placeimg.com/50/50/people");n.optionsChildren([new p.e({text:g.n,action:new(n.managed(y.e))({url:"https://bing.com"})})]);n.meChildren([new p.e({text:g.r})])}n.isOptionsOpen=o.observable(!1);n.isMeMenuOpen=o.observable(!1);n.currentApp=g.e;n.currentAppUrl=n._urlDataSource.getRootUrl();return n}t.prototype.onOptionsDismiss=function(){this.isOptionsOpen(!1)};t.prototype.onMeMenuDismiss=function(){this.isMeMenuOpen(!1)};t.prototype.onAppLauncherClick=function(){this.isAppLauncherVisible(!this.isAppLauncherVisible())};t.prototype.onAppLauncherDismiss=function(){this.isAppLauncherVisible(!1)};t.prototype.onMeMenuClick=function(){this.isMeMenuOpen(!this.isMeMenuOpen())};t.prototype.onOptionsMenuClick=function(){this.isOptionsOpen(!this.isOptionsOpen())};return t})(u.t),N=i.e({tagName:"ms-suitenav-fallback",template:'<div class="od-SuiteNavFallback"><a href="#" class="od-SuiteNavFallback-appButton ms-Icon ms-Icon--Waffle" data-bind="icon:true,click:onAppLauncherClick,clickBubble:false,dismiss:onAppLauncherDismiss"></a><header>\x3c!--ko if:$data.o365text--\x3e<span class="od-SuiteNavFallback-o365Title ms-fontWeight-semilight" data-bind="text:o365text"></span><span class="od-SuiteNavFallback-divider"></span>\x3c!--/ko--\x3e<a class="od-SuiteNavFallback-selectedApp ms-fontWeight-semilight" data-bind="attr:{href:currentAppUrl},text:currentApp"></a></header><ul class="od-SuiteNavFallback-rightActions"><li class="od-SuiteNavFallback-options"><a href="#" class="od-SuiteNavFallback-link od-SuiteNavFallback-optionsLink" data-bind="click:onOptionsMenuClick,dismiss:onOptionsDismiss"><i class="ms-Icon ms-Icon--Settings"></i></a>\x3c!--ko if:$data.isOptionsOpen--\x3e<div class="od-SuiteNavFallback-menuContainer"><ms-contextual-menu params="{ items: optionsChildren, isOpen: isOptionsOpen, alignment: menuAlignment, left: menuLeft }"></ms-contextual-menu></div>\x3c!--/ko--\x3e</li>\x3c!--ko if:$data.isAuthenticated--\x3e<li class="od-SuiteNavFallback-persona"><a href="#" class="od-SuiteNavFallback-link od-SuiteNavFallback-meLink" data-bind="click:onMeMenuClick,dismiss:onMeMenuDismiss"><img height="50" width="50" data-bind="image:{src:userTileUrl,defaultSrc:userTileDefaultUrl},attr:{alt:userName}"></a>\x3c!--ko if:$data.isMeMenuOpen--\x3e<div class="od-SuiteNavFallback-menuContainer"><ms-contextual-menu params="{ items: meChildren, isOpen: isMeMenuOpen, alignment: menuAlignment, left: menuLeft}"></ms-contextual-menu></div>\x3c!--/ko--\x3e</li>\x3c!--/ko--\x3e\x3c!--ko if:!$data.isAuthenticated--\x3e<li class="od-SuiteNavFallback-persona"><a href="#" data-bind="attr:{href:signInUrl}"><img class="od-SuiteNavFallback-personaImage" height="50" width="50" data-bind="attr:{src:userTileDefaultUrl}"></a></li>\x3c!--/ko--\x3e</ul><ms-app-launcher data-bind="visible:isAppLauncherVisible"></ms-app-launcher></div>',viewModel:T}),C=n(558),k=n(48),L=n(1775),A=n(226),O=n(34),M=n(75),_=n(1004),D=n(4),P=(function(e){Object(s.__extends)(t,e);function t(t,n){void 0===t&&(t={});var r=e.call(this,t,n)||this;r._navigation=r.resources.consume(k.e);r._hamburgerCallback=t.hamburgerCallback;r._hamburgerIsUnavailable=t.hamburgerIsUnavailable||o.observable(!1);r._suiteNavRenderedCallback=t.suiteNavRenderedCallback;r.jewelIconCssName=Object(f.C)("Diamond");r._provider=r.resources.consume(C.resourceKey);if(r._provider){r._capabilities=r._provider.getCapabilities();r._dataPromise=r._provider.loadData()}r._capabilities||(r._capabilities={supportsCaching:!1,supportsRealSuiteNav:!1,showO365Text:!0});r.supportsRealSuiteNav=r._capabilities.supportsRealSuiteNav;r.mockTagName=N.tagName;r.isReactShell=Object(D.isFeatureEnabled)(D.UseReactConsumerShell);r.addBindingHandlers({activate:L.e});r._bundleLoader=r.resources.consume(x.e);var i=r.resources.consume(M.u.optional);if(i&&i.isSiteAdmin){var s=r.resources.consume(S.e);i.isHubSite&&(window._spLaunchHubSettings=function(){var e=new(r.managed(s.LaunchHubSettingsPanelAction))({});e.execute(null).then(function(){return e.dispose()},function(){return e.dispose()})});window._spLaunchSiteSettings=function(){var e=new(r.managed(s.LaunchSiteSettingsPanelAction))({});e.execute(null).then(function(){return e.dispose()},function(){return e.dispose()})}}return r}t.prototype.render=function(e){var r=this;e.id||(e.id="SuiteNav-"+String(t._suiteNavNum++));var i=this._navigation;if(this.supportsRealSuiteNav&&this._dataPromise&&"1"!==i.viewParams.nosuite&&"1"!==i.viewParams.unsuitened){var s=new A.e({name:"SuiteNav.Render"});this._startTimer(s);this._dataPromise.done(function(t){t?r._provider.getO365Shell().done(function(n){if(n){if(!r.isReactShell)try{n.SetData(t)}catch(e){r._recordFailure({event:s,errorType:"SetDataException",error:e});A.e.instrumentPromise({name:"SuiteNav.RefreshCacheAfterInvalidShellData"},function(){return r._provider.loadData(!0)});return}var i=r._provider.getRenderSetting(e.id);null==i&&(i={top:e.id,disableDelayLoad:!0,disableShellPlus:!0,layout:"Mouse",disableSecondaryUserPhotoProvider:!!r._capabilities.disableSecondaryUserPhotoProvider});try{n.RenderAsync(i,function(){r._suiteNavRenderedCallback&&r._suiteNavRenderedCallback(Object(_.r)());r._bundleLoader.pageRenderingIsComplete();r._recordSuccess(s);r.isReactShell||r._onRender(n,t)},function(){r.isReactShell?r._onRender(n,t):r._recordSuccess(s)})}catch(e){r._recordFailure({event:s,errorType:"RenderException",error:e})}n.OnHasMember("OnDataChanged",function(){n.OnDataChanged(function(){return A.e.instrumentPromise({name:"SuiteNav.RefreshCacheForShellDataChanged"},function(){return r._provider.loadData(!0)}).done()})})}else r._recordFailure({event:s,errorType:"NoO365Shell"})},function(e){r._recordFailure({event:s,errorType:"LoadShellError",extraData:{shellUrl:n.p+"shellcore"},error:e})}):r._recordFailure({event:s,errorType:"NoData"})},function(e){r._recordFailure({event:s,errorType:"LoadDataError",error:e})})}else this._hamburgerIsUnavailable(!0)};t.prototype._onRender=function(e,t){var n=this;t.ActionsMap&&e.Navigation.OnLinkClick(function(e){var r=t.ActionsMap[e.Id];r&&(e.Cancel=!r.call(n,n.resources))});this._hamburgerCallback&&(e.Navigation.OnHamburgerButtonClick?e.Navigation.OnHamburgerButtonClick(this._hamburgerCallback):this._hamburgerIsUnavailable(!0));this._provider.accountSwitchCallback&&e.MeControl.OnAccountSwitchInitiated(this._provider.accountSwitchCallback)};t.prototype._recordSuccess=function(e){if(this._eventFinishedTimer){this._stopTimer();e.end({resultType:O.e.Success})}};t.prototype._recordFailure=function(e){this._hamburgerIsUnavailable(!0);if(this._eventFinishedTimer){this._stopTimer();var t={resultType:O.e.Failure,resultCode:e.errorType};if(e.extraData||e.error){var n=e.extraData||{};e.error&&(n.message=a.e.getErrorMessage(e.error));t.extraData=n}e.event.end(t)}};t.prototype._startTimer=function(e){var t=this;this._eventFinishedTimer=this.async.setTimeout(function(){e.end({resultType:O.e.Failure,resultCode:"Timeout"});t._stopTimer()},45001)};t.prototype._stopTimer=function(){this.async.clearTimeout(this._eventFinishedTimer);this._eventFinishedTimer=null};t.dependencies=Object(s.__assign)({},u.t.dependencies);t._suiteNavNum=0;return t})(u.t),H=n(27),B='<div class="od-SuiteNav" data-bind="activate:render">\x3c!----\x3e<span class="od-SuiteNav-reactShell-diamond ms-Icon" data-bind="class:jewelIconCssName"></span>\x3c!--ko if:!supportsRealSuiteNav--\x3e<div class="od-SuiteNavFallback" data-bind="component:{name:mockTagName}"></div>\x3c!--/ko--\x3e</div>',j=i.e({tagName:"ms-suite-nav",template:B,viewModel:P}),F=Object(H.t)({automationName:"ms-suite-nav",name:"SuiteNav",template:B,viewModelType:P});t.default=j},702:function(e,t,n){"use strict";n.d(t,"e",function(){return a});n.d(t,"n",function(){return l});n.d(t,"t",function(){return c});n.d(t,"r",function(){return h});n.d(t,"s",function(){return p});n.d(t,"o",function(){return d});n.d(t,"i",function(){return v});var r,i,s,o,u,a,f=n(263);n(837);(function(e){e[e.NoWarning=0]="NoWarning";e[e.Warning=1]="Warning";e[e.OverQuota=2]="OverQuota"})(r||(r={}));(function(e){e[e.Default=0]="Default";e[e.AllPages=1]="AllPages";e[e.ModernOnly=2]="ModernOnly";e[e.Hidden=3]="Hidden"})(i||(i={}));(function(e){e[e.None=0]="None";e[e.PrivateChannel=1]="PrivateChannel";e[e.SharedChannel=2]="SharedChannel";e[e.StandardChannel=3]="StandardChannel"})(s||(s={}));(function(e){e[e.Open=0]="Open";e[e.Implicit=1]="Implicit";e[e.Explicit=2]="Explicit";e[e.OwnerModerated=3]="OwnerModerated";e[e.Inferred=4]="Inferred"})(o||(o={}));(function(e){e[e.Default=0]="Default";e[e.Tenant=1]="Tenant";e[e.Hub=2]="Hub";e[e.Site=3]="Site"})(u||(u={}));(function(e){e[e.FooterEnabled=2]="FooterEnabled";e[e.MegaMenuEnabled=128]="MegaMenuEnabled";e[e.FooterEmphasis0=256]="FooterEmphasis0";e[e.FooterEmphasis1=512]="FooterEmphasis1";e[e.FooterLayout0=1024]="FooterLayout0";e[e.FooterLayout1=2048]="FooterLayout1";e[e.HideTitleInHeader=33554432]="HideTitleInHeader";e[e.HorizontalQuickLaunch=1]="HorizontalQuickLaunch"})(a||(a={}));function l(e){var t=e.webAbsoluteUrl,n=e.webServerRelativeUrl;return"/"===n||""===n?t:t.substring(0,t.lastIndexOf(n))}function c(e){return"/"===e.webServerRelativeUrl?"":e.webServerRelativeUrl}function h(e){return e&&!!e.groupId&&e.webAbsoluteUrl===e.siteAbsoluteUrl}function p(e){return e&&e.webAbsoluteUrl===e.siteAbsoluteUrl}function d(e){return e&&p(e)&&e.groupId&&e.isTeamsConnectedSite&&!e.isTeamsChannelSite}function v(e){return f.t.isActivated("447e8c2d-e043-4d54-a0de-ea830706cc0c","06/28/2021","isHomeSite checks against web ID")?!!(e.companyPortalReference&&e.companyPortalReference.SiteId&&e.siteId&&e.siteId.indexOf(e.companyPortalReference.SiteId)>=0):!!(e.companyPortalReference&&e.companyPortalReference.SiteId&&e.companyPortalReference.WebId&&e.siteId&&e.siteId.indexOf(e.companyPortalReference.SiteId)>=0&&e.webId&&e.webId.indexOf(e.companyPortalReference.WebId)>=0)}},716:function(e,t,n){"use strict";n.d(t,"e",function(){return T});n.d(t,"t",function(){return k});var r,i=n(0),s=n(67),o=n(739),u=n(103),a=Object(u.e)({eventName:"RUMOneDataUpload,",shortEventName:"RUMOneDataUpload"},{streamName:1,dictionary:4,privacyClassification:{isPrefixingDisabled:!0,type:1}}).withData({privacyClassification:"requiredService"}),f=n(363),l=n(108),c=n(263),h=n(802),p="undefined"==typeof window?self:window;(function(e){e[e.xhr=0]="xhr";e[e.fetch=1]="fetch"})(r||(r={}));var d,v,m=(function(){function e(){this._requestIdGenerator=(e=0,function(){return(e++).toString()});var e}e.prototype.instrument=function(e){var t=this;if(!p.__RUMOneAPITrackerInstrumented){p.__RUMOneAPITrackerInstrumented=!0;var n=e.fetch,r=e.xhr;if("XMLHttpRequest"in p&&"undefined"!=typeof XMLHttpRequest){this._originalXhrSend=XMLHttpRequest.prototype.send;this._originalXhrOpen=XMLHttpRequest.prototype.open;var i=this;XMLHttpRequest.prototype.open=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this.requestUrl=e[1];return i._originalXhrOpen.apply(this,e)};XMLHttpRequest.prototype.send=function(){for(var e=this,t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];var s=i._requestIdGenerator();r.onRequest({request:this,id:s,type:0});this.addEventListener("readystatechange",function(){4===e.readyState&&r.onResponse({request:e,id:s,type:0})});return i._originalXhrSend.apply(this,t)}}if("fetch"in p&&void 0!==p.fetch){this._originalFetch=p.fetch.bind(p);p.fetch=function(e,r){return new Promise(function(i,s){var o=t._requestIdGenerator();n.onRequest({request:e,id:o,type:1});t._originalFetch(e,r).then(function(e){n.onResponse({response:e,id:o,type:1});i(e)},function(e){s(e)})})}}}};e.prototype.undoInstrument=function(){p.__RUMOneAPITrackerInstrumented=!1;this._originalXhrOpen&&(XMLHttpRequest.prototype.open=this._originalXhrOpen);this._originalXhrSend&&(XMLHttpRequest.prototype.send=this._originalXhrSend);this._originalFetch&&(p.fetch=this._originalFetch)};return e})(),g=n(73),y=n(144),b=n(503);(function(e){e[e.Incomplete=1]="Incomplete";e[e.ReadyToUpload=2]="ReadyToUpload";e[e.Uploaded=3]="Uploaded";e[e.TimeOut=4]="TimeOut";e[e.Skipped=5]="Skipped"})(d||(d={}));(function(e){e[e.own=0]="own";e[e.cors=1]="cors"})(v||(v={}));var w=function(e,t,n,r,i,s,o){this.url=e;this.duration=t;this.correlationId=n;this.status=r;this.startTime=i;this.endTime=s;this.name=o;this.clientDurationInMilliseconds=new Date(s).getTime()-new Date(i).getTime();this.origin=e&&new g.t(e).getHost()},E=["EUPL","ScenarioId"],S=/^[a-zA-Z0-9](([a-zA-Z0-9|_|\.]){0,98}[a-zA-Z0-9])?$/,x=/(?:\/api\/|\/_api\/)(.*?)(?:\(|\?|sharePoint\:|$)/,T=function(e,t,n,r,i,s,o){this.controlId=e;this.startTime=t;this.endTime=n;this.renderTimeCalculator=r;this.renderTimeRequiredDataChecker=i;this.ignoreForEUPL=void 0===s||s;this.needFlatten=void 0!==o&&o};function N(e){return null==e}var C={checkInterval:100,error_timeout:3e4,max_markers:200},k=(function(){function e(e,t,n){void 0===n&&(n=C);this._keyMetrics=E.slice(0);this.async=new s.e(this);this.dataStartTime=Date.now();this._rumoneData={};this.dataState=d.Incomplete;this.controls=[];this.apis=[];this._apiBuffer={};this._loggingFunctions=[];this.euplBreakDown={};this.ttiBreakDown={};this.serverMetrics={};this.isW3cTimingCollected=!1;this._isW3cResourceTimingCollected={};this.tempData={};this._settings={};this._emergencyUpdateFunc=this._emergencyUpload.bind(this);this._name=e;this.registerLoggingFunc(t);this._config=n;this.setPerfDataTimer();this._platformDetection=new f.e;this._hookUnloadEvent();this._apiTracker=new m}e.getRUMOneLogger=function(t,n,r){void 0===t&&(t="__default_rumone__");void 0===r&&(r=C);var i=n||function(e,t){a.logData({streamName:e,dictionary:t})};if(!e.Loggers[t])try{var s=new e(t,i,r);"__default_rumone__"===t&&(e.rumOneLogger=s);e.Loggers[t]=s}catch(e){}return e.Loggers[t]};e.prototype.registerLoggingFunc=function(e){var t=this,n=this._loggingFunctions.indexOf(e);n<0&&this._loggingFunctions.push(e);return function(){n>=0&&t._loggingFunctions.splice(n,1)}};Object.defineProperty(e.prototype,"KeyMetrics",{get:function(){if(this._TTIMeasurementEnabled()){this.addExpectedKeyMetric("TTI");this.addExpectedKeyMetric("FCI")}return this._keyMetrics},enumerable:!0,configurable:!0});e.prototype.getPerformanceData=function(){return this._rumoneData};e.prototype.startAPIMeasurement=function(e){var t=this,n=e&&e.ignore||function(e){return!1},r=e&&e.getAPIName||function(e){},s=function(e){var n=e.id,r=e.request,i=e.type,s=new w;s.startTime=(new Date).toISOString();s.startTimeRelative=t.now();1===i&&(s.url="string"==typeof r?r:r.url);t._apiBuffer[n]=s};this._apiTracker.instrument({fetch:{onRequest:s,onResponse:function(e){var s=e.response,o=e.id,u=t._apiBuffer[o];if(u&&!n(u.url)){var a=void 0,f=void 0;try{a=s.headers.get("SPClientServiceRequestDuration");f=s.headers.get("SPSQLQueryCount")}catch(e){}var l=void 0;try{l=s.headers.get("SPRequestGuid")}catch(e){}u.name=r(u.url);u=Object(i.__assign)(Object(i.__assign)({},u),Object(i.__assign)(Object(i.__assign)(Object(i.__assign)({endTime:(new Date).toISOString(),endTimeRelative:t.now(),clientDurationInMilliseconds:t.now()-u.startTimeRelative,status:s.status},a?{duration:Number(a)}:{}),f?{sqlRT:Number(f)}:{}),l?{correlationId:l}:{}));t.apis.push(u)}}},xhr:{onRequest:s,onResponse:function(e){var s=e.request,o=e.id,u=t._apiBuffer[o],a=s.responseURL||s.requestUrl;if(u&&!n(a)){var f,l;f=s.getResponseHeader("SPClientServiceRequestDuration");l=s.getResponseHeader("SPSQLQueryCount");var c;c=s.getResponseHeader("SPRequestGuid");u.name=r(a);u=Object(i.__assign)(Object(i.__assign)({},u),Object(i.__assign)(Object(i.__assign)(Object(i.__assign)(Object(i.__assign)({endTime:(new Date).toISOString(),endTimeRelative:t.now(),clientDurationInMilliseconds:t.now()-u.startTimeRelative,status:s.status},f?{duration:Number(f)}:{}),l?{sqlRT:Number(l)}:{}),c?{correlationId:c}:{}),{url:a}));t.apis.push(u)}}}});return function(){t._apiTracker.undoInstrument()}};e.prototype.resetLogger=function(){this._emergencyUpload();this._apiBuffer={};this.dataStartTime=(new Date).getTime();this.dataState=d.Incomplete;this.isW3cTimingCollected=!1;this._isW3cResourceTimingCollected={};this.controls=[];this.apis=[];this.tempData={};this._rumoneData={};this._settings={};this._keyMetrics=E.slice(0);this.clearPerfDataTimer();this.setPerfDataTimer();this.euplBreakDown={};this.ttiBreakDown={};this.serverMetrics={};this.clearResourceTimings();Object(l.n)(this._getOwnMakers().map(function(e){return e.name}));e._markers[this._name]=[];this._unhookUnloadEvent();this._hookUnloadEvent();this._ttiPromise=void 0;this._fciPromise=void 0;this.logMessageInConsole("Reset performance Logger Done")};e.prototype.setSettings=function(e){this._settings=Object(i.__assign)(Object(i.__assign)({},this._settings),e)};e.prototype.excludePageForPerfData=function(){this.setSettings({excludePageData:!0})};e.prototype.getPerformanceDataPropertyValue=function(e){return e&&this._rumoneData[e]};e.prototype.setPerformanceDataPropertyValue=function(e,t){if(e&&S.test(e)){this._rumoneData[e]=t;return!0}console.error("key "+e+" does not confrim to the Regex "+S);return!1};e.prototype.addExpectedControl=function(e){var t=this._normalizeControl(e);this.expectingControl(e)?this.controls.filter(function(e){return e.controlId===t.controlId})[0].ignoreForEUPL=t.ignoreForEUPL:this.controls.push(t)};e.prototype.ignoreExpectedControl=function(e){var t=this._normalizeControl(e);this.expectingControl(e)&&(this.controls.filter(function(e){return e.controlId===t.controlId})[0].ignoreForEUPL=!0)};e.prototype.expectingControl=function(e){var t=this._normalizeControl(e);return this.controls.filter(function(e){return e.controlId===t.controlId}).length>0};e.prototype.writeServerCorrelationId=function(e){this._rumoneData.ServerCorrelationId=this._rumoneData.ServerCorrelationId||e};e.prototype.writeServerUrl=function(){this._rumoneData.ServerUrl=this._processEUIIUrl(location.href)};e.prototype.writeServerSideLatency=function(e,t){if(!this.isCollected("ServerRequestDuration")){this._rumoneData.ServerRequestDuration=e;this._rumoneData.IISLatency=t}};e.prototype.writeControlPerformanceData=function(e){if(e){var t=this.controls.filter(function(t){return t.controlId===e.controlId})[0];if(t)t.data||(t.data=e);else{var n={controlId:e.controlId,data:e,ignoreForEUPL:e.ignoreForEUPL};this.controls.push(n)}}};e.prototype.writeAPICallPerformanceData=function(e){e&&this.apis.push(e)};e.prototype.readAPICallPerformanceData=function(){return this.apis};e.prototype.writeAppCache=function(e){this.isCollected("AppCache")||(this._rumoneData.AppCache=e)};e.prototype.writePageTransitionType=function(e,t){this.isCollected("PageTransitionType")&&!t||e!==o.e.fullPageLoad&&e!==o.e.none&&e!==o.e.onePageAppNavigation||(this._rumoneData.PageTransitionType=e)};e.prototype.writeScenarioId=function(e,t){this.isCollected("ScenarioId")&&!t||(this._rumoneData.ScenarioId=e)};e.prototype.collectW3CPerfTimings=function(){if(!this.isW3cTimingCollected){var e=["navigationStart","unloadEventStart","unloadEventEnd","fetchStart","redirectStart","redirectEnd","domainLookupStart","domainLookupEnd","connectStart","secureConnectionStart","connectEnd","requestStart","responseStart","responseEnd","domLoading","domComplete","loadEventStart","loadEventEnd"],t=performance&&performance.timing;if(t){for(var n=0;n<e.length;n++){var r=t[e[n]];r&&this._logRUMOneData(this.getW3cTimingName(e[n]),Number(r))}this.isW3cTimingCollected=!0}}};e.prototype.collectW3cResourceTimings=function(t){void 0===t&&(t=void 0);var n=t||{},r=n.logSummery,s=void 0===r||r,o=n.start,u=void 0===o?0:o,a=n.end,f=void 0===a?Math.round(this.now()):a,l=n.columnNameOverride,c=void 0===l?function(e){return e}:l,h="logSummery="+s+"|start="+u+"|end="+f+"|columnNameOverride="+c,p=this._isW3cResourceTimingCollected[h];if(window.document&&!p&&performance&&performance.getEntriesByType){for(var d=performance.getEntriesByType("resource"),v=document.getElementsByTagName("iframe"),m=0;m<v.length;m++){var g=null;try{g=v[m].contentWindow.performance}catch(e){}g&&g.getEntriesByType&&d.concat(g.getEntriesByType("resource"))}var y={SharePoint:function(e){return 0===e.name.search(window.location.protocol+"//"+window.location.host)}};y.CDN=e._isRequestFromCDN;y.ThirdParty=function(e){return!y.SharePoint(e)&&!y.CDN(e)};var b={ASPX:function(e){return/\.aspx/i.test(e.name)},JS:function(e){return/script/i.test(e.initiatorType)},CSS:function(e){return/link|css/i.test(e.initiatorType)},IMG:function(e){return/img/i.test(e.initiatorType)}};d=d.filter(function(e){return e.startTime>=u&&e.startTime<=f});var w=Object.keys(y);for(m=0;m<w.length;m++){var E=w[m],S=this.categorizeResourceRequests(d,{from:y[E],requestType:null});s&&this._logRUMOneData(c(E+"RequestCountTotal"),S.length);for(var x=Object.keys(b),T=0;T<x.length;T++){var N=x[T];s&&this._logRUMOneData(c(E+"RequestCount"+N),this.categorizeResourceRequests(S,{from:null,requestType:b[N]}).length)}if(S.length>0){s&&this._logRUMOneData(c(E+"RequestDownloadTime"),Math.round(S.reduce(function(e,t){return e+t.duration},0)/S.length));if("CDN"===E){var C=JSON.stringify(S.map(function(e){return Object(i.__assign)(Object(i.__assign)(Object(i.__assign)(Object(i.__assign)({name:e.name.split("/").map(function(e){return e.split("?")[0]}).filter(function(e){return e&&e.length>0}).slice(-1)[0].replace(/\(.*?\)/g,"()"),startTime:Math.round(e.startTime),duration:Math.round(e.duration),transferSize:e.transferSize||0,fetchStart:Math.round(e.fetchStart),requestStart:Math.round(e.requestStart),connect:Math.round(e.connectEnd-e.connectStart),domainLookup:Math.round(e.domainLookupEnd-e.domainLookupStart),redirect:Math.round(e.redirectEnd-e.redirectStart)},L(e,"workerStart")),L(e,"responseStart")),L(e,"responseEnd")),L(e,"secureConnectionStart"))}));this._logRUMOneData(c(E+"RequestNames"),C)}}}this._isW3cResourceTimingCollected[h]=!0}};e.prototype.saveTempData=function(e,t){this.tempData[e]=t};e.prototype.readTempData=function(e){return this.tempData[e]};e.prototype.writeRenderTime=function(e,t){this.isCollected("RenderTime")&&!t||(this._rumoneData.RenderTime=e)};e.prototype.writePreRenderTime=function(e){this.isCollected("PreRender")||(this._rumoneData.PreRender=e)};e.prototype.writePostRenderTime=function(e){this.isCollected("PostRender")||(this._rumoneData.PostRender=e)};e.prototype.writeDataFetchTime=function(e,t){this.isCollected("DataFetch")&&!t||(this._rumoneData.DataFetch=e)};e.prototype.writeAppInfo=function(e,t){this.isCollected("AppInfo")&&!t||(this._rumoneData.AppInfo=e)};e.prototype.isRunning=function(){return!(this.dataState===d.Uploaded||this.dataState===d.TimeOut||this.dataState===d.Skipped)};e.prototype.writeEUPLBreakdown=function(e,t){return this._writeBreakdown(this.euplBreakDown,e,t)};e.prototype.addEUPLBreakdown=function(e,t,n){return this._addBreakdown(this.euplBreakDown,e,t,n)};e.prototype.readEUPLBreakdown=function(e){return this._readBreakdown(this.euplBreakDown,e)};e.prototype.writeTTIBreakdown=function(e,t){return this._writeBreakdown(this.ttiBreakDown,e,t)};e.prototype.addTTIBreakdown=function(e,t,n){return this._addBreakdown(this.ttiBreakDown,e,t,n)};e.prototype.readTTIBreakdown=function(e){return this._readBreakdown(this.ttiBreakDown,e)};e.prototype.addFlights=function(e){if(e&&e.length>0){for(var t=JSON.parse(this.getPerformanceDataPropertyValue("Flights")||"[]"),n=0;n<e.length;n++){var r=e[n];r&&-1===t.indexOf(r)&&t.push(r)}this._rumoneData.Flights=JSON.stringify(t)}};e.prototype.collectSPClientFlights=function(e){for(var t="",n=0,r=e.ExpFeatures;n<r.length;n++){var i=r[n];t+=this._numberToBinString(i).split("").reverse().join("")}this._rumoneData.Flights=t};e.prototype.collectODCClientRamps=function(e,t){for(var n=e.Ramps,r=void 0===n?{}:n,i=[],s=0,o=t;s<o.length;s++){var u=o[s];u.ODC&&"boolean"!=typeof u.ODC&&r[u.ODC]&&i.push(u.ODC)}this._rumoneData.Flights=JSON.stringify(i)};e.prototype.addServerMetrics=function(e,t){if(e)for(var n in e)n&&!N(e[n])&&(N(this.serverMetrics[n])||t)&&(this.serverMetrics[n]=e[n])};e.prototype.writeServerVersion=function(e){this._rumoneData.SharePointServerVersion=e};e.prototype.readControlPerformanceData=function(){return this.controls.filter(function(e){return!!e.data}).map(function(e){return e.data})};e.prototype.mark=function(t){(e._markers[this._name]=e._markers[this._name]||[]).push(t);Object(l.s)(t)};e.prototype.now=function(){return performance&&performance.now?Math.round(performance.now()):NaN};e.prototype.registerEUPLComputedHandler=function(e){this._EUPLComputedHandler=e};e.prototype.registerErrorHandler=function(e){};e.prototype.getMarkerTime=function(e){return Object(l.i)(e)};e.prototype.addExpectedKeyMetric=function(e){this._keyMetrics&&-1===this._keyMetrics.indexOf(e)&&this._keyMetrics.push(e)};Object.defineProperty(e.prototype,"waitOnAddingExpectedControl",{set:function(e){this.setSettings({waitOnAddingExpectedControl:e})},enumerable:!0,configurable:!0});e._isRequestFromCDN=function(e){var t=window._spPageContextInfo,n=e.name;return!(!t||!t.cdnPrefix||0!==n.search(window.location.protocol+"//"+t.cdnPrefix))||(!(!t||!t.cdnBaseUrl||0!==n.search(t.cdnBaseUrl))||/(cdn(ppe)?|static(ppe)?)\.sharepointonline\.com|\.akamaihd\.net|akamai\.odsp\.cdn\.office\.net/i.test(n))};e.prototype._measureTTI=function(){var e=this;this._rumoneData.TTISupported=Object(h.e)();if(this._TTIPolyfillEnabled()&&!this._ttiPromise){if(b.n.isFeatureEnabled({ODB:60492})&&"complete"!==document.readyState){window.addEventListener("load",function(){e.addTTIBreakdown("MeasureTTI.WindowLoad",performance.now())});this.addTTIBreakdown("MeasureTTI.DocStateNotComplete",performance.now())}this._ttiPromise=Object(h.n)(this._settings.TTISettings.TTIPolyfillSettings.options);this._ttiPromise.then(function(t){var n=t||{},r=n.tti,i=n.longTasks,s=n.options,o=r;if(N(r))r=NaN;else{var u=e._settings.TTISettings.TTIPolyfillSettings.calculateTTI;u&&(r=u(Math.round(r),e._rumoneData,"TTI"))}N(e._rumoneData.TTI)?e.addEUPLBreakdown("currentTTI",{data:JSON.stringify(r),needFlatten:!1}):e.addEUPLBreakdown("prevTTI",{data:JSON.stringify(e._rumoneData.TTI),needFlatten:!1});e._rumoneData.TTI=r;if(i){e._rumoneData.TTILongTasks=JSON.stringify(i);c.t.isActivated("4c338685-350e-4aae-a03e-fb969ab4dc98","02/24/2021")||(e._rumoneData.TTILongTasksPostFMPCount=i.filter(function(t){return t.end>e._rumoneData.EUPL}).length)}e._logLastRequestBeforeTTI(r,i,"TTI");e.collectW3cResourceTimings({logSummery:!1,start:o-(r-e._rumoneData.EUPL),end:o,columnNameOverride:function(e){return e+"OfTTI"}});s&&e.addEUPLBreakdown("TTIOptions",{data:JSON.stringify(s),needFlatten:!1})})}if(this._TTIPolyfillEnabled()&&!this._fciPromise){var t=this._settings.TTISettings.TTIPolyfillSettings.getAbsoluteEUPL,n=t?t(this._rumoneData.EUPL):this.now();this._fciPromise=Object(h.t)(n);this._fciPromise.then(function(t){var n=t||{},r=n.fci,i=n.longTasks;if(N(r))r=NaN;else{var s=e._settings.TTISettings.TTIPolyfillSettings.calculateTTI;s&&(r=s(Math.round(r),e._rumoneData,"FCI"))}e._rumoneData.FCI=r;if(i){e._rumoneData.FCILongTasks=JSON.stringify(i);c.t.isActivated("4c338685-350e-4aae-a03e-fb969ab4dc98","02/24/2021")||(e._rumoneData.FCILongTasksPostFMPCount=i.filter(function(t){return t.end>e._rumoneData.EUPL}).length)}e._logLastRequestBeforeTTI(r,i,"FCI")})}};e.prototype._logLastRequestBeforeTTI=function(t,n,r){var i=performance.getEntriesByType("resource");if(t&&n&&n.length>0&&i&&i.length>0){for(var s=n[n.length-1].start,o=i[0],u=0,a=i;u<a.length;u++){var f=a[u];f.responseEnd<s&&f.responseEnd>o.responseEnd&&(o=f)}var l=void 0;l=e._isRequestFromCDN(o)?o.name:this._processLastNetworkUrl(o.name);var c=void 0;c=/\.aspx/i.test(o.name)?"ASPX":/\.js/i.test(o.name)?"JS":/\.css/i.test(o.name)?"CSS":/img/i.test(o.initiatorType)||/\.jpg|\.jpeg|\.png|\.gif/i.test(o.name)?"IMG":/aria\.microsoft\.com/i.test(o.name)?"Aria":/_api/i.test(o.name)?"API":"Other";if("TTI"===r){this._rumoneData.TTILastRequestName=l;this._rumoneData.TTILastRequestType=c;this._rumoneData.TTILastRequestStartTime=o.startTime;this._rumoneData.TTILastRequestEndTime=o.responseEnd}else{this._rumoneData.FCILastRequestName=l;this._rumoneData.FCILastRequestType=c;this._rumoneData.FCILastRequestStartTime=o.startTime;this._rumoneData.FCILastRequestEndTime=o.responseEnd}}};e.prototype._numberToBinString=function(e){var t=(e>>>0).toString(2);return""+Array(32-t.length+1).join("0")+t};e.prototype._logRUMOneData=function(e,t){e&&(this._rumoneData[e]=t)};e.prototype.clearResourceTimings=function(){performance&&performance.clearResourceTimings&&performance.clearResourceTimings()};e.prototype._isBreakdownValue=function(e){return void 0!==e.needFlatten};e.prototype.collectMarks=function(){var e=this,t={},n=0;this._getOwnMakers().forEach(function(r){if(n<e._config.max_markers){var i=r.name.substr(l.t.length)+".mark"+n++;t[i]=Math.round(r.startTime)}});this.writeEUPLBreakdown(JSON.stringify(t))};e.prototype._getOwnMakers=function(){var t=this,n=e._markers,r=[].concat.apply([],Object.keys(n).filter(function(e){return n.hasOwnProperty(e)&&e!==t._name}).map(function(e){return n[e]}));return Object(l.r)().filter(function(e){return-1===r.indexOf(e.name)})};e.prototype.logMessageInConsole=function(e){this.isRUMOneDebuggingEnabled&&console.log(e)};Object.defineProperty(e.prototype,"isRUMOneDebuggingEnabled",{get:function(){try{if("sessionStorage"in window&&window.sessionStorage){var e=window.sessionStorage.enableRUMOneDebugging;return e&&"true"===e.toLowerCase()&&"undefined"!=typeof console&&!!console}}catch(e){}return!1},enumerable:!0,configurable:!0});e.prototype.logObjectForDebugging=function(e,t){if(this.isRUMOneDebuggingEnabled){var n=this._name+" "+e+" : "+JSON.stringify(t);console.log(n)}};e.prototype.isCollected=function(e){return!N(this.getPerformanceDataPropertyValue(e))};e.prototype._normalizeControl=function(e){return"string"==typeof e?{controlId:e,ignoreForEUPL:!1}:e};e.prototype.setPerfDataTimer=function(){this.perfDataTimer=this.async.setTimeout(this.loopForDataCompleteness,this._config.checkInterval)};e.prototype.clearPerfDataTimer=function(){if(!N(this.perfDataTimer)){this.async.clearTimeout(this.perfDataTimer);this.perfDataTimer=null}};e.prototype._hookUnloadEvent=function(){window.addEventListener&&window.addEventListener("beforeunload",this._emergencyUpdateFunc)};e.prototype._unhookUnloadEvent=function(){window.removeEventListener&&window.removeEventListener("beforeunload",this._emergencyUpdateFunc)};e.prototype.categorizeResourceRequests=function(e,t){for(var n=[],r=0;r<e.length;r++){var i=e[r];t.from&&!t.from(i)||t.requestType&&!t.requestType(i)||n.push(i)}return n};e.prototype._setFCP=function(){var e=NaN,t=performance&&performance.getEntriesByType&&performance.getEntriesByType("paint");if(t&&t.length>0){var n=t.filter(function(e){return"first-contentful-paint"===e.name});if(n&&1===n.length)e=n[0].startTime;else{var r=t.filter(function(e){return"first-paint"===e.name});r&&1===r.length&&(e=r[0].startTime)}}isNaN(e)||(this._rumoneData.FCP=Math.round(e))};e.prototype.collectSupplementaryData=function(){this._setFCP();this.setAPIDataToRUMOne();this.collectMarks();this.writeServerUrl();this.setBrowseInfo();this.setReferrer();this._collectMemoryData();this._collectPageServerData();this._setAppInfo();this._setTestName();this._collectExperiments();this._rumoneData.DOMElements=document&&document.querySelectorAll("*").length;this._rumoneData.ServerMetrics=JSON.stringify(this.serverMetrics);this._rumoneData.EUPLBreakdown=JSON.stringify(this.euplBreakDown);this._rumoneData.TTIBreakdown=JSON.stringify(this.ttiBreakDown)};e.prototype._collectExperiments=function(){var e=window.ODSP_EXPERIMENTS||{},t={};for(var n in e)if(e.hasOwnProperty(n)){var r=e[n];r&&r._serverTime&&Date.now()-new Date(r._serverTime).getTime()<1296e6&&(t[n]=e[n])}this._rumoneData.SPExperiments=JSON.stringify(t)};e.prototype._setTestName=function(){var e=new g.t(location.href).getQueryParameter("perftest");e&&!this._rumoneData.TestName&&(this._rumoneData.TestName=e)};e.prototype.loopForDataCompleteness=function(){this.clearPerfDataTimer();if(!this._settings.waitOnAddingExpectedControl){if(this.isRUMOneDebuggingEnabled){this.logMessageInConsole("====================================================================");this.logObjectForDebugging("RUMONE: ",this._rumoneData);this.logObjectForDebugging("RUMOne DataState: ",String(this.getReadableDataState(this.dataState)));this.logObjectForDebugging("Controls: ",this.controls);this.logObjectForDebugging("API Performance Data: ",this.apis);this.logObjectForDebugging("Temp Data: ",this.tempData);this.logObjectForDebugging("EUPLBreakdown: ",this.euplBreakDown);this.logObjectForDebugging("TTIBreakdown: ",this.ttiBreakDown);this.logObjectForDebugging("ServerMetrics: ",this.serverMetrics);this.logMessageInConsole("====================================================================\n\n")}if(!this.isRunning())return;this._updateState()}this._checkTimeout();this.isRunning()&&this.setPerfDataTimer()};e.prototype._updateState=function(){switch(this.dataState){case d.Incomplete:this.processControlRenderTime();this.readyToComputeEUPL()&&this.setEUPL();var e=this._getMissedControls();this._TTIMeasurementEnabled()&&this.isCollected("EUPL")&&0===e.length&&this._measureTTI();0===this._getMissedKeyMetrics().length&&0===e.length&&(this.dataState=d.ReadyToUpload);break;case d.ReadyToUpload:this._uploadPerfData({emergency:!1})}};e.prototype._checkTimeout=function(){if(this.isRunning()&&this.dataState!==d.ReadyToUpload){var e=Date.now();if(!(this.dataState===d.Incomplete&&e-this.dataStartTime<=this._config.error_timeout)){var t={reason:"TimeOut",details:{MissingMetrics:this._getMissedKeyMetrics(),MissingControls:this._getMissedControls()}};this._rumoneData.RUMOneError=JSON.stringify(t);this.dataState=d.TimeOut;this._uploadPerfData({emergency:!1})}}};e.prototype._getMissedKeyMetrics=function(){for(var e=[],t=0;t<this.KeyMetrics.length;t++){N(this.getPerformanceDataPropertyValue(this.KeyMetrics[t]))&&e.push(this.KeyMetrics[t])}return e};e.prototype._getMissedControls=function(){return this.controls.filter(function(e){return!e.data||!e.data.renderTime})};e.prototype._emergencyUpload=function(){this.isRunning()&&this._uploadPerfData({emergency:!0})};e.prototype._uploadPerfData=function(e){this.writeControlDataToRUMOne();this.collectSupplementaryData();var t,n=e.emergency;this._rumoneData.EmergencyUploaded=!!n;try{if(this._settings.excludePageData){this.dataState=d.Skipped;this.logMessageInConsole("Uploading perf data skipped as requested by the consumer")}else if(n||this.dataState===d.ReadyToUpload||this.dataState===d.TimeOut)if(this._loggingFunctions&&this._loggingFunctions.length>0)if(this._rumoneData){var r=this.getPerformanceData();this._loggingFunctions.forEach(function(e){e("RUMOne",r)});this.dataState=d.Uploaded;if(this.isRUMOneDebuggingEnabled){this.logMessageInConsole("Final Data uploaded");this.logObjectForDebugging("RUMONE: ",r);this.logObjectForDebugging("RUMOne DataState: ",this.getReadableDataState(this.dataState))}}else console.error("Error: Uploading perf data called but perf data is not available");else console.error("Uploading perf data skipped as loggingFunc is not defined");else console.error("Error: Uploading perf data called with wrong data state "+this.dataState)}catch(e){t="PerformanceLogger error writing RUMOne data: "+e,"undefined"!=typeof console&&Boolean(console)&&console.error(t)}finally{if(!this.isRunning()){this._unhookUnloadEvent();this._apiTracker.undoInstrument()}}};e.prototype._TTIPolyfillEnabled=function(){return!!(this._settings.TTISettings&&this._settings.TTISettings.TTIPolyfillSettings&&this._settings.TTISettings.TTIPolyfillSettings.enabled)};e.prototype._TTIMeasurementEnabled=function(){return this._TTIPolyfillEnabled()};e.prototype.getReadableDataState=function(e){for(var t in d)if(e===Number(d[t]))return t;return"NaN"};e.prototype.writeControlDataToRUMOne=function(){if(this.controls&&this.controls.length){var e=this.controls.slice(0).filter(function(e){return!!e.data&&!!e.data.renderTime&&!e.ignoreForEUPL});e.sort(function(e,t){return t.data.renderTime-e.data.renderTime});for(var t=0;t<10&&t<e.length;t++){this._logRUMOneData("Control"+(t+1)+"Id",e[t].controlId);this._logRUMOneData("Control"+(t+1)+"RenderTime",e[t].data.renderTime)}var n={};this.controls.slice(0).filter(function(e){return!!e.data&&!!e.data.renderTime&&!!e.ignoreForEUPL}).forEach(function(e){n[e.controlId]={data:e.data.renderTime,needFlatten:e.data.needFlatten}});Object.keys(n).length>0&&this.writeEUPLBreakdown(JSON.stringify(n),!0)}};e.prototype.processControlRenderTime=function(){for(var e=0,t=this.controls;e<t.length;e++){var n=t[e];n.data&&!n.data.renderTime&&n.data.renderTimeRequiredDataChecker(this,n.data)&&(n.data.renderTime=n.data.renderTimeCalculator(this,n.data))}};e.prototype.readyToComputeEUPL=function(){for(var e=this.controls.filter(function(e){return!e.ignoreForEUPL}),t=e.length>0,n=0,r=e;n<r.length;n++){var i=r[n];if(!i.data||!i.data.renderTime){t=!1;break}}return t};e.prototype.setEUPL=function(){if(!this.isCollected("EUPL")){for(var e=0,t=0,n=this.controls;t<n.length;t++){var r=n[t];!r.ignoreForEUPL&&r.data&&r.data.renderTime&&e<r.data.renderTime&&(e=r.data.renderTime)}this._rumoneData.EUPL=e;"function"==typeof this._EUPLComputedHandler&&this._EUPLComputedHandler(e)}};e.prototype.setBrowseInfo=function(){this._rumoneData.Browser=this._platformDetection.browserName+this._platformDetection.browserMajor;this._rumoneData.BrowserIsMobile=this._platformDetection.isMobile};e.prototype._collectMemoryData=function(){if(!this.isCollected("UsedJSHeapSize")&&"undefined"!=typeof performance&&void 0!==performance.memory){this._rumoneData.UsedJSHeapSize=performance.memory.usedJSHeapSize;this._rumoneData.TotalJSHeapSize=performance.memory.totalJSHeapSize}};e.prototype._collectPageServerData=function(){this.addServerMetrics({cpuDuration:window.g_cpuDuration,duration:window.g_duration,iisLatency:window.g_iisLatency,queryCount:window.g_queryCount,queryDuration:window.g_queryDuration,spPageContextDuration:window.g_pageContextDuration,deferred_cpuDuration:window.g_deferred_cpuDuration,deferred_duration:window.g_deferred_duration,deferred_iisLatency:window.g_deferred_iisLatency,deferred_queryCount:window.g_deferred_queryCount,deferred_queryDuration:window.g_deferred_queryDuration})};e.prototype.setAPIDataToRUMOne=function(){for(var e=0,t=0,n=[],r=0;r<this.apis.length;r++){var s=this.apis[r];if(s){e++;t+=s.duration;s.origin||(s.origin=new g.t(s.url).getHost());s.hostType=new g.t(window.location.href).getHost()===s.origin?v.own:v.cors;s.url;var o=Object(i.__rest)(s,["url"]);n.push(o)}}this._rumoneData.APICallCount=e;this._rumoneData.APICallDurationSum=t;this._rumoneData.APICalls=JSON.stringify(n)};e.prototype.setReferrer=function(){this._rumoneData.Referrer=this._processEUIIUrl(document.referrer)};e.prototype._setAppInfo=function(){if(!this._rumoneData.AppInfo){var e=window._spModuleLink;if(e){var t=e.buildNumber,n=e.manifestName,r=e.scenarioName,i=JSON.stringify({buildNumber:t,manifestName:n,scenarioName:r});this._rumoneData.AppInfo=i}}};e.prototype.getW3cTimingName=function(e){return"secureConnectionStart"!==e?"W3c"+e.charAt(0).toUpperCase()+e.slice(1):"W3cSecureConnectStart"};e.prototype._writeBreakdown=function(e,t,n){if(t)try{var r=JSON.parse(t);for(var i in r)r.hasOwnProperty(i)&&this._addBreakdown(e,i,r[i],n)}catch(e){this.logMessageInConsole("Failed to write EUPL breakdown data:"+e.toString())}};e.prototype._addBreakdown=function(e,t,n,r){if(t&&!N(n)){if(N(e[t])||r){var i=this._isBreakdownValue(n)?n.data:n;e[t]=i}this._isBreakdownValue(n)&&n.needFlatten&&(!this.isCollected(t)||r)&&this._logRUMOneData(t,n.data)}};e.prototype._readBreakdown=function(e,t){return t?e[t]:e};e.prototype._processEUIIUrl=function(e){var t=new y.e(e||"");return t.authority+"/{ length: "+t.path.length+", segments: "+t.segments.length+" }"};e.prototype._processLastNetworkUrl=function(e){var t=new y.e(e||"");if(t.authority.indexOf("lpcres")>0)return e;if(t.authority.indexOf("shell.cdn.office")>0)return e;var n=x.exec(e),r="";n&&n.length>0&&(r=""+n[0]);return""+t.authority+r};e.rumOneLogger=void 0;e.Loggers={};e._markers={};return e})();t.n=k;function L(e,t){var n;return t in e?((n={})[t]=Math.round(e[t]),n):{}}},724:function(e,t,n){"use strict";n.d(t,"e",function(){return S});var r=n(0),i=n(25),s=n(805),o=n(147),u=n(331),a=n(34),f=n(716),l=n(100),c=n(237),h=n(187),p=n(785),d=n(737),v=n(740),m=n(804);function g(e){var t=e.options,n=t.url,s=t.authToken,o=t.telemetryHandler,u=t.useExactAuthToken,f=e.dataSyncClient,l=e.aadUserId,c=e.getData,h=function(){return c({url:n,telemetryHandler:o,authToken:s,useExactAuthToken:u})};if(!l)return h();var p=function(e){var t=(function(e,t){return function(n,i){var s=n.eventData,o=s.extraData,u={performanceEntry:o&&o.performanceEntry,httpStatus:o&&o.HttpStatus,correlationId:o&&o.CorrelationId,succeeded:s&&s.resultType===a.e.Success||!1,resultCode:s&&s.resultCode,endpoint:i},f=t&&t(n),l=e.onRequestComplete(u);o.dataSyncQos=e.getQosInfo();return Object(r.__assign)(Object(r.__assign)({},f||{}),{eventData:Object(r.__assign)(Object(r.__assign)({},f?f.eventData:s),{extraData:Object(r.__assign)(Object(r.__assign)({},f?f.eventData.extraData:s.extraData),e.getQosInfo())}),canRetry:l&&(!f||f.canRetry)})}})(e,o);return e.getData({url:n},function(e){return c({url:e.url,authToken:e.authToken,telemetryHandler:function(n){return t(n,e)},useExactAuthToken:!0})},h)};return i.n.resolve(f).then(function(e){return e?p(e):h()})}var y=n(251),b=n(263),w="undefined"!=typeof window?window:void 0,E=w&&w.performance;var S=(function(){function e(e,t){this._pageContext=t?t.pageContext:e.pageContext;this._tokenProvider=t&&t.tokenProvider;this._dataSyncClient=t&&t.dataSyncClient||this._pageContext&&this._pageContext.dataSyncClient;this._qosName=e.qosName;this._apiEvent=t&&t.apiEvent||o.t;this._engagement=t&&t.engagement||u.e;this._normalizeErrors=!!e.normalizeErrors;this._getDataWithTokenProvider=t&&t.getDataWithTokenProvider;this._getDataWithSyncClient=t&&t.getDataWithSyncClient||this._dataSyncClient?g:void 0}e.parseJSON=function(e){return e&&JSON.parse(e)||void 0};e.prototype.getData=function(t){var n,o=this,u=t.parseResponse,g=void 0===u?e.parseJSON:u,S=t.qosExtraData,x=t.additionalPostData,T=void 0===x?"":x,N=t.contentType,C=t.method,k=void 0===C?"POST":C,L=t.maxRetries,A=void 0===L?0:L,O=t.responseType,M=t.onUploadProgress,_=t.timeout,D=t.noTimeoutInLastRetry,P=void 0!==D&&D,H=this._pageContext,B=this._tokenProvider,j=this._getDataWithTokenProvider,F=this._getDataWithSyncClient,I=[];this._qosName&&I.push(this._qosName);t.qosName&&I.push(t.qosName);var q=I.join("."),R=function(e){var n=e.url,u=e.telemetryHandler,x=e.authToken,C=e.useExactAuthToken,L=void 0!==C&&C,D=!0,F=new c.e(n),I=F.authority+"/{ length: "+F.path.length+", segments: "+F.segments.length+" }",R=function(e){var x=e.authToken,C=e.qosExtraData,B=t.crossSiteCollectionCall,j=void 0!==B&&B,F=t.noRedirect,R=void 0!==F&&F,U=t.needsRequestDigest,z=void 0===U||U,W=Object(r.__assign)(Object(r.__assign)({},t.additionalHeaders),{CollectSPPerfMetrics:v.e});if(x){var X=!1;b.t.isActivated("589c6b39-fbce-42b5-bff1-125e13e2367a","06/09/2021","check if auth token has auth header already, if yes, use exact auth token")||y.e.isFeatureEnabled({ECS:86137})||x.split(" ").length>1&&(X=!0);var V=L||X?x:"Bearer "+x,$=!1;for(var J in W)J&&"authorization"===J.toLowerCase()&&($=!0);$||(W.Authorization=V);j=!0;z=!1;R=!0}var K,Q,G=new m.e(Object(r.__assign)(Object(r.__assign)({},H?{webServerRelativeUrl:H.webServerRelativeUrl,webAbsoluteUrl:j?H.webAbsoluteUrl:void 0,formDigest:{serverTime:H.serverTime,updateFormDigestPageLoaded:H.updateFormDigestPageLoaded,formDigestValue:H.formDigestValue,formDigestTimeoutSeconds:H.formDigestTimeoutSeconds}}:{}),{needsRequestDigest:z,engagement:o._engagement,operationName:o._qosName})),Y=w&&w.location&&new c.e(w.location.href).authority,Z=new c.e(n).authority,ee=f.t.getRUMOneLogger(),te=Date.now();ee&&(Boolean(ee.readTempData("appDataFetchStart"))||ee.saveTempData("appDataFetchStart",te));return(function(e){var t,n=e.onExecute,r=e.onCancel,o=e.timeout,u=e.canRetry,a=e.noTimeoutInLastRetry,f=0,l=Math.max(e.maxRetries,0),c=function(){var e=new i.n(n,function(){r(f>=l||!u())});return o&&(!a||f<l)?i.n.timeout(o,e):e};t=f<l?Object(s.e)({canRetry:u,retries:l,callback:c,beforeRetry:function(){f++}}):c();return t})({timeout:_,onExecute:function(e,t){var i=function(i,s){return function(f){var l=f.getResponseText();Q=f.getServiceWorkerDataSourceHeader();var c,d,v,m,y=Object(h.e)(n,s),b=Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({},S||{}),{needsRequestDigest:z,hasAuthToken:!!x,isCrossOrigin:!!Y&&Y!==Z,CorrelationId:f.getCorrelationId()}),C||{}),{HttpStatus:f.getStatus(),serviceWorkerDataSource:Q||void 0,rawRequestDuration:y.duration,performanceEntry:JSON.stringify(y),serviceWorkerFetchInfo:f.getServiceWorkerFetchInfoFromHeader()||void 0,SQLRT:f.getSQLRT(),ServerDuration:f.getServerDuration()}),w=!1;try{!(function(e,t){return"blob"===e&&t&&"object"==typeof t})(O,l)?d=g(l,f):v=l;w=!0}catch(e){c=e;m={resultType:a.e.Failure,resultCode:"InvalidJSON",error:"object"==typeof e?JSON.stringify(e):e,extraData:b}}m||(m={resultType:a.e.Success,extraData:b});if(u){m=u({response:d,eventData:m}).eventData}i.end(m);if(w)try{e(v||d)}catch(e){}else t(o._normalizeErrors?new p.e({code:"-1,parse_response",innerError:c,errorData:{status:f.getStatus()}}):void 0);G=void 0}},s=function(e,i){return function(s,f){var c=Object(h.e)(n,i),v=Object(r.__assign)(Object(r.__assign)({},S||{}),{needsRequestDigest:z,hasAuthToken:!!x,isCrossOrigin:!!Y&&Y!==Z,rawRequestDuration:c.duration,performanceEntry:JSON.stringify(c)}),m="undefined"!=typeof navigator&&!1===navigator.onLine;if(s){var g=s.getCorrelationId(),y=s.getGroupThrottle(),b=s.getMSCorrelationVector(),w=s.getStatus(),E=s.getAuthErrorType(),T=s.getFBAError();v=Object(r.__assign)(Object(r.__assign)({},v),{CorrelationId:g,HttpStatus:w,GroupThrottle:y,MSCorrelationVector:b,AuthErrorType:E});var N=a.e.Failure;if(401===w&&T||403===w||404===w||429===w||503===w||-1===w||0===w&&m){D=!1;N=a.e.ExpectedFailure}var C=function(n){var i,f=void 0;if("object"==typeof n&&"number"==typeof n.status)f=n;else if("string"==typeof n){var c=void 0;try{c=JSON.parse(n)}catch(e){}i=(function(e){var t=e.authDiagnostics,n=e.fbaHeaderError;if(t)try{var r=/(\d+)(?:;reason="([^"]+?)")?(?:;category="([^"]+?)")?/.exec(t),i=r[1],s=void 0===i?"-1":i,o=r[2],u=void 0===o?"":o,a=r[3],f=void 0===a?"unknown":a,c=void 0;switch(Number(s)){case 3e6:case 3000003:case 3000006:case 3001003:case 3001004:case 3001005:case 3002e3:case 3004009:case 3004010:case 3003e3:c=!0;break;default:c=!1}return new l.e({code:s+","+f,message:u,isExpected:c})}catch(e){return new l.e({code:"-1,Unknown",innerError:e})}if(n)try{var h=/(\d+);\s+(.+)/.exec(n),p=h[1],d=(s=void 0===p?"-1":p,h[2]);u=void 0===d?"":d;return new l.e({code:""+s,message:u,isExpected:!0})}catch(e){return new l.e({code:"-1,Unknown",innerError:e})}})({authDiagnostics:E,fbaHeaderError:T});c&&(f=c.error_description?{code:"-1,"+(c.error||"Unknown"),message:c.error_description}:"string"==typeof c.error?{message:c.error}:c.error||c["odata.error"]||{responseData:c})}(f=f||{}).status=w;f.retryAfter=s.getRetryAfterHeader();var h=f["@error.redirectUrl"],m=s.getRedirectUrl()||h;m&&(N=a.e.ExpectedFailure);f.redirectUrl=m;f.authenticate=s.getAuthenticateHeader();g&&(f.correlationId=g);y&&(f.groupThrottle=y);"-1,policy_enforced"===f.code&&(N=a.e.ExpectedFailure);i&&i.isExpected&&(N=a.e.ExpectedFailure);f.code=i&&i.code||f.code||d.s;var b="["+w.toString()+"] "+f.code,S=JSON.stringify(f),x={resultType:N,error:S,resultCode:b,extraData:v};if(u){var C=u({eventData:x,errorData:f}),k=C.eventData,L=C.canRetry;x=k;!0!==L&&!1!==L||(D=L)}e.end(x);t(o._normalizeErrors?new p.e(Object(r.__assign)({errorData:f,innerError:i},x.resultType===a.e.ExpectedFailure?{isExpected:!0}:{})):f)},k=s.getResponseType();if(k&&"text"!==k)s.parseError().then(C);else{C(s.getResponseText())}}else{var L=d.s,A=!0,O=0;if(f&&f instanceof l.e){L=f.code;A=f.isExpected;O=-1}!m||L!==d.n&&L!==d.s||(L=d.r);var M={status:O,code:L},_={resultType:A?a.e.ExpectedFailure:a.e.Failure,resultCode:L,extraData:v};t(o._normalizeErrors?new p.e({errorData:M,innerError:f}):M);if(u){_=u({eventData:_,errorData:M}).eventData}e.end(_)}}};(function(){var e=K=new o._apiEvent({url:I,name:q}),t=E&&E.now();G.getServerDataFromUrl({url:n,successCallback:i(e,t),failureCallback:s(e,t),uploadProgressCallback:M,additionalPostData:T,method:k,additionalHeaders:W,contentType:N,withCredentials:!x&&void 0,noRedirect:R,responseType:O,needsRequestDigest:z})})()},maxRetries:A,noTimeoutInLastRetry:P,canRetry:function(){return D},onCancel:function(e){if(G){G.abort();e&&G.dispose()}}}).then(function(e){G&&G.dispose();return e},function(e){G&&G.dispose();!K.endTime&&i.n.isCanceled(e)&&K.end({resultCode:d.e,resultType:a.e.ExpectedFailure});return i.n.reject(e)})};if(x)return i.n.resolve(x).then(function(e){return R({url:n,authToken:e})});if(B&&B.getAuthToken)return j?j({apiEvent:o._apiEvent,getData:R,options:{url:n,authToken:t.authToken,qosExtraData:t.qosExtraData},webAbsoluteUrl:H&&H.webAbsoluteUrl,qosName:q,tokenProvider:B}):i.n.resolve(B.getAuthToken({url:n,webAbsoluteUrl:H&&H.webAbsoluteUrl})).then(function(e){return R(Object(r.__assign)({url:n},e?"string"==typeof e?{authToken:e}:{authToken:e.authToken,qosExtraData:{AuthCorrelationId:e.correlationId,AuthExpiration:e.expiresOn}}:{}))});if(H){if(H.getAuthToken)return i.n.resolve(H.getAuthToken()).then(function(e){return R({url:n,authToken:e})});if(H.authToken)return i.n.resolve(H.authToken).then(function(e){return R({url:n,authToken:e})})}return R({url:n})},U={authToken:t.authToken,telemetryHandler:t.telemetryHandler,url:t.url,useExactAuthToken:t.useExactAuthToken};return F?F({options:U,aadUserId:null===(n=H)||void 0===n?void 0:n.aadUserId,dataSyncClient:this._dataSyncClient,getData:R}):R(U)};return e})();t.t=S},737:function(e,t,n){"use strict";n.d(t,"s",function(){return r});n.d(t,"i",function(){return i});n.d(t,"e",function(){return s});n.d(t,"n",function(){return o});n.d(t,"r",function(){return u});n.d(t,"t",function(){return a});var r="Unknown",i="RequestAborted",s="Canceled",o="NoConnection",u="Offline",a="MissingWebForDigestAuth"},739:function(e,t,n){"use strict";var r;(function(e){e[e.none=0]="none";e[e.fullPageLoad=4]="fullPageLoad";e[e.onePageAppNavigation=5]="onePageAppNavigation"})(r||(r={}));t.e=r},740:function(e,t,n){"use strict";n.d(t,"e",function(){return u});var r=n(115),i=n(73),s=n(181),o=n(263),u="SPSQLQueryCount";var a=(function(){function e(e,t,n){this._request=e;this._url=t;this._webAbsoluteUrl=n&&n.webAbsoluteUrl;this._isCanaryRequest=n&&n.isCanaryRequest}e.prototype.getSourceUrl=function(){return this._url};e.prototype.getAllResponseHeaders=function(){return this._request.getAllResponseHeaders()};e.prototype.getCorrelationId=function(){return this.getResponseHeader("SPRequestGuid")};e.prototype.getServerDuration=function(){return this._getNumberHeader("SPClientServiceRequestDuration")};e.prototype.getSQLRT=function(){return this._getNumberHeader(u)};e.prototype.getGroupThrottle=function(){return this.getResponseHeader("SPGroupThrottle")};e.prototype.getAuthErrorType=function(){return this.getResponseHeader("x-ms-diagnostics")};e.prototype.getMSCorrelationVector=function(){return this.getResponseHeader("MS-CV")};e.prototype.getServiceWorkerDataSourceHeader=function(){return this.getResponseHeader("X-SERVICEWORKER-DATA-SOURCE")};e.prototype.getServiceWorkerFetchInfoFromHeader=function(){return this.getResponseHeader("X-ServiceWorkerFetchInfo")};e.prototype.getRetryAfterHeader=function(){return this._getNumberHeader("Retry-After")};e.prototype.getStatus=function(){try{return this._request.status}catch(e){}};e.prototype.getAuthenticationRedirect=function(){return this.getResponseHeader("X-Forms_Based_Auth_Required")};e.prototype.getFBAError=function(){return this.getResponseHeader("X-MSDAVEXT_Error")};e.prototype.getAuthenticateHeader=function(){return this.getResponseHeader("WWW-Authenticate")};e.prototype.getResponseType=function(){return this._request.responseType};e.prototype.getResponseText=function(){return this._request.responseType&&"text"!==this._request.responseType?this._request.response:this._request.responseText};e.prototype.getErrorResponseText=function(){if("blob"===this._request.responseType){return{status:this._request.status,statusText:this._request.statusText,infected:!!this.getResponseHeader("x-virus-infected"),authenticate:this.getResponseHeader("WWW-Authenticate")}}return this.getResponseText()};e.prototype.parseError=function(){var e=this,t=new r.e;this._request.responseType&&"text"!==this._request.responseType?"blob"===this._request.responseType?(function(e){var t,n=new r.e,i=function(){if(t.result){var e=void 0;try{e=JSON.parse(t.result);n.complete(e)}catch(e){n.complete({message:"Unable to parse blob result."})}}},s=function(){n.complete({message:"Unable to read blob error response."})};try{(t=new FileReader).addEventListener("load",i);t.addEventListener("error",s);t.readAsText(e)}catch(e){s()}return n.getPromise().then(function(e){if(t){t.removeEventListener("load",i);t.removeEventListener("error",s)}return e})})(this._request.response).then(function(n){var r={data:n,status:e.getStatus(),statusText:e._request.statusText,infected:!!e.getResponseHeader("x-virus-infected"),authenticate:e.getResponseHeader("WWW-Authenticate")};t.complete(r)}):t.complete(this._request.response):t.complete(this._request.responseText);return t.getPromise()};e.prototype.getValue=function(t){var n;switch(t){case e.DataValueKeys.SourceURL:n=this.getSourceUrl();break;case e.DataValueKeys.CorrelationId:n=this.getCorrelationId();break;case e.DataValueKeys.Status:n=this.getStatus();break;case e.DataValueKeys.AuthenticationRedirect:n=this.getAuthenticationRedirect();break;case e.DataValueKeys.ResponseText:n=this.getResponseText();break;case e.DataValueKeys.ErrorResponseText:n=this.getErrorResponseText()}return n};e.prototype.getRedirectUrl=function(){var e=o.t.isActivated("3FBEEB53-441C-4A84-82FC-C8221FCC50D8","02/11/2021","redirect url when access denied");if(this._isCanaryRequest)return 403===this.getStatus()?this.shouldRedirectToErrorCustomPromptLocation()?this.getRedirectToErrorCustomPromptLocation():this.getRedirectLoginPageUrl():this.getAccessDeniedRedirectUrl();if(403===this.getStatus()){if(this.shouldRedirectToErrorCustomPromptLocation())return this.getRedirectToErrorCustomPromptLocation();if(!e)return this.getRedirectLoginPageUrl()}else if(401===this.getStatus()){if(this.shouldRedirectToErrorCustomPromptLocation())return this.getRedirectToErrorCustomPromptLocation();if(!e)return this.getRedirectLoginPageUrl()}};e.prototype.getRedirectLoginPageUrl=function(){var e,t=this.getAuthenticationRedirect();if(t){var n=new i.t(t);n.setQueryParameter("ReturnUrl",s.e.encodeURIComponent(window.location.href));e=n.toString()}return e};e.prototype.getAccessDeniedRedirectUrl=function(){var e;if(this._webAbsoluteUrl){var t=this._webAbsoluteUrl+"/_layouts/15/AccessDenied.aspx";if(t){var n=new i.t(t);n.setQueryParameter("Source",s.e.encodeURIComponent(window.location.href));n.setQueryParameter("Type","list");n.setQueryParameter("correlation",s.e.encodeURIComponent(this.getCorrelationId()));e=n.toString()}}return e};e.prototype.getRedirectToErrorCustomPromptLocation=function(){var e=this.getResponseHeader("X-SPO-ErrorCustomPromptLocation"),t=new i.t(e);t.setQueryParameter("ReturnUrl",window.location.href);return t.toString()};e.prototype.shouldRedirectToErrorCustomPromptLocation=function(){var e=this.getResponseHeader("X-SPO-ErrorCode"),t=this.getResponseHeader("sharepointerror");return"9.3"===e||"-2130575129"===t};e.prototype.getResponseHeadersDictionary=function(){var e={},t=this.getAllResponseHeaders();if(t){var n=t.trim().split(/[\r\n]+/);n&&n.length>0&&n.forEach(function(t){var n=t.split(": "),r=n.shift(),i=n.join(": ");e[r]=i})}this.getResponseHeadersDictionary=function(){return e};return e};e.prototype.getResponseHeader=function(e){var t=this.getResponseHeadersDictionary();return t[e.toLowerCase()]||t[e]||this._request.getResponseHeader(e)};e.prototype._getNumberHeader=function(e){var t=this.getResponseHeader(e),n=Number(t);return isNaN(n)?void 0:n};e.DataValueKeys={SourceURL:"SourceUrl",CorrelationId:"CorrelationId",Status:"Status",AuthenticationRedirect:"AuthenticationRedirect",ResponseText:"ResponseText",ErrorResponseText:"ErrorResponseText",GroupThrottle:"GroupThrottle"};return e})();t.t=a},757:function(e,t,n){"use strict";n.d(t,"e",function(){return r});var r=(function(){function e(){}e.hasItemPermission=function(t,n){return t&&t.permissions&&e.hasPermission(t.permissions,n)};e.hasPermission=function(e,t){return!!t&&!!e&&(t.Low&e.Low)>>>0===t.Low&&(t.High&e.High)>>>0===t.High};e.hasAny=function(t,n){return(n||[]).some(function(n){return e.hasPermission(t,n)})};e.hasIdentityPermission=function(t,n){return n&&t.webPermMasks&&e.hasPermission(t.webPermMasks,n)};e.viewListItems={High:0,Low:1};e.insertListItems={High:0,Low:2};e.editListItems={High:0,Low:4};e.deleteListItems={High:0,Low:8};e.approveItems={High:0,Low:16};e.openItems={High:0,Low:32};e.viewVersions={High:0,Low:64};e.deleteVersions={High:0,Low:128};e.cancelCheckout={High:0,Low:256};e.manageLists={High:0,Low:2048};e.viewFormPages={High:0,Low:4096};e.reviewListItems={High:0,Low:16384};e.viewPages={High:0,Low:131072};e.layoutsPage={High:0,Low:135168};e.addAndCustomizePages={High:0,Low:262144};e.applyThemeAndBorder={High:0,Low:524288};e.viewUsageData={High:0,Low:2097152};e.manageSubwebs={High:0,Low:8388608};e.managePermissions={High:0,Low:33554432};e.browseDirectories={High:0,Low:67108864};e.manageWeb={High:0,Low:1073741824};e.useClientIntegration={High:16,Low:0};e.manageAlerts={High:64,Low:0};e.createAlerts={High:128,Low:0};e.enumeratePermissions={High:1073741824,Low:0};e.useRemoteAPIs={High:32,Low:0};e.fullMask={High:2147483647,Low:4294967295};return e})();t.t=r},785:function(e,t,n){"use strict";n.d(t,"e",function(){return i});var r=n(0),i=(function(e){Object(r.__extends)(t,e);function t(n){var i=this,s=n.errorData,o=void 0===s?n.innerError instanceof t&&n.innerError.errorData||{status:0}:s,u=o.message,a=void 0===u?void 0:u,f=o.correlationId,l=void 0===f?void 0:f,c=o.code,h=void 0===c?void 0:c,p=Object(r.__rest)(o,["message","correlationId","code"]),d="object"==typeof a?a?"string"==typeof a.value?a.value:JSON.stringify(a):""+a:a,v=Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({},"string"==typeof l?{correlationId:l}:{}),"string"==typeof h?{code:h}:{}),"string"==typeof d?{message:d}:{}),n),{extraData:Object(r.__assign)(Object(r.__assign)({},n.extraData||{}),{hasAuthChallenge:!!p.authenticate,status:p.status,infected:p.infected,groupThrottle:p.groupThrottle,statusText:p.statusText})});(i=e.call(this,v)||this).name="GetDataError";i.errorData=o;for(var m=0,g=Object.keys(p);m<g.length;m++){var y=g[m];i[y]=p[y]}return i}return t})(n(100).e)},802:function(e,t,n){"use strict";n.d(t,"n",function(){return s});n.d(t,"t",function(){return o});n.d(t,"e",function(){return u});var r=n(0),i=n(814);function s(e){return Object(r.__awaiter)(this,void 0,void 0,function(){var t;return Object(r.__generator)(this,function(s){switch(s.label){case 0:t=Object(r.__assign)({minValue:Math.round(Object(i.e)()),useMutationObserver:!1,trackNetworkRequests:!1,requiredMainThreadQuietnessDurationInMilliseconds:1e3,requiredNetworkQuietnessDurationInMilliseconds:1e3},e);return[4,n.ee(8,818)];case 1:return[2,s.sent().getFirstConsistentlyInteractive(t).then(function(e){return Object(r.__assign)(Object(r.__assign)({},e||{}),{options:t})})]}})})}function o(e){return Object(r.__awaiter)(this,void 0,void 0,function(){var t;return Object(r.__generator)(this,function(r){switch(r.label){case 0:t={measurementStartTime:e,requiredMainThreadCPUIdleDurationInMilliseconds:1e3};return[4,n.ee(8,1065)];case 1:return[2,r.sent().getFirstCPUIdle(t)]}})})}function u(){return"PerformanceLongTaskTiming"in window}},804:function(e,t,n){"use strict";n.d(t,"e",function(){return l});var r=n(73),i=n(82),s=n(44),o=n(25),u=n(100),a=n(740),f=n(737);var l=(function(){function e(e){void 0===e&&(e={});this._scope=new i.e;this._events=this._scope.attach(new s.t(this));var t=e.webAbsoluteUrl||e.webUrl;this._webServerRelativeUrl=e.webServerRelativeUrl||t&&new r.t(t).getPath();"/"===this._webServerRelativeUrl&&(this._webServerRelativeUrl="");if(t){this._webAbsoluteUrl=t;this._alwaysGetDigest=!0}else this._alwaysGetDigest=!1;this._needsRequestDigest=!1!==e.needsRequestDigest;this._needsRequestDigest&&this._tryLoadDigest(e.formDigest);this._requestCanaryForAuth=!1;this._engagement=e.engagement;this._operationName=e.operationName}e._isValidFormDigest=function(e){return e&&e.serverTime&&Date.now()-new Date(e.serverTime).getTime()<1e3*(e.formDigestTimeoutSeconds-60)};e.prototype.dispose=function(){this._scope.dispose()};e.prototype.abort=function(){if(this._currentRequest){var e=this._currentRequest;e.isCancelled=!0;e.abort();this._currentRequest=void 0}};e.prototype.isRequestActive=function(){return!!this._currentRequest};e.prototype.getServerDataFromUrl=function(e){var t=this,n=e.url,r=e.successCallback,i=e.failureCallback,s=e.uploadProgressCallback,o=e.additionalPostData,u=e.isRest,a=void 0===u||u,f=e.method,l=void 0===f?"POST":f,c=e.withCredentials,h=e.additionalHeaders,p=e.contentType,d=e.noRedirect,v=e.responseType,m=e.needsRequestDigest,g=void 0===m?this._needsRequestDigest:m,y=(new Date).toISOString(),b=new XMLHttpRequest;b.open(l,n,!0);"boolean"==typeof c&&(b.withCredentials=c);v&&(b.responseType=v);p?b.setRequestHeader("Content-Type",p):a?b.setRequestHeader("Content-Type","application/json;odata=verbose"):b.setRequestHeader("Content-Type","application/x-www-form-urlencoded");var w=!1;if(h)for(var E in h)if(E){b.setRequestHeader(E,h[E]);"accept"===E.toLowerCase()&&(w=!0)}w||b.setRequestHeader("accept","application/json;odata=verbose");this._currentRequest=b;var S=function(e){g&&e&&b.setRequestHeader("x-requestdigest",e);t._events.on(b,"readystatechange",function(){t._onReadyStateChange(b,n,r,i,d,y)});s&&b.upload&&t._events.on(b.upload,"progress",function(e){s(e)});b.send(o)};g?this._ensureRequestDigest(S,i):S()};e.prototype.ensureRequestDigest=function(e,t){this._ensureRequestDigest(e,t)};e.prototype._ensureRequestDigest=function(t,n){var r=e._formDigests[this._webServerRelativeUrl];!this._alwaysGetDigest&&e._isValidFormDigest(r)?t(r.formDigestValue):this._ensureRequestDigestWorker(t,n)};e.prototype._ensureRequestDigestWorker=function(t,n){var i=this,s=new Date,a=new e({needsRequestDigest:!1,webServerRelativeUrl:this._webServerRelativeUrl,webUrl:void 0});t||(a._requestCanaryForAuth=!0);var l=this._webAbsoluteUrl||this._webServerRelativeUrl;if("string"==typeof l){e._requestDigestPromise||(e._requestDigestPromise=new o.n(function(o,u){a.getServerDataFromUrl({url:r.t.concatenate(l,"/_api/contextinfo"),successCallback:function(t){var n=t.getResponseText(),r=JSON.parse(n).d.GetContextWebInformation;e._formDigests[i._webServerRelativeUrl]={serverTime:s.toISOString(),formDigestValue:r.FormDigestValue,formDigestTimeoutSeconds:r.FormDigestTimeoutSeconds-60,updateFormDigestPageLoaded:new Date};o(e._formDigests[i._webServerRelativeUrl].formDigestValue);e._requestDigestPromise=void 0},failureCallback:function(r,i){t?t(void 0):n&&n(r,i);u(void 0);e._requestDigestPromise=void 0},method:"POST",noRedirect:!!n})}));e._requestDigestPromise.then(function(e){t&&t(e);return e})}else n&&n(void 0,new u.e({code:f.t,isExpected:!1}))};e.prototype._onReadyStateChange=function(t,n,r,i,s,o){if(4===t.readyState){this._currentRequest=void 0;this._events.off(t);t.upload&&this._events.off(t.upload);if((d=t)&&d.isCancelled)i(void 0,new u.e({code:f.i,isExpected:!0}));else if((function(e){try{if(4===e.readyState&&(void 0===e.status||0===e.status))return!1}catch(e){return!1}return!0})(t)){var l=new a.t(t,n,{webAbsoluteUrl:this._webAbsoluteUrl||this._webServerRelativeUrl,isCanaryRequest:this._requestCanaryForAuth}),c=l.getStatus(),h=!s&&l.shouldRedirectToErrorCustomPromptLocation();if(this._requestCanaryForAuth){this._requestCanaryForAuth=!1;if(403===c){var p=l.getRedirectLoginPageUrl();try{h?window.location.href=l.getRedirectToErrorCustomPromptLocation():i(l)}catch(e){}p&&!s&&(window.location.href=p)}else{p=l.getAccessDeniedRedirectUrl();try{i(l)}catch(e){}if(p&&!s){this._engagement&&this._engagement.logData({name:"AccessDeniedRedirect",isIntentional:!1,extraData:{originalOperation:this._operationName||""}});window.location.href=p}}return}if(200===c||201===c||204===c){r(l);return}if(403===c){e._requestDigestPromise=void 0;s?this._ensureRequestDigestWorker(void 0,function(e,t){return i(l,t)}):h?window.location.href=l.getRedirectToErrorCustomPromptLocation():this._ensureRequestDigestWorker(void 0);return}401===c&&h&&(window.location.href=l.getRedirectToErrorCustomPromptLocation());i(l)}else i(void 0,new u.e({code:f.n,isExpected:!0}));var d}};e.prototype._tryLoadDigest=function(t){if(e._isValidFormDigest(t))e._formDigests[this._webServerRelativeUrl]=t;else{var n=e._formDigests[this._webServerRelativeUrl];e._isValidFormDigest(t)&&(!e._isValidFormDigest(n)||n&&new Date(n.serverTime).getTime()<new Date(t.serverTime).getTime())&&(e._formDigests[this._webServerRelativeUrl]=t)}};e._formDigests={};e._requestDigestPromise=void 0;return e})();t.t=l},805:function(e,t,n){"use strict";n.d(t,"e",function(){return i});var r=n(115);function i(e){var t,n=e.adjustRetries,i=e.async,s=e.beforeRetry,o=e.callback,u=e.canRetry,a=void 0===u?function(){return!0}:u,f=e.delay,l=e.resetAttemptsOnRestart,c=e.retries,h=e.shouldRestart,p=0,d=new r.e(function(){t.cancel()});function v(e){if(h&&h()){l&&(p=0);g()}else d.complete(e)}function m(e){n&&(c=n(e));if(p<c&&a(e)){p++;s&&s();"number"==typeof f&&i?i.setTimeout(g,f):g()}else d.error(e)}function g(){(t=o()).then(v,m)}g();return d.getPromise()}},814:function(e,t,n){"use strict";n.d(t,"e",function(){return r});function r(){return window.performance&&performance.now?Math.round(performance.now()):Date.now()}},831:function(e,t,n){"use strict";var r=(function(){function e(){}e.addConfig=function(e){window.require.config(e)};e.addPaths=function(e){window.require.config({paths:e})};e.addShims=function(e){window.require.config({shim:e})};return e})();t.e=r},837:function(e,t,n){"use strict";n.d(t,"n",function(){return i});n.d(t,"r",function(){return o});n.d(t,"t",function(){return a});n.d(t,"e",function(){return f});var r,i,s,o,u,a,f;(function(e){e[e.HEADER=0]="HEADER";e[e.NAV=1]="NAV";e[e.FOOTER=2]="FOOTER";e[e.SEARCHBOX=3]="SEARCHBOX"})(r||(r={}));(function(e){e[e.LEFT=0]="LEFT";e[e.HORIZONTAL=1]="HORIZONTAL"})(i||(i={}));(function(e){e[e.FULLBLEED=0]="FULLBLEED";e[e.WITHLEFTNAV=1]="WITHLEFTNAV"})(s||(s={}));(function(e){e[e.none=0]="none";e[e.standard=1]="standard";e[e.compact=2]="compact";e[e.minimal=3]="minimal";e[e.extended=4]="extended"})(o||(o={}));(function(e){e[e.left=0]="left";e[e.middle=1]="middle";e[e.right=2]="right"})(u||(u={}));(function(e){e[e.SIMPLE=0]="SIMPLE";e[e.EXTENDED=1]="EXTENDED";e[e.STACKED=2]="STACKED"})(a||(a={}));(function(e){e[e.Strong=0]="Strong";e[e.Neutral=1]="Neutral";e[e.Soft=2]="Soft";e[e.None=3]="None"})(f||(f={}))},998:function(e,t,n){"use strict";var r=(function(){function e(e){this._features=new Map;if(!e)throw new Error("Cannot create SPFeatureInfo object, incoming data is undefined.");for(var t in e)if(void 0!==t){var n=e[t];this._features.set(t,{version:n.Version,enabled:n.Enabled})}}e.prototype._serialize=function(){var e={};this._features.forEach(function(t,n){e[n]={Version:t.version,Enabled:t.enabled}});return e};e.prototype.get=function(e){if(!e||e&&0===e.length)throw new Error("Cannot get feature, featureName input is empty or undefined");return this._features.get(e)};return e})();t.e=r},1004:function(e,t,n){"use strict";n.d(t,"r",function(){return i});n.d(t,"t",function(){return o});n.d(t,"e",function(){return u});n.d(t,"n",function(){return a});var r="undefined"!=typeof window?window.performance:void 0;function i(){try{if(r&&r.now)return Math.round(performance.now())}catch(e){}return Date.now()}function s(e,t){void 0===t&&(t=!0);return t&&0!==e.lastIndexOf("EUPL.")?"EUPL."+e:e}function o(e,t){try{r&&r.mark&&r.mark(s(e,t))}catch(e){}}function u(e,t){try{if(r&&r.getEntriesByName){var n=r.getEntriesByName(s(e,t),"mark");return n&&n.length>0?Math.round(n[0].startTime):NaN}}catch(e){}return NaN}function a(e,t,n,i){try{r&&r.measure&&r.measure(s(e,i),s(t,i),s(n,i))}catch(e){}}},1016:function(e,t,n){"use strict";n.d(t,"e",function(){return r});var r={CUSTOM_SETTINGS_1:"WorkloadSettingsSubLinks1",CUSTOM_SETTINGS_2:"WorkloadSettingsSubLinks2",CUSTOM_SETTINGS_3:"WorkloadSettingsSubLinks3",FEEDBACK:"ShellFeedback",DIAGNOSTICS:"Diagnostics",O365_SETTINGS:"ShellO365Settings",ADD_APP:"SuiteMenu_zz5_MenuItemCreate",SITE_CONTENTS:"SuiteMenu_zz6_MenuItem_ViewAllSiteContents",SITE_SETTINGS:"SuiteMenu_zz7_MenuItem_Settings",SITE_INFORMATION:"SuiteMenu_MenuItem_SiteInformation",SITE_PERMISSIONS:"SuiteMenu_MenuItem_SitePermissions",SITE_DESIGNS:"SuiteMenu_MenuItem_SiteDesigns",SITE_TEMPLATES:"SuiteMenu_MenuItem_SiteTemplates",HUB_SETTINGS:"SuiteMenu_MenuItem_HubSettings",USER_ACTIVITY:"UserActivity",LIBRARY_SETTINGS:"SuiteMenu_LibrarySettings",LANGUAGE:"SuiteMenu_Language",CHANGE_THE_LOOK:"Change_The_Look",VIVA_CONNECTIONS:"Viva_Connections_Settings",ABOUT_ME:"ShellAboutMe",SETTINGS:"ShellSettings",MY_SETTINGS:"SuiteMenu_zz2_ID_PersonalInformation",SIGN_OUT:"ShellSignout",HELP:"HelpLink",COMMUNITY:"ShellCommunity",PRIVACY:"ShellPrivacy",LEGAL:"ShellLegal",USERVOICE:"UserVoice",FIRSTRUN:"FirstRun",DEVELOPERS:"Developers",ABUSE:"ReportAbuse",IMPRESSUM:"Impressum",MAIL:"ShellMail",CALENDAR:"ShellCalendar",PEOPLE:"ShellPeople",ONEDRIVE:"ShellDocuments",WORD:"ShellWordOnline",EXCEL:"ShellExcelOnline",POWERPOINT:"ShellPowerPointOnline",ONENOTE:"ShellOneNoteOnline",SITES:"ShellSites",YAMMER:"ShellYammer",TASKS:"ShellTasks",POWER_BI:"ShellPowerBI",DELVE:"ShellOfficeGraph",VIDEO:"ShellVideo",ALCHEMY:"ShellAlchemy",SMILE:"ShellSendASmile",STREAM:"ShellStream",LISTS:"Lists",SHAREPOINT:"Sharepoint"}},1019:function(e,t,n){"use strict";n.d(t,"t",function(){return o});n.d(t,"e",function(){return u});var r=n(25),i=(n(702),n(556)),s=n(998);n(757);function o(e,t,n){var i=0;return new r.n(function(r,s){var o=setInterval(function(){if(!(i*t<=n)){clearInterval(o);throw"Timed out waiting for checker "+e}i++;if(e()){clearInterval(o);r()}},t)})}function u(e){if(e.featureInfo){var t=new s.e(e.featureInfo);if(t){var n=t.get("SitePagePublishing");return!!n&&n.enabled}return!1}return Number(e.webTemplate)===i.t.sitePagePublishing}},1032:function(e,t,n){"use strict";n.d(t,"e",function(){return r});var r=(function(){function e(){}e.GetLoadPromise=function(){return window.o365ShellLoadPromise};e.GetRenderPromise=function(){return window.o365ShellRenderPromise};e.GetPostRenderPromise=function(){return window.o365ShellPostRenderPromise};return e})()},1052:function(e,t,n){"use strict";n.d(t,"e",function(){return s});var r=n(115),i=n(1032),s=(function(){function e(){var e=this;this._PostRenderSignal=new r.e;i.e.GetLoadPromise()&&i.e.GetLoadPromise().then(function(){e._signalAction(function(){})});i.e.GetRenderPromise()&&i.e.GetRenderPromise().then(function(){e._signalAction(function(){})});i.e.GetPostRenderPromise()&&i.e.GetPostRenderPromise().then(function(){e._signalAction(function(){})})}Object.defineProperty(e.prototype,"FlexPane",{get:function(){return O365Shell.FlexPane},enumerable:!0,configurable:!0});Object.defineProperty(e.prototype,"Header",{get:function(){return O365Shell.Header},enumerable:!0,configurable:!0});Object.defineProperty(e.prototype,"Navigation",{get:function(){return O365Shell.Navigation},enumerable:!0,configurable:!0});Object.defineProperty(e.prototype,"Settings",{get:function(){return O365Shell.Settings},enumerable:!0,configurable:!0});Object.defineProperty(e.prototype,"Theme",{get:function(){return O365Shell.Theme},enumerable:!0,configurable:!0});Object.defineProperty(e.prototype,"Search",{get:function(){return O365Shell.Search},enumerable:!0,configurable:!0});Object.defineProperty(e.prototype,"NFD",{get:function(){return O365Shell.NFD},enumerable:!0,configurable:!0});Object.defineProperty(e.prototype,"Extensibility",{get:function(){return O365Shell.Extensibility},enumerable:!0,configurable:!0});Object.defineProperty(e.prototype,"MeControl",{get:function(){return O365Shell.MeControl},enumerable:!0,configurable:!0});Object.defineProperty(e.prototype,"DTT",{get:function(){return O365Shell.DTT},enumerable:!0,configurable:!0});e.prototype.SetData=function(e){O365Shell.SetData(e)};e.prototype.Render=function(e,t){var n=this;O365Shell.Render(e,function(){return n._signalAction(t)})};e.prototype.RenderAsync=function(e,t,n){var r=this;O365Shell.RenderAsync(e,function(){return r._signalAction(t)},function(){return r._signalAction(n)})};e.prototype.GetResourceLoader=function(){return O365Shell.GetResourceLoader()};e.prototype.OnDataChanged=function(e){return O365Shell.OnDataChanged(e)};e.prototype.OnSuiteAPILoaded=function(e){return O365Shell.OnSuiteAPILoaded(e)};e.prototype.LoadShellPlus=function(){O365Shell.LoadShellPlus()};e.prototype.Exists=function(){return"undefined"!=typeof O365Shell};e.prototype.HasMember=function(e){return this.Exists()&&!!O365Shell[e]};e.prototype.OnHasMember=function(e,t){var n=this;this.HasMember(e)?t():this._PostRenderSignal.getPromise().done(function(){return n.OnHasMember(e,t)})};e.prototype._signalAction=function(e){e();var t=this._PostRenderSignal;this._PostRenderSignal=new r.e;t.complete()};return e})()},1057:function(e,t,n){"use strict";var r=n(0),i=n(180),s=n(25),o=n(34),u=n(48),a=n(6),f=n(18),l=n(178),c=n(3),h=n(5),p=(function(e){Object(r.__extends)(t,e);function t(t,n){void 0===n&&(n={});var r=e.call(this,t,n)||this;r.name="Navigation";var i=t.url,s=t.viewParams,o=t.target,f=void 0===o?"_top":o,l=t.forceNavigation,c=void 0!==l&&l,h=t.ignoreHistory,p=t.beforeNavigation,d=t.afterNavigation,v=t.postProcessUrl,m=n.navigation,g=void 0===m?r.resources.consume(u.e):m,y=n.viewParamsObservable,b=void 0===y?r.resources.consume(a.H):y;r._navigation=g;r._viewParams=b;r._url=r.wrapObservable(i);r._inputViewParams=r.wrapObservable(s);r._target=r.wrapObservable(f);r._forceNavigation=c;r._ignoreHistory=h;r._beforeNavigation=p;r._afterNavigation=d;r._postProcessUrl=v;return r}t.prototype.onExecute=function(e,t){var n=this._url.peek(),r=this._inputViewParams.peek(),i=this._beforeNavigation;i&&i(this._navigation);var u=this._postProcessUrl?this._postProcessUrl(n):n;(this._forceNavigation||n)&&this._navigation.navigateTo({url:u,viewParams:r,frameId:this._target.peek(),ignoreHistory:this._ignoreHistory});this._afterNavigation&&this._afterNavigation(this._navigation);return s.n.wrap({resultType:o.e.Success})};t.prototype.onIsAvailable=function(){var e=this._url();if(!e)return!1;if(this._forceNavigation)return!0;var t=this._inputViewParams(),n=this._viewParams(),r="#"+f.n(n),i=t&&0===t.indexOf("#")?t.substring(1):"",s=i+(i?"&":"")+(0===e.indexOf("#")?e.substring(1):"");if(s){var o=f.e(s);return!l.e(n,o)}return e!==r};t.dependencies={resources:c.o,navigation:u.e,viewParamsObservable:a.H};return t})(i.e);t.e=p;Object(h.o)("NavigationAction",p)},1215:function(e,t,n){"use strict";n.d(t,"e",function(){return r});var r={GET_O365_SHELL:"SuiteNavProvider.GetO365Shell",SUITE_NAV_PROVIDER_LOAD_DATA:"SuiteNavProvider.LoadData",SUITE_NAV_LOAD:"SuiteNav.Load",SUITE_NAV_RENDER:"SuiteNav.Render",SUITE_NAV_POSTRENDER:"SuiteNav.PostRender",REFRESH_CACHE_FOR_SHELL_DATA_CHANGED:"SuiteNav.RefreshCacheForShellDataChanged",REFRESH_CACHE_AFTER_INVALID_SHELL_DATA:"SuiteNav.RefreshCacheAfterInvalidShellData"}},1219:function(e,t,n){"use strict";var r=n(0),i=n(1052),s=n(28),o=(function(){function e(){}e.prototype.OnFlexPaneVisibilityChanged=function(e){try{return O365Shell.FlexPane.OnFlexPaneVisibilityChanged(e)}catch(e){s.e.log(e,"FlexPaneWrapper","OnFlexPaneVisibilityChanged")}};e.prototype.OpenFlexPaneForProvider=function(e){try{O365Shell.FlexPane.OpenFlexPaneForProvider(e)}catch(e){s.e.log(e,"FlexPaneWrapper","OpenFlexPaneForProvider")}};e.prototype.CloseFlexPaneForProvider=function(e){try{O365Shell.FlexPane.CloseFlexPaneForProvider(e)}catch(e){s.e.log(e,"FlexPaneWrapper","CloseFlexPaneForProvider")}};e.prototype.RemoveOnFlexPaneVisibilityChanged=function(e){try{O365Shell.FlexPane.RemoveOnFlexPaneVisibilityChanged(e)}catch(e){s.e.log(e,"FlexPaneWrapper","RemoveOnFlexPaneVisibilityChanged")}};return e})(),u=(function(){function e(){}e.prototype.OnLinkClick=function(e){try{O365Shell.Navigation.OnLinkClick(e)}catch(e){s.e.log(e,"NavigationWrapper","OnLinkClick")}};e.prototype.OnHamburgerButtonClick=function(e){try{O365Shell.Navigation.OnHamburgerButtonClick(e)}catch(e){s.e.log(e,"NavigationWrapper","OnHamburgerButtonClick")}};e.prototype.RemoveOnLinkClick=function(e){try{O365Shell.Navigation.OnLinkClick(e)}catch(e){s.e.log(e,"NavigationWrapper","RemoveOnLinkClick")}};e.prototype.EnterAccessibilityLoopInShell=function(){try{O365Shell.Navigation.EnterAccessibilityLoopInShell()}catch(e){s.e.log(e,"NavigationWrapper","EnterAccessibilityLoopInShell")}};e.prototype.ReverseEnterAccessibilityLoopInShell=function(){try{O365Shell.Navigation.ReverseEnterAccessibilityLoopInShell()}catch(e){s.e.log(e,"NavigationWrapper","ReverseEnterAccessibilityLoopInShell")}};e.prototype.SetForwardAccessibilityLoopOutsideHeaderElementId=function(e){try{O365Shell.Navigation.SetForwardAccessibilityLoopOutsideHeaderElementId(e)}catch(e){s.e.log(e,"NavigationWrapper","SetForwardAccessibilityLoopOutsideHeaderElementId")}};e.prototype.SetReverseAccessibilityLoopOutsideHeaderElementId=function(e){try{O365Shell.Navigation.SetReverseAccessibilityLoopOutsideHeaderElementId(e)}catch(e){s.e.log(e,"NavigationWrapper","SetReverseAccessibilityLoopOutsideHeaderElementId")}};return e})(),a=(function(e){Object(r.__extends)(t,e);function t(){var t=null!==e&&e.apply(this,arguments)||this;t._flexPane=new o;t._navigation=new u;return t}Object.defineProperty(t.prototype,"FlexPane",{get:function(){return this._flexPane},enumerable:!1,configurable:!0});Object.defineProperty(t.prototype,"Navigation",{get:function(){return this._navigation},enumerable:!1,configurable:!0});return t})(i.e);t.e=a},1775:function(e,t,n){"use strict";var r=n(1),i=(function(){function e(){}e.init=function(e,t,n,i,s){var o=r.utils.unwrapObservable(t()),u=o&&o.activate||o;u&&u.call(s.$data,e)};e.supportsVirtualElements=!0;return e})();t.e=i},2213:function(e,t,n){"use strict";var r=n(1016);t.e=r.e}}]);