(window.odspNextWebpackJsonp=window.odspNextWebpackJsonp||[]).push([["108"],{1178:function(e,t,n){"use strict";var r=n(0),i=n(25),s=n(251),o={ownerCannotShareWithSelf:!0,maximumRecipientsExceeded:!0,invalidAclEmailSpecified:!0,duplicateMembersInRequest:!0,secureSharingInvalidRequest:!0},u=(function(){function e(e,t){this._dataRequestor=t.dataRequestor}e.getSharesPathFromItemUrl=function(e){return"/shares/u!"+btoa(unescape(encodeURIComponent(e))).replace(/=/g,"").replace(/\//g,"_").replace(/\+/g,"-")+"/driveItem"};e.prototype.createBundle=function(e,t){var n=JSON.stringify({children:e.map(function(e){return{id:e}}),bundle:{},name:t});n=n.slice(0,-1)+',"@microsoft.graph.conflictBehavior": "rename"}';return this._dataRequestor.send({path:"/drive/bundles",apiName:"bundles",requestType:"POST",useAuthorizationHeaders:!0,postData:n,getErrorAsMessage:!0,expectedErrorCodes:o}).then(function(e){return e})};e.prototype.getFamily=function(){var e={};s.e.isFeatureEnabled({ODC:"FamilySharingPreferKillswitch"})||(e.prefer="family.group-enabled-only");return this._dataRequestor.send({path:"/household/me/family",apiName:"family",requestType:"GET",useAuthorizationHeaders:!0,getErrorAsMessage:!0,headers:e,expectedErrorCodes:Object(r.__assign)(Object(r.__assign)({},o),{404:!0})}).then(function(e){return e})};e.prototype.getFamilyMembers=function(){var e={};s.e.isFeatureEnabled({ODC:"FamilySharingPreferKillswitch"})||(e.prefer="family.group-enabled-only");return this._dataRequestor.send({path:"/household/me/family/members",apiName:"familyMembers",requestType:"GET",useAuthorizationHeaders:!0,getErrorAsMessage:!0,headers:e,expectedErrorCodes:Object(r.__assign)(Object(r.__assign)({},o),{404:!0})}).then(function(e){return e})};e.prototype.isUserPremium=function(){return this._dataRequestor.send({path:"/me/drive",apiName:"drive",requestType:"GET",useAuthorizationHeaders:!0,breakCache:!0,getErrorAsMessage:!0,expectedErrorCodes:o}).then(function(e){return!!e.quota.storagePlanInformation&&!e.quota.storagePlanInformation.upgradeAvailable})};e.prototype.getDriveInfo=function(){return this._dataRequestor.send({path:"/me/drive",apiName:"drive",requestType:"GET",useAuthorizationHeaders:!0,breakCache:!0,getErrorAsMessage:!0,expectedErrorCodes:o}).then(function(e){return e})};e.prototype.createLink=function(e){var t=this,n=e.itemIds,r=e.type,i=e.scope,s=e.preventDownload,o=e.password,u=e.expiration,a=e.bundleName;return 1===n.length?this.createLinkSingleItem({itemUrl:this.getDrivesPathFromItemId(n[0]),type:r,scope:i,preventDownload:s,password:o,expiration:u}):this.createBundle(n,a).then(function(e){return t.createLinkSingleItem({itemUrl:t.getDrivesPathFromItemId(e.id),type:r,scope:i,preventDownload:s,password:o,expiration:u})})};e.prototype.createLinkFromItemUrl=function(t){var n=t.itemUrl,r=t.type,i=t.scope,s=t.preventDownload,o=t.password,u=t.expiration;return this.createLinkSingleItem({itemUrl:e.getSharesPathFromItemUrl(n),type:r,scope:i,preventDownload:s,password:o,expiration:u})};e.prototype.getCurrentUserId=function(){return this._dataRequestor.send({path:"/me",apiName:"me",requestType:"GET",useAuthorizationHeaders:!0,breakCache:!0,getErrorAsMessage:!0,expectedErrorCodes:o}).then(function(e){return e.id})};e.prototype.getCurrentUser=function(){return this._dataRequestor.send({path:"/me",apiName:"me",requestType:"GET",useAuthorizationHeaders:!0,breakCache:!0,getErrorAsMessage:!0,expectedErrorCodes:o})};e.prototype.getItemInfo=function(e){var t=""+this.getDrivesPathFromItemId(e);return this._dataRequestor.send({path:t,apiName:"item",requestType:"GET",useAuthorizationHeaders:!0,breakCache:!0,getErrorAsMessage:!0,expectedErrorCodes:o}).then(function(e){return e})};e.prototype.getItemInfoFromItemUrl=function(t){var n=""+e.getSharesPathFromItemUrl(t);return this._dataRequestor.send({path:n,apiName:"item",requestType:"GET",useAuthorizationHeaders:!0,breakCache:!0,getErrorAsMessage:!0,expectedErrorCodes:o}).then(function(e){return e})};e.prototype.getPermissions=function(e){var t=this.getDrivesPathFromItemId(e)+"/permissions";return this._dataRequestor.send({path:t,apiName:"permissions",requestType:"GET",useAuthorizationHeaders:!0,breakCache:!0,getErrorAsMessage:!0,expectedErrorCodes:o}).then(function(e){return e.value})};e.prototype.getPermissionsFromItemUrl=function(t){var n=e.getSharesPathFromItemUrl(t)+"/permissions";return this._dataRequestor.send({path:n,apiName:"permissions",requestType:"GET",useAuthorizationHeaders:!0,breakCache:!0,getErrorAsMessage:!0,expectedErrorCodes:o}).then(function(e){return e.value})};e.prototype.invite=function(e){var t=this,n=e.itemIds,r=e.recipients,i=e.message,s=e.requireSignIn,o=e.sendInvitation,u=e.roles,a=e.password,f=e.expiration,l=e.bundleName;return 1===n.length?this.inviteSingleItem(this.getDrivesPathFromItemId(n[0]),r,i,s,o,u,a,f):this.createBundle(n,l).then(function(e){return t.inviteSingleItem(t.getDrivesPathFromItemId(e.id),r,i,s,o,u,a,f)})};e.prototype.inviteFromItemUrl=function(t){var n=t.itemUrl,r=t.recipients,i=t.message,s=t.requireSignIn,o=t.sendInvitation,u=t.roles,a=t.password,f=t.expiration;return this.inviteSingleItem(e.getSharesPathFromItemUrl(n),r,i,s,o,u,a,f)};e.prototype.getDefaultLink=function(t,n,r){return n.length>0?this.inviteSingleItem(e.getSharesPathFromItemUrl(t),n,"",!0,!1,[],"",void 0,{prefer:"getDefaultLink,ReturnSpecificErrorCode"},r):this.createLinkSingleItem({itemUrl:e.getSharesPathFromItemUrl(t),useMultiPart:r}).then(function(e){return i.n.wrap([e])})};e.prototype.getDefaultLinkByUniqueId=function(e,t,n){return t.length>0?this.inviteSingleItem(this.getPathFromUniqueId(e),t,"",!0,!1,[],"",void 0,{prefer:"getDefaultLink,ReturnSpecificErrorCode"},n):this.createLinkSingleItem({itemUrl:this.getPathFromUniqueId(e),useMultiPart:n}).then(function(e){return i.n.wrap([e])})};e.prototype.updatePermissions=function(e,t,n){var r=this.getDrivesPathFromItemId(e)+"/permissions/"+t,i={roles:[n]};return this._dataRequestor.send({path:r,apiName:"updatePermission",requestType:"PATCH",useAuthorizationHeaders:!0,postData:JSON.stringify(i),getErrorAsMessage:!0,expectedErrorCodes:o}).then(function(e){return e.value})};e.prototype.updatePermissionsFromItemUrl=function(t,n,r){var i=e.getSharesPathFromItemUrl(t)+"/permissions/"+n,s={roles:[r]};return this._dataRequestor.send({path:i,apiName:"updatePermission",requestType:"PATCH",useAuthorizationHeaders:!0,postData:JSON.stringify(s),getErrorAsMessage:!0,expectedErrorCodes:o}).then(function(e){return e.value})};e.prototype.unshareLink=function(e,t){var n=this.getDrivesPathFromItemId(e)+"/permissions/"+t;return this._dataRequestor.send({path:n,apiName:"removePermission",requestType:"DELETE",useAuthorizationHeaders:!0,getErrorAsMessage:!0,expectedErrorCodes:o}).then(function(){return!0})};e.prototype.unshareLinkFromItemUrl=function(t,n){var r=e.getSharesPathFromItemUrl(t)+"/permissions/"+n;return this._dataRequestor.send({path:r,apiName:"removePermission",requestType:"DELETE",useAuthorizationHeaders:!0,getErrorAsMessage:!0,expectedErrorCodes:o}).then(function(){return!0})};e.prototype.createLinkSingleItem=function(e){var t=e.type,n=e.itemUrl,r=e.scope,i=e.preventDownload,s=e.password,u=e.useMultiPart,a=e.expiration,f=n+"/createLink",l=t&&r?{type:t,scope:r,preventDownload:i}:void 0;(s||""===s)&&(l.password=s);a&&(l.expirationDateTime=a);return this._dataRequestor.send({path:f,apiName:"createLink",requestType:"POST",useMultiPart:u,useAuthorizationHeaders:!0,postData:JSON.stringify(l||{}),getErrorAsMessage:!0,expectedErrorCodes:o}).then(function(e){return e})};e.prototype.getPathFromUniqueId=function(e){return"/sites/root/items/"+e+"/driveItem"};e.prototype.getDrivesPathFromItemId=function(e){var t=e.split("!");return t.length>1?"/drives/"+t[0]+"/items/"+e:"/drive/items/"+e};e.prototype.inviteSingleItem=function(e,t,n,r,i,s,u,a,f,l){var c=e+"/invite",h={recipients:t,message:n,requireSignIn:r,sendInvitation:i,roles:s};u&&(h.password=u);a&&(h.expirationDateTime=a);return this._dataRequestor.send({path:c,apiName:"invite",requestType:"POST",useAuthorizationHeaders:!0,postData:JSON.stringify(h),useMultiPart:l,headers:f,getErrorAsMessage:!0,expectedErrorCodes:o}).then(function(e){return e.value})};return e})();t.e=u},2575:function(e,t,n){"use strict";n.r(t);n.d(t,"getDoesUserHaveFamily",function(){return l});var r=n(0),i=n(1178),s=n(513),o=n(25),u=n(15),a=n(226),f=n(34);function l(e){return Object(r.__awaiter)(this,void 0,o.n,function(){var t,n,l,c,h,p=this;return Object(r.__generator)(this,function(d){switch(d.label){case 0:return[4,e.consumeAsync(u.x)];case 1:t=d.sent();n=new s.t({},{urlDataSource:{getApiBaseUrl:function(){return"https://graph.microsoft.com/beta"}},sessionManagementProvider:{getToken:function(){return Object(r.__awaiter)(p,void 0,o.n,function(){return Object(r.__generator)(this,function(e){switch(e.label){case 0:return t?[4,t.getGraphToken({})]:[3,2];case 1:return[2,e.sent()];case 2:return[2,o.n.reject("Could not retrieve identity data source")]}})})}}});l=new i.e({},{dataRequestor:n});d.label=2;case 2:d.trys.push([2,4,,5]);return[4,l.getFamilyMembers()];case 3:return[2,(c=d.sent())&&c.value&&c.value.length>1];case 4:h=d.sent();new a.e({name:"FamiliesGroupsFre.GetFamilyMembers"}).end({resultType:f.e.Failure,resultCode:"GetFamilyMembersFailure",error:h&&h.message||"Unknown"});return[2,!1];case 5:return[2]}})})}}}]);