(window.odspNextWebpackJsonp=window.odspNextWebpackJsonp||[]).push([["272"],{577:function(e,t,n){"use strict";n.r(t);n.d(t,"resourceKey",function(){return h});var r=n(0),i=n(1),s=n(8),o=n(35),u=n(5),a=n(409),f=n(31),l=n(15);0;var c=(function(e){Object(r.__extends)(t,e);function t(t,n){void 0===t&&(t={});var r=e.call(this,t,n)||this;r._isFirstProcess=!0;if(!n.userInfoProvider.isAuthenticated())return r;if(n.platformDetection.isMobile)return r;var i=n.userInfoStore;r._userInfo=i.getUserInfo();r._handlers={};r._notifications=n.notifications;r._notificationProvider=n.notificationProvider;r._notifications.loadGlobalHandlers(r._getLoader());r.createComputed(r._computeProcessNotifications);r.createComputed(r._computeProcessTriggeredNotifications);return r}t.triggerNotification=function(e){this._triggeredNotifications.push(e)};t.prototype.createNotificationHandlers=function(e){this._notifications&&this._notifications.loadPageHandlers(this._getLoader(e))};t.prototype._getLoader=function(e){var t=this;return function(n){for(var r=e?e(n):new(t.managed(n)),i=0,s=r.types;i<s.length;i++){var o=s[i];t._handlers[o]=r}t._isFirstProcess||t._processHandler(r)}};t.prototype._processHandler=function(e){var t=this._userInfo();if(t){for(var n={},r=0,i=e.types;r<i.length;r++){n[i[r]]=!0}if(t&&t.notifications)for(var s=0,o=t.notifications;s<o.length;s++){var u=o[s];n[u.type]&&this._shouldShowNotification(u,!1)&&this._handleNotification(u)}}};t.prototype._computeProcessNotifications=function(){var e=this._userInfo();if(e&&e.notifications){for(var t=0,n=e.notifications;t<n.length;t++){var r=n[t];this._shouldShowNotification(r,this._isFirstProcess)&&this._handleNotification(r)}this._isFirstProcess=!1}};t.prototype._computeProcessTriggeredNotifications=function(){for(var e=t._triggeredNotifications(),n=0;n<e.length;n++){var r=this._handlers[e[n]];if(r){r.showNotification();e.splice(n--,1)}}t._triggeredNotifications(e)};t.prototype._shouldShowNotification=function(e,t){return!(!e||!e.id&&t)&&(!this._notificationProvider.handledNotifications[e.id]&&!this._isExpired(e))};t.prototype._isExpired=function(e){if(e.id&&e.expiryDateTime){var t=new Date(e.expiryDateTime);if((new Date).getTime()>t.getTime()){this._notificationProvider.handledNotifications[e.id]=!0;return!0}}if(e.id&&e.expiryDate){t=new Date(e.expiryDate);if((new Date).getTime()>t.getTime()+864e5){this._notificationProvider.handledNotifications[e.id]=!0;return!0}}return!1};t.prototype._handleNotification=function(e){var t=this._handlers[e.type];if(!t)return!1;t.handleNotification(e);e.id&&(this._notificationProvider.handledNotifications[e.id]=!0);return!0};t.dependencies=Object(r.__assign)(Object(r.__assign)({},s.n.dependencies),{platformDetection:o.e,userInfoStore:a.t,userInfoProvider:f.L,notifications:l.U,notificationProvider:f.c});t._triggeredNotifications=i.observableArray();return t})(s.n);t.default=c;var h=Object(u.s)("NotificationManager",c)}}]);