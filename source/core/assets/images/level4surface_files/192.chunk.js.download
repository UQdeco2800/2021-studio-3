(window.odspNextWebpackJsonp=window.odspNextWebpackJsonp||[]).push([["192"],{2032:function(e,t,n){"use strict";n.r(t);n.d(t,"resourceKey",function(){return p});var r=n(0),i=n(8),s=n(25),o=n(226),u=n(34),a=n(230),f=n(145),l=n(372),c=n(5),h=(function(e){Object(r.__extends)(t,e);function t(t,n){void 0===t&&(t={});var r=e.call(this,t,n)||this;r._pendingRequests={};r._cachedMessages=null;r._vroomDataRequestor=n.vroomDataRequestor;return r}t.prototype.getMessages=function(e){var n=this;void 0===e&&(e=!1);var r=this._getApiUrl()+"/messages";if(this._pendingRequests[r])return this._pendingRequests[r];if(null!=this._cachedMessages&&!e)return s.n.wrap(this._cachedMessages);var i={apiName:t.API_NAME,path:r,requestType:"GET",useAuthorizationHeaders:!0},f=new o.e({name:"InAppMessaging.GetMessages"}),l=this._vroomDataRequestor.send(i).then(function(e){delete n._pendingRequests[r];var t=e.messageIds;n._cachedMessages=t;f.end({resultType:u.e.Success,extraMetrics:{count:t.length}});return t},function(e){delete n._pendingRequests[r];f.end({resultType:u.e.Failure,resultCode:Object(a.i)(e),extraData:Object(a.r)(e)});return s.n.wrapError(e)});this._pendingRequests[r]=l;return l};t.prototype.markMessagesAsRead=function(e){if(0===e.length)return s.n.wrap();var n=this._getApiUrl()+"/messages",r={messageIds:e},i=new o.e({name:"InAppMessaging.MarkMessagesAsRead",extraMetrics:{count:e.length}}),f={apiName:t.API_NAME,path:n,requestType:"POST",postData:JSON.stringify(r),useAuthorizationHeaders:!0};this._cachedMessages=null;return this._vroomDataRequestor.send(f).then(function(){i.end({resultType:u.e.Success})},function(e){i.end({resultType:u.e.Failure,resultCode:Object(a.i)(e),extraData:Object(a.r)(e)});return s.n.wrapError(e)})};t.prototype._getApiUrl=function(){var e=f.t.getVroomBaseUrl({apiVersion:"v1.0",driveId:"me"}),t=e.lastIndexOf("/v1.0");-1!==t&&(e=e.substring(0,t));return e+="/inappmessaging/v1"};t.dependencies=Object(r.__assign)(Object(r.__assign)({},i.n.dependencies),{vroomDataRequestor:l.e});t.API_NAME="inAppMessaging";return t})(i.n);t.default=h;var p=Object(c.s)("InAppMessagingDataSource",h)}}]);