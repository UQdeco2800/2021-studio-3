(window.odspNextWebpackJsonp=window.odspNextWebpackJsonp||[]).push([["187"],{1229:function(e,t,n){"use strict";var r;(function(e){e[e.update=0]="update";e[e.leftNav=1]="leftNav";e[e.quotaBlock=2]="quotaBlock";e[e.frozenBlock=3]="frozenBlock";e[e.manageStorage=4]="manageStorage";e[e.lockedBlock=5]="lockedBlock";e[e.dragAndDrop=6]="dragAndDrop";e[e.premiumLeftNav=7]="premiumLeftNav";e[e.quotaBanner=8]="quotaBanner"})(r||(r={}));t.e=r},1274:function(e,t,n){"use strict";var r;(function(e){e[e.unknown=0]="unknown";e[e.none=1]="none";e[e.learnMore=2]="learnMore";e[e.upgrade=3]="upgrade";e[e.cleanUpFiles=4]="cleanUpFiles";e[e.manageStorage=5]="manageStorage";e[e.wac=6]="wac";e[e.officePlans=7]="officePlans"})(r||(r={}));t.e=r},1489:function(e,t,n){"use strict";var r=n(37),i=(function(){function e(){}e.IsProblematicLocale=function(t){null===e._problematicLocalesMap&&e.InitializeProblematicLocales();t&&(t=t.toLowerCase());return e._problematicLocalesMap[t]};e.convertToLocaleDateString=function(e,t){void 0===t&&(t="en-us");try{var n=t.toLocaleLowerCase();return new Date(e).toLocaleDateString(n)}catch(e){return}};e.convertToDateString=function(e){var t=new RegExp(/(\d{4})\-(\d{1,2})\-(\d{1,2})/);if(e&&e.match(t))return e.replace(t,"$2/$3/$1")};e.convertToDayMonth=function(e,t){void 0===t&&(t="en-us");try{var n=t.toLocaleLowerCase(),i=new Date(e),s=i.toLocaleString(n,{month:"short"});return r.format("{0}. {1}",i.getDate(),s)}catch(e){return}};e.convertToMonthDayYear=function(e,t){void 0===t&&(t="en-us");try{var n=t.toLocaleLowerCase(),i=new Date(e),s=i.toLocaleString(n,{month:"long"});return r.format("{0} {1}, {2}",s,i.getDate(),i.getFullYear())}catch(e){return}};e.convertToLocaleString=function(e,t){void 0===t&&(t="en-us");try{var n=t.toLocaleLowerCase();return new Date(e).toLocaleString(n)}catch(e){return}};e.getLongDateStringSafe=function(t,n){if(t){var r=new Date(t);if(r&&!isNaN(r.getTime())){try{if(!e.IsProblematicLocale(n))return r.toLocaleDateString(n,e._longDateFormatOptions)}catch(e){}return r.toLocaleDateString("en",e._longDateFormatOptions)}}};e.getDaysFromToday=function(e){var t=new Date(e).getTime()-(new Date).getTime();return Math.floor(t/864e5)};e.InitializeProblematicLocales=function(){e._problematicLocalesMap={};try{for(var t={month:"long"},n=0,r=e._chromeProblematicLocales;n<r.length;n++){var i=r[n];(new Date).toLocaleDateString(i,t).match("M[0-9][0-9]")&&(e._problematicLocalesMap[i]=!0)}}catch(e){}};e._chromeProblematicLocales=["eu-es","af-za","az-latn-az","bs-latn-ba","cy-gb","ga-ie","gl-es","ha-latn-ng","hy-am","ig-ng","is-is","ka-ge","kk-kz","km-kh","ky-kg","mk-mk","mn-mn","mt-mt","ne-np","nn-no","or-in","pa-in","si-lk","sq-al","ur-pk","uz-latn-uz","yo-ng","zu-za","pa-arab-pk","ku-arab-iq","be-by","rw-rw","ti-et","tg-cyrl-tj","eu","af","az","bs","cy","ga","gl","ha","hy","ig","is","ka","kk","km","ky","mk","mn","mt","ne","nn","or","pa","si","sq","ur","uz","yo","zu","pa","ku","be","rw","ti"];e._longDateFormatOptions={year:"numeric",month:"long",day:"numeric"};e._problematicLocalesMap=null;return e})();t.e=i},2780:function(e,t,n){"use strict";n.r(t);n.d(t,"resourceKey",function(){return E});var r=n(12);Object(r.n)([{rawString:".od-QuotaBanner{overflow:hidden;display:flex;background:#fde7e9;padding:16px 24px}.isFluent .od-QuotaBanner{background:"},{theme:"white",defaultValue:"#ffffff"},{rawString:";border-radius:2px;box-shadow:0 1.6px 3.6px 0 rgba(0,0,0,.132),0 .3px .9px 0 rgba(0,0,0,.108);flex-direction:column;padding:20px 24px 24px;margin-top:16px}html[dir=ltr] .isFluent .od-QuotaBanner{border-left:4px solid #a4262c}html[dir=rtl] .isFluent .od-QuotaBanner{border-right:4px solid #a4262c}@media (max-width:1366px){.od-QuotaBanner{flex-direction:column}}.od-QuotaBanner .od-QuotaBanner-textAndIcon{display:flex;flex-direction:row;width:100%}.od-QuotaBanner .od-QuotaBanner-textAndIcon .od-QuotaBanner-icon{margin:8px 24px 0 0}html[dir=rtl] .od-QuotaBanner .od-QuotaBanner-textAndIcon .od-QuotaBanner-icon{margin:8px 0 0 24px}.isFluent .od-QuotaBanner .od-QuotaBanner-textAndIcon .od-QuotaBanner-icon{margin:0 24px 0 0}html[dir=rtl] .isFluent .od-QuotaBanner .od-QuotaBanner-textAndIcon .od-QuotaBanner-icon{margin:0 0 0 24px}.od-QuotaBanner .od-QuotaBanner-textAndIcon .od-QuotaBanner-icon .od-IconGlyph{font-size:26px;color:"},{theme:"redDark",defaultValue:"#a4262c"},{rawString:"}.isFluent .od-QuotaBanner .od-QuotaBanner-textAndIcon .od-QuotaBanner-icon .od-IconGlyph{font-size:24px}.lg .od-QuotaBanner .od-QuotaBanner-textAndIcon .od-QuotaBanner-icon,.md .od-QuotaBanner .od-QuotaBanner-textAndIcon .od-QuotaBanner-icon,.sm .od-QuotaBanner .od-QuotaBanner-textAndIcon .od-QuotaBanner-icon{display:none}.isFluent.sm .od-QuotaBanner .od-QuotaBanner-textAndIcon .od-QuotaBanner-icon{display:block}.isFluent.md .od-QuotaBanner .od-QuotaBanner-textAndIcon .od-QuotaBanner-icon{display:block}.isFluent.lg .od-QuotaBanner .od-QuotaBanner-textAndIcon .od-QuotaBanner-icon{display:block}@media (min-width:1367px){.od-QuotaBanner .od-QuotaBanner-textAndIcon .od-QuotaBanner-textArea{max-width:90%}.isFluent .od-QuotaBanner .od-QuotaBanner-textAndIcon .od-QuotaBanner-textArea{max-width:100%}}.od-QuotaBanner .od-QuotaBanner-textAndIcon .od-QuotaBanner-textArea .od-QuotaBanner-textArea-title{color:"},{theme:"redDark",defaultValue:"#a4262c"},{rawString:";font-size:21px}.isFluent .od-QuotaBanner .od-QuotaBanner-textAndIcon .od-QuotaBanner-textArea .od-QuotaBanner-textArea-title{font-size:14px;font-weight:600}.md .od-QuotaBanner .od-QuotaBanner-textAndIcon .od-QuotaBanner-textArea .od-QuotaBanner-textArea-title,.sm .od-QuotaBanner .od-QuotaBanner-textAndIcon .od-QuotaBanner-textArea .od-QuotaBanner-textArea-title{font-size:17px}.isFluent.sm .od-QuotaBanner .od-QuotaBanner-textAndIcon .od-QuotaBanner-textArea .od-QuotaBanner-textArea-title{font-size:14px}.isFluent.md .od-QuotaBanner .od-QuotaBanner-textAndIcon .od-QuotaBanner-textArea .od-QuotaBanner-textArea-title{font-size:14px}.od-QuotaBanner .od-QuotaBanner-textAndIcon .od-QuotaBanner-textArea .od-QuotaBanner-textArea-body{margin-top:8px;color:"},{theme:"black",defaultValue:"#000000"},{rawString:";font-size:14px}.isFluent .od-QuotaBanner .od-QuotaBanner-textAndIcon .od-QuotaBanner-textArea .od-QuotaBanner-textArea-body{font-size:14px;line-height:20px}.md .od-QuotaBanner .od-QuotaBanner-textAndIcon .od-QuotaBanner-textArea .od-QuotaBanner-textArea-body,.sm .od-QuotaBanner .od-QuotaBanner-textAndIcon .od-QuotaBanner-textArea .od-QuotaBanner-textArea-body{font-size:12px}.isFluent.sm .od-QuotaBanner .od-QuotaBanner-textAndIcon .od-QuotaBanner-textArea .od-QuotaBanner-textArea-body{font-size:14px;line-height:20px}.isFluent.md .od-QuotaBanner .od-QuotaBanner-textAndIcon .od-QuotaBanner-textArea .od-QuotaBanner-textArea-body{font-size:14px;line-height:20px}.od-QuotaBanner .od-QuotaBanner-buttonArea{display:flex;margin-top:16px;align-self:flex-end;justify-content:flex-end}.isFluent .od-QuotaBanner .od-QuotaBanner-buttonArea{justify-content:flex-start;margin-top:20px;align-self:flex-start}[dir=ltr] .isFluent .od-QuotaBanner .od-QuotaBanner-buttonArea{margin-left:48px}[dir=rtl] .isFluent .od-QuotaBanner .od-QuotaBanner-buttonArea{margin-right:48px}@media (max-width:440px){.isFluent .od-QuotaBanner .od-QuotaBanner-buttonArea{flex-direction:column;align-self:stretch}.isFluent .od-QuotaBanner .od-QuotaBanner-buttonArea .od-Button+.od-Button{margin-top:8px}html[dir=ltr] .isFluent .od-QuotaBanner .od-QuotaBanner-buttonArea .od-Button+.od-Button{margin-left:0}html[dir=rtl] .isFluent .od-QuotaBanner .od-QuotaBanner-buttonArea .od-Button+.od-Button{margin-right:0}}@media (min-width:1367px){.od-QuotaBanner .od-QuotaBanner-buttonArea{margin:auto 30px auto 16px;align-self:center}html[dir=rtl] .od-QuotaBanner .od-QuotaBanner-buttonArea{margin:auto 16px auto 30px}.isFluent .od-QuotaBanner .od-QuotaBanner-buttonArea{align-self:flex-start;margin:20px 30px auto 48px}html[dir=rtl] .isFluent .od-QuotaBanner .od-QuotaBanner-buttonArea{margin:20px 48px auto 30px}}.od-QuotaBanner .od-QuotaBanner-buttonArea .od-QuotaBanner-primaryButton.od-Button{height:auto;background-color:"},{theme:"themePrimary",defaultValue:"#0078d4"},{rawString:";border:0;min-width:160px}.od-QuotaBanner .od-QuotaBanner-buttonArea .od-QuotaBanner-primaryButton.od-Button .od-Button-label{color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:"}.sm .od-QuotaBanner .od-QuotaBanner-buttonArea .od-QuotaBanner-primaryButton.od-Button{min-width:140px;padding:4px 10px 6px}.od-QuotaBanner .od-QuotaBanner-buttonArea .od-QuotaBanner-primaryButton.od-Button:focus,.od-QuotaBanner .od-QuotaBanner-buttonArea .od-QuotaBanner-primaryButton.od-Button:hover{box-shadow:none;border-color:"},{theme:"themeDark",defaultValue:"#005a9e"},{rawString:";background-color:"},{theme:"themeDark",defaultValue:"#005a9e"},{rawString:"}.od-QuotaBanner .od-QuotaBanner-buttonArea .od-QuotaBanner-primaryButton.od-Button:focus .od-Button-label,.od-QuotaBanner .od-QuotaBanner-buttonArea .od-QuotaBanner-primaryButton.od-Button:hover .od-Button-label{color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:"}.od-QuotaBanner .od-QuotaBanner-buttonArea .od-QuotaBanner-secondaryButton.od-Button{height:auto;background-color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:";border:0;min-width:160px}.od-QuotaBanner .od-QuotaBanner-buttonArea .od-QuotaBanner-secondaryButton.od-Button .od-Button-label{color:"},{theme:"themePrimary",defaultValue:"#0078d4"},{rawString:"}.sm .od-QuotaBanner .od-QuotaBanner-buttonArea .od-QuotaBanner-secondaryButton.od-Button{min-width:140px;padding:4px 10px 6px}.od-QuotaBanner .od-QuotaBanner-buttonArea .od-QuotaBanner-secondaryButton.od-Button:focus,.od-QuotaBanner .od-QuotaBanner-buttonArea .od-QuotaBanner-secondaryButton.od-Button:hover{box-shadow:none;border-color:"},{theme:"themeLighter",defaultValue:"#deecf9"},{rawString:";background-color:"},{theme:"themeLighter",defaultValue:"#deecf9"},{rawString:"}.od-QuotaBanner .od-QuotaBanner-buttonArea .od-QuotaBanner-secondaryButton.od-Button:focus .od-Button-label,.od-QuotaBanner .od-QuotaBanner-buttonArea .od-QuotaBanner-secondaryButton.od-Button:hover .od-Button-label{color:"},{theme:"themePrimary",defaultValue:"#0078d4"},{rawString:"}.isFluent .od-QuotaBanner .od-QuotaBanner-buttonArea .od-QuotaBanner-secondaryButton.od-Button{height:auto;background-color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:";border:0;min-width:160px;border:1px solid "},{theme:"neutralPrimary",defaultValue:"#323130"},{rawString:";color:"},{theme:"neutralPrimary",defaultValue:"#323130"},{rawString:"}.isFluent .od-QuotaBanner .od-QuotaBanner-buttonArea .od-QuotaBanner-secondaryButton.od-Button .od-Button-label{color:"},{theme:"neutralPrimary",defaultValue:"#323130"},{rawString:"}.sm .isFluent .od-QuotaBanner .od-QuotaBanner-buttonArea .od-QuotaBanner-secondaryButton.od-Button{min-width:140px;padding:4px 10px 6px}.isFluent .od-QuotaBanner .od-QuotaBanner-buttonArea .od-QuotaBanner-secondaryButton.od-Button:focus,.isFluent .od-QuotaBanner .od-QuotaBanner-buttonArea .od-QuotaBanner-secondaryButton.od-Button:hover{box-shadow:none;border-color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:";background-color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:"}.isFluent .od-QuotaBanner .od-QuotaBanner-buttonArea .od-QuotaBanner-secondaryButton.od-Button:focus .od-Button-label,.isFluent .od-QuotaBanner .od-QuotaBanner-buttonArea .od-QuotaBanner-secondaryButton.od-Button:hover .od-Button-label{color:"},{theme:"neutralPrimary",defaultValue:"#323130"},{rawString:"}html[dir=ltr] .od-QuotaBanner .od-QuotaBanner-buttonArea .od-Button+.od-Button{margin-left:8px}html[dir=rtl] .od-QuotaBanner .od-QuotaBanner-buttonArea .od-Button+.od-Button{margin-right:8px}.od-QuotaBanner-link{color:"},{theme:"themeDark",defaultValue:"#005a9e"},{rawString:";font-size:14px;white-space:nowrap;margin:0 4px}"}]);var i=n(0),s=n(10),o=n(37),u=n(53),a=n(17),f=n(392),l=n(1229),c=n(1306),h=n(6),p=n(182),d=n(1274),v=n(31),m=n(1489),g=n(11),y=n(162),b=(function(e){Object(i.__extends)(t,e);function t(t,n){var r=e.call(this,t,n)||this;r._bundleLoader=n.bundleLoader;r._actionMap=n.actionMap;r._viewParams=n.viewParams;r._urlDataSource=n.urlDataSource;r.isFluentEnabled=r.resources.consume(y.e);r.bannerParams=r.observables.pureCompute(r._computeBannerParams);return r}t.prototype.getUpgradeButtonAction=function(){var e=this;return{text:c.x,onClick:function(){e._navigate(d.e.upgrade,!1)}}};t.prototype.getCleanUpButtonAction=function(){var e=this;return{text:c.d,onClick:function(){e._navigate(d.e.cleanUpFiles,!1)}}};t.prototype.getLearnMoreAction=function(){var e=this;return{text:c.O,onClick:function(){e._navigate(d.e.learnMore,!0)}}};t.prototype._computeBannerParams=function(){var e={bannerEnabled:!1,title:null,body:null,icon:null,iconAriaLabel:null,primaryButtonAction:null,secondaryButtonAction:null,learnMoreAction:null};if(!this._bundleLoader.getBundleInfo(2).isLoaded())return e;this._userStateProvider||(this._userStateProvider=this.resources.consume(v.y));var t=this._userStateProvider.isSoftLocked(),n=this._userStateProvider.lockdownDate(),r=this._userStateProvider.isGoingToBeLockedSoon(),i=this._userStateProvider.isTemporararilyUnfrozen(),s=this._userStateProvider.isUnlockInProgress();if(!t&&!r&&!i)return e;e.bannerEnabled=!0;if(t){e.icon={name:f.e.tagName,params:{icon:new a.e("Blocked2")}};e.iconAriaLabel=c.X}else{e.icon={name:f.e.tagName,params:{icon:new a.e("Warning")}};e.iconAriaLabel=c.Q}if(s){e.title=c.ie;e.body=o.format(c.z,"<strong>","</strong>")}else if(t){var l=this._userStateProvider.driveDeletionDate(),h=m.e.getDaysFromToday(l);if(h<=30)if(h<=0)e.title=c.J;else{var p=o.getLocalizedCountValue(c.$,c.W,h);e.title=o.format(p,h)}else e.title=c.V;e.body=o.format(c.q,"<strong>",m.e.getLongDateStringSafe(l,u.e.language),"</strong>")}else if(r||i){e.title=o.format(c.K,m.e.getLongDateStringSafe(n,u.e.language));e.body=i?o.format(c.U,"<strong>","</strong>"):o.format(c.R,"<strong>","</strong>")}if(!s){this._userStateProvider.canUpgrade()&&this._urlDataSource.getPageType(this._viewParams())!==g.e.StorageOptions&&(e.primaryButtonAction=this.getUpgradeButtonAction());this._urlDataSource.isLargestFilesView(this._viewParams())||(e.secondaryButtonAction=this.getCleanUpButtonAction())}e.learnMoreAction=this.getLearnMoreAction();return e};t.prototype._navigate=function(e,t){var n=this._userStateProvider.getNavigationUrl(l.e.quotaBanner,e),r=new(this.managed(this._actionMap.NavigationAction))({target:t?"_blank":void 0,url:n});this._userStateProvider.logEvent(l.e.quotaBanner,e);r.execute(null)};t.dependencies=Object(i.__assign)(Object(i.__assign)({},s.t.dependencies),{bundleLoader:v.e,actionMap:h.e,viewParams:h.H,urlDataSource:p.n});return t})(s.t),w=n(27),E=Object(w.t)({automationName:"od-quota-banner",name:"QuotaBanner",template:'\x3c!--ko if:bannerParams().bannerEnabled--\x3e\x3c!--ko with:bannerParams--\x3e<div class="od-QuotaBanner" role="alert" data-bind="attr:{\'aria-labelledby\':\'od-QuotaBanner-textArea-title\',\'aria-describedby\':\'od-QuotaBanner-textArea-body\'}"><div class="od-QuotaBanner-textAndIcon">\x3c!--ko if:icon--\x3e<div class="od-QuotaBanner-icon" data-bind="component:icon,attr:{\'aria-label\':iconAriaLabel}"></div>\x3c!--/ko--\x3e<div class="od-QuotaBanner-textArea"><div class="od-QuotaBanner-textArea-title" data-bind="text:title"></div><div class="od-QuotaBanner-textArea-body"><span data-bind="html:body"></span>\x3c!--ko if:learnMoreAction--\x3e<a class="od-QuotaBanner-link" href="javascript:;" data-bind="text:learnMoreAction.text,click:learnMoreAction.onClick"></a>\x3c!--/ko--\x3e</div></div></div><div class="od-QuotaBanner-buttonArea">\x3c!--ko if:primaryButtonAction--\x3e<button class="od-Button" data-bind="click:primaryButtonAction.onClick,css:{\'od-QuotaBanner-primaryButton\':!$component.isFluentEnabled,\'od-Button--primary\':$component.isFluentEnabled}"><span class="od-Button-label" data-bind="text:primaryButtonAction.text"></span></button>\x3c!--/ko--\x3e\x3c!--ko if:secondaryButtonAction--\x3e<button class="od-Button" data-bind="click:secondaryButtonAction.onClick,css:{\'od-QuotaBanner-secondaryButton\':!$component.isFluentEnabled}"><span class="od-Button-label" data-bind="text:secondaryButtonAction.text"></span></button>\x3c!--/ko--\x3e</div></div>\x3c!--/ko--\x3e\x3c!--/ko--\x3e',viewModelType:b});t.default=E}}]);